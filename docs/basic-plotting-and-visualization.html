<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Basic Plotting and Visualization | Python and R</title>
  <meta name="description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Basic Plotting and Visualization | Python and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="github-repo" content="uvastatlab/Python_and_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Basic Plotting and Visualization | Python and R" />
  
  <meta name="twitter:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  

<meta name="author" content="Clay Ford, Jacob Goldstein-Greenwood, Oyinkansola Adenekan, Samantha Lomuscio" />


<meta name="date" content="2022-03-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aggregation-and-group-operations.html"/>
<link rel="next" href="selected-topics-in-statistical-inference.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Python and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>1</b> Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics.html"><a href="basics.html#math"><i class="fa fa-check"></i><b>1.1</b> Math</a></li>
<li class="chapter" data-level="1.2" data-path="basics.html"><a href="basics.html#missing-values"><i class="fa fa-check"></i><b>1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.3" data-path="basics.html"><a href="basics.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Assignment</a></li>
<li class="chapter" data-level="1.4" data-path="basics.html"><a href="basics.html#printing-a-value"><i class="fa fa-check"></i><b>1.4</b> Printing a value</a></li>
<li class="chapter" data-level="1.5" data-path="basics.html"><a href="basics.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a></li>
<li class="chapter" data-level="1.6" data-path="basics.html"><a href="basics.html#logic"><i class="fa fa-check"></i><b>1.6</b> Logic</a></li>
<li class="chapter" data-level="1.7" data-path="basics.html"><a href="basics.html#generating-a-sequence-of-values"><i class="fa fa-check"></i><b>1.7</b> Generating a sequence of values</a></li>
<li class="chapter" data-level="1.8" data-path="basics.html"><a href="basics.html#calculating-means-and-medians"><i class="fa fa-check"></i><b>1.8</b> Calculating means and medians</a></li>
<li class="chapter" data-level="1.9" data-path="basics.html"><a href="basics.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.9</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#one-dimensional-data"><i class="fa fa-check"></i><b>2.1</b> One-dimensional data</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-data"><i class="fa fa-check"></i><b>2.2</b> Two-dimensional data</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#three-dimensional-and-higher-data"><i class="fa fa-check"></i><b>2.3</b> Three-dimensional and higher data</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#general-data-structures"><i class="fa fa-check"></i><b>2.4</b> General data structures</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html"><i class="fa fa-check"></i><b>3</b> Import, Export, and Save Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#csv"><i class="fa fa-check"></i><b>3.1</b> CSV</a></li>
<li class="chapter" data-level="3.2" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xlsxlsx-excel"><i class="fa fa-check"></i><b>3.2</b> XLS/XLSX (Excel)</a></li>
<li class="chapter" data-level="3.3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#json"><i class="fa fa-check"></i><b>3.3</b> JSON</a></li>
<li class="chapter" data-level="3.4" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xml"><i class="fa fa-check"></i><b>3.4</b> XML</a></li>
<li class="chapter" data-level="3.5" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#exportingwritingsaving-data-and-variables"><i class="fa fa-check"></i><b>3.5</b> Exporting/Writing/Saving data and variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#names-of-variables-and-their-types"><i class="fa fa-check"></i><b>4.1</b> Names of variables and their types</a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#select-variables"><i class="fa fa-check"></i><b>4.2</b> Select variables</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#filtersubset-variables"><i class="fa fa-check"></i><b>4.3</b> Filter/Subset variables</a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#rename-variables"><i class="fa fa-check"></i><b>4.4</b> Rename variables</a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation.html"><a href="data-manipulation.html#create-replace-and-remove-variables"><i class="fa fa-check"></i><b>4.5</b> Create, replace and remove variables</a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation.html"><a href="data-manipulation.html#create-strings-from-numbers"><i class="fa fa-check"></i><b>4.6</b> Create strings from numbers</a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation.html"><a href="data-manipulation.html#create-numbers-from-strings"><i class="fa fa-check"></i><b>4.7</b> Create numbers from strings</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation.html"><a href="data-manipulation.html#combine-strings"><i class="fa fa-check"></i><b>4.8</b> Combine strings</a></li>
<li class="chapter" data-level="4.9" data-path="data-manipulation.html"><a href="data-manipulation.html#finding-and-replacing-patterns-within-strings"><i class="fa fa-check"></i><b>4.9</b> Finding and replacing patterns within strings</a></li>
<li class="chapter" data-level="4.10" data-path="data-manipulation.html"><a href="data-manipulation.html#change-case"><i class="fa fa-check"></i><b>4.10</b> Change case</a></li>
<li class="chapter" data-level="4.11" data-path="data-manipulation.html"><a href="data-manipulation.html#drop-duplicate-rows"><i class="fa fa-check"></i><b>4.11</b> Drop duplicate rows</a></li>
<li class="chapter" data-level="4.12" data-path="data-manipulation.html"><a href="data-manipulation.html#format-dates"><i class="fa fa-check"></i><b>4.12</b> Format dates</a></li>
<li class="chapter" data-level="4.13" data-path="data-manipulation.html"><a href="data-manipulation.html#randomly-sample-rows"><i class="fa fa-check"></i><b>4.13</b> Randomly sample rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html"><i class="fa fa-check"></i><b>5</b> Combine, Reshape and Merge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-rows"><i class="fa fa-check"></i><b>5.1</b> Combine rows</a></li>
<li class="chapter" data-level="5.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-columns"><i class="fa fa-check"></i><b>5.2</b> Combine columns</a></li>
<li class="chapter" data-level="5.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#reshaping-data"><i class="fa fa-check"></i><b>5.3</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#wide-to-long"><i class="fa fa-check"></i><b>5.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="5.3.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#long-to-wide"><i class="fa fa-check"></i><b>5.3.2</b> Long to wide</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#mergejoin"><i class="fa fa-check"></i><b>5.4</b> Merge/Join</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#left-join"><i class="fa fa-check"></i><b>5.4.1</b> Left Join</a></li>
<li class="chapter" data-level="5.4.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#right-join"><i class="fa fa-check"></i><b>5.4.2</b> Right Join</a></li>
<li class="chapter" data-level="5.4.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#inner-join"><i class="fa fa-check"></i><b>5.4.3</b> Inner Join</a></li>
<li class="chapter" data-level="5.4.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#outer-join"><i class="fa fa-check"></i><b>5.4.4</b> Outer Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html"><i class="fa fa-check"></i><b>6</b> Aggregation and Group Operations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#cross-tabulation"><i class="fa fa-check"></i><b>6.1</b> Cross tabulation</a></li>
<li class="chapter" data-level="6.2" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#group-summaries"><i class="fa fa-check"></i><b>6.2</b> Group summaries</a></li>
<li class="chapter" data-level="6.3" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.3</b> Centering and Scaling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html"><i class="fa fa-check"></i><b>7</b> Basic Plotting and Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#barplots"><i class="fa fa-check"></i><b>7.2</b> Barplots</a></li>
<li class="chapter" data-level="7.3" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#scatterplot"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.4" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#stripcharts"><i class="fa fa-check"></i><b>7.4</b> Stripcharts</a></li>
<li class="chapter" data-level="7.5" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#boxplots"><i class="fa fa-check"></i><b>7.5</b> Boxplots</a></li>
<li class="chapter" data-level="7.6" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#facet-plots"><i class="fa fa-check"></i><b>7.6</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html"><i class="fa fa-check"></i><b>8</b> Selected Topics in Statistical Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-means"><i class="fa fa-check"></i><b>8.1</b> Comparing group means</a></li>
<li class="chapter" data-level="8.2" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-proportions"><i class="fa fa-check"></i><b>8.2</b> Comparing group proportions</a></li>
<li class="chapter" data-level="8.3" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#linear-modeling"><i class="fa fa-check"></i><b>8.3</b> Linear modeling</a></li>
<li class="chapter" data-level="8.4" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-plotting-and-visualization" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Basic Plotting and Visualization</h1>
<p>This chapter looks at creating basic plots to explore and understand data. Visualization in Python and R is a gigantic and evolving topic. We don’t pretend to present a comprehensive comparison.</p>
<p>The plots below make use of the <a href="https://allisonhorst.github.io/palmerpenguins/"><strong>palmerpenguins</strong></a> data set, which contains various measurements for 344 penguins across three islands in the Antarctic Palmer Archipelago. The data were collected by <a href="https://www.uaf.edu/cfos/people/faculty/detail/kristen-gorman.php">Kristen Gorman</a> and colleagues, and they were made available under a <a href="https://creativecommons.org/share-your-work/public-domain/cc0/">CC0 public domain license</a> by Allison Horst, Alison Hill, and Kristen Gorman.</p>
<p>For the R sections below, we discuss how to generate plots using base R and using <strong>ggplot2</strong>.</p>
<p>Here’s a glimpse at the data set:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="basic-plotting-and-visualization.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">head</span>(penguins)</span>
<span id="cb254-2"><a href="basic-plotting-and-visualization.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6 x 8</span></span>
<span id="cb254-3"><a href="basic-plotting-and-visualization.html#cb254-3" aria-hidden="true" tabindex="-1"></a>  species island bill_length_mm bill_depth_mm flipper_length_<span class="sc">~</span> body_mass_g sex  </span>
<span id="cb254-4"><a href="basic-plotting-and-visualization.html#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>fct<span class="sc">&gt;</span>   <span class="er">&lt;</span>fct<span class="sc">&gt;</span>           <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>         <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>            <span class="er">&lt;</span>int<span class="sc">&gt;</span>       <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>fct<span class="sc">&gt;</span></span>
<span id="cb254-5"><a href="basic-plotting-and-visualization.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> Adelie  Torge<span class="sc">~</span>           <span class="fl">39.1</span>          <span class="fl">18.7</span>              <span class="dv">181</span>        <span class="dv">3750</span> male </span>
<span id="cb254-6"><a href="basic-plotting-and-visualization.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Adelie  Torge<span class="sc">~</span>           <span class="fl">39.5</span>          <span class="fl">17.4</span>              <span class="dv">186</span>        <span class="dv">3800</span> fema<span class="sc">~</span></span>
<span id="cb254-7"><a href="basic-plotting-and-visualization.html#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> Adelie  Torge<span class="sc">~</span>           <span class="fl">40.3</span>          <span class="dv">18</span>                <span class="dv">195</span>        <span class="dv">3250</span> fema<span class="sc">~</span></span>
<span id="cb254-8"><a href="basic-plotting-and-visualization.html#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> Adelie  Torge<span class="sc">~</span>           <span class="cn">NA</span>            <span class="cn">NA</span>                 <span class="cn">NA</span>          <span class="cn">NA</span> <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span> </span>
<span id="cb254-9"><a href="basic-plotting-and-visualization.html#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> Adelie  Torge<span class="sc">~</span>           <span class="fl">36.7</span>          <span class="fl">19.3</span>              <span class="dv">193</span>        <span class="dv">3450</span> fema<span class="sc">~</span></span>
<span id="cb254-10"><a href="basic-plotting-and-visualization.html#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> Adelie  Torge<span class="sc">~</span>           <span class="fl">39.3</span>          <span class="fl">20.6</span>              <span class="dv">190</span>        <span class="dv">3650</span> male </span>
<span id="cb254-11"><a href="basic-plotting-and-visualization.html#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ... with 1 more variable: year &lt;int&gt;</span></span></code></pre></div>
<div id="histograms" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Histograms</h2>
<p>Visualizing the distribution of numeric data.</p>
<div id="python-41" class="section level4 unnumbered">
<h4>Python</h4>
<p>The Python plotting library Matplotlib’s <code>hist()</code> function computes and plots a histogram. There are many parameters that can be specified within the <code>hist()</code> function so that you can customize the output histogram plot to best fit your needs. Some parameters include the number of bins, the upper and lower bounds on each bin, weights, colors, and more.</p>
<p>Below we show a histogram of the bill length from the dataset. We specified 30 bins each of which is light blue with a black outline of linewidth 1. The <code>hist()</code> defaults to no outline which can make it difficult to distinguish bins clearly, so we add in the bin outlines here.</p>
<p>One thing to note is that the bins are left inclusive and right exclusive. For example, if a particular bin spans the range of 1 to 3, the bin will include the value 1 but will exclude the value 2 (and will include all values between 1 and 3). In short, bin ranges are as follows [x1,x2) where x1 is the starting point of the bin and x2 is the ending point of the bin.</p>
<p>Notice the semicolon at the end of the <code>plt.hist()</code> function. This suppresses the printing of the array generated to create the histogram.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb255-1"><a href="basic-plotting-and-visualization.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb255-2"><a href="basic-plotting-and-visualization.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb255-3"><a href="basic-plotting-and-visualization.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.clf()</span>
<span id="cb255-4"><a href="basic-plotting-and-visualization.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.hist(penguins.bill_length_mm, bins<span class="op">=</span><span class="dv">30</span>, <span class="bu">range</span><span class="op">=</span>(<span class="dv">30</span>,<span class="dv">60</span>),</span>
<span id="cb255-5"><a href="basic-plotting-and-visualization.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>          color<span class="op">=</span><span class="st">&#39;lightblue&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;k&#39;</span>, linewidth<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb255-6"><a href="basic-plotting-and-visualization.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.title(<span class="st">&quot;Penguin Bill Lengths&quot;</span>)</span>
<span id="cb255-7"><a href="basic-plotting-and-visualization.html#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.xlabel(<span class="st">&quot;Bill Length (mm)&quot;</span>)</span>
<span id="cb255-8"><a href="basic-plotting-and-visualization.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.ylabel(<span class="st">&quot;Count&quot;</span>)</span>
<span id="cb255-9"><a href="basic-plotting-and-visualization.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-274-1.png" width="672" /></p>
</div>
<div id="r-41" class="section level4 unnumbered">
<h4>R</h4>
<p>Base R’s <code>hist()</code> function generates histograms, and features of the histogram—like the bar color, number of bins/breaks, and so on—can be easily customized as below.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="basic-plotting-and-visualization.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">hist</span>(penguins<span class="sc">$</span>bill_length_mm, <span class="at">breaks =</span> <span class="dv">25</span>, <span class="at">col =</span> <span class="st">&#39;lightblue&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">60</span>),</span>
<span id="cb256-2"><a href="basic-plotting-and-visualization.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>      <span class="at">main =</span> <span class="st">&#39;Penguin Bill Lengths&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Bill Length (mm)&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Count&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-275-3.png" width="672" /></p>
<p>The <strong>ggplot2</strong> method for generating histograms follows the standard <strong>ggplot2</strong> syntax: Initialize a plot with <code>ggplot()</code>, and then add layers thereto, specifying aesthetic properties along the way. Here, the layer to add is <code>geom_histogram()</code>.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="basic-plotting-and-visualization.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb257-2"><a href="basic-plotting-and-visualization.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&#39;lightblue&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb257-3"><a href="basic-plotting-and-visualization.html#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">xlim</span>(<span class="dv">30</span>, <span class="dv">60</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Penguin Bill Lengths&#39;</span>, <span class="at">x =</span> <span class="st">&#39;Bill Length (mm)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Count&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-276-1.png" width="672" /></p>
</div>
</div>
<div id="barplots" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Barplots</h2>
<p>Visualizing the distribution of categorical data.</p>
<div id="python-42" class="section level4 unnumbered">
<h4>Python</h4>
<p>For this example, we will generate a bar plot showing how many of each species—Adelie, Chinstrap, Gentoo—we have in our dataset. We go through two ways of doing this here.</p>
<p>First, we use the Matplotlib plotting library to create the bar plot using the function <code>bar()</code>. To start, we determine the number of each species, then use that data to create the bar plot.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb258-1"><a href="basic-plotting-and-visualization.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb258-2"><a href="basic-plotting-and-visualization.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb258-3"><a href="basic-plotting-and-visualization.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="co"># Determine the number of each species</span></span>
<span id="cb258-4"><a href="basic-plotting-and-visualization.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> adelie_counts <span class="op">=</span> <span class="bu">len</span>(penguins.loc[penguins[<span class="st">&quot;species&quot;</span>]<span class="op">==</span><span class="st">&quot;Adelie&quot;</span>])</span>
<span id="cb258-5"><a href="basic-plotting-and-visualization.html#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> chinstrap_counts <span class="op">=</span> <span class="bu">len</span>(penguins.loc[penguins[<span class="st">&quot;species&quot;</span>]<span class="op">==</span><span class="st">&quot;Chinstrap&quot;</span>])</span>
<span id="cb258-6"><a href="basic-plotting-and-visualization.html#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> gentoo_counts <span class="op">=</span> <span class="bu">len</span>(penguins.loc[penguins[<span class="st">&quot;species&quot;</span>]<span class="op">==</span><span class="st">&quot;Gentoo&quot;</span>])</span>
<span id="cb258-7"><a href="basic-plotting-and-visualization.html#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb258-8"><a href="basic-plotting-and-visualization.html#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="co"># Save the counts information into arrays to be inputted into the bar() function</span></span>
<span id="cb258-9"><a href="basic-plotting-and-visualization.html#cb258-9" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> spec <span class="op">=</span> [<span class="st">&quot;Adelie&quot;</span>,<span class="st">&quot;Chinstrap&quot;</span>,<span class="st">&quot;Gentoo&quot;</span>]</span>
<span id="cb258-10"><a href="basic-plotting-and-visualization.html#cb258-10" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> counts <span class="op">=</span> [adelie_counts,chinstrap_counts,gentoo_counts]</span>
<span id="cb258-11"><a href="basic-plotting-and-visualization.html#cb258-11" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb258-12"><a href="basic-plotting-and-visualization.html#cb258-12" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.clf() <span class="co"># clears the figure to ensure that multiple plots are not overlaid</span></span>
<span id="cb258-13"><a href="basic-plotting-and-visualization.html#cb258-13" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.bar(spec,counts)</span>
<span id="cb258-14"><a href="basic-plotting-and-visualization.html#cb258-14" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>BarContainer <span class="bu">object</span> of <span class="dv">3</span> artists<span class="op">&gt;</span></span>
<span id="cb258-15"><a href="basic-plotting-and-visualization.html#cb258-15" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
<p>Our data is stored in a <code>pandas Dataframe</code>, which has it’s own built-in plotting module, <code>plot</code>. Here we create the same bar plot by using the pandas <code>bar()</code> function.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="basic-plotting-and-visualization.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> plt.clf()</span>
<span id="cb259-2"><a href="basic-plotting-and-visualization.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> penguins[<span class="st">&quot;species&quot;</span>].value_counts().plot.bar()</span>
<span id="cb259-3"><a href="basic-plotting-and-visualization.html#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-278-3.png" width="672" />
One thing to note here is that we generated the same bar plot containing the same information with way less effort. Using the built-in pandas plotting routine proved to be the more efficient method here.</p>
</div>
<div id="r-42" class="section level4 unnumbered">
<h4>R</h4>
<p>To form barplots, we’ll first take the <strong>penguins</strong> data set and create a summary data frame containing the statistics we’re looking to plot. Here, that’s simply the sample size of each species in the data set.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="basic-plotting-and-visualization.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> species_counts <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> species, <span class="at">data =</span> penguins))</span>
<span id="cb260-2"><a href="basic-plotting-and-visualization.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> species_counts</span>
<span id="cb260-3"><a href="basic-plotting-and-visualization.html#cb260-3" aria-hidden="true" tabindex="-1"></a>    species Freq</span>
<span id="cb260-4"><a href="basic-plotting-and-visualization.html#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    Adelie  <span class="dv">152</span></span>
<span id="cb260-5"><a href="basic-plotting-and-visualization.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> Chinstrap   <span class="dv">68</span></span>
<span id="cb260-6"><a href="basic-plotting-and-visualization.html#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    Gentoo  <span class="dv">124</span></span></code></pre></div>
<p>We can plot those values using the <code>barplot()</code> function in base R, specifying arguments along the way to customize the title/axis labeling, bar colors, and range of the y axis. To add values above the bars, we can follow <code>barplot()</code> with a <code>text()</code> call as below.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="basic-plotting-and-visualization.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> penguin_plot <span class="ot">&lt;-</span> <span class="fu">barplot</span>(Freq <span class="sc">~</span> species, <span class="at">data =</span> species_counts, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;lightblue&#39;</span>, <span class="st">&#39;cornflowerblue&#39;</span>, <span class="st">&#39;darkslateblue&#39;</span>),</span>
<span id="cb261-2"><a href="basic-plotting-and-visualization.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">main =</span> <span class="st">&#39;Species Sample Size&#39;</span>, </span>
<span id="cb261-3"><a href="basic-plotting-and-visualization.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">xlab =</span> <span class="st">&#39;Species&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Count&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>))</span>
<span id="cb261-4"><a href="basic-plotting-and-visualization.html#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">text</span>(<span class="at">x =</span> penguin_plot, <span class="at">y =</span> species_counts<span class="sc">$</span>Freq <span class="sc">+</span> <span class="dv">10</span>, </span>
<span id="cb261-5"><a href="basic-plotting-and-visualization.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>      <span class="at">labels =</span> species_counts<span class="sc">$</span>Freq)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
<p>To recreate the barplot above with <strong>ggplot2</strong>, one can add a <code>geom_bar()</code> layer to a plot initialized with <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="basic-plotting-and-visualization.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(species_counts, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> Freq)) <span class="sc">+</span></span>
<span id="cb262-2"><a href="basic-plotting-and-visualization.html#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> species), <span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="sc">+</span></span>
<span id="cb262-3"><a href="basic-plotting-and-visualization.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;lightblue&#39;</span>, <span class="st">&#39;cornflowerblue&#39;</span>, <span class="st">&#39;darkslateblue&#39;</span>)) <span class="sc">+</span> <span class="co"># scale_fill_manual() is used here for bar-color customization</span></span>
<span id="cb262-4"><a href="basic-plotting-and-visualization.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Species Sample Size&#39;</span>, <span class="at">x =</span> <span class="st">&#39;Species&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Count&#39;</span>) <span class="sc">+</span></span>
<span id="cb262-5"><a href="basic-plotting-and-visualization.html#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">200</span>) <span class="sc">+</span> <span class="co"># For simplicity, we omit the legend here using the code at left</span></span>
<span id="cb262-6"><a href="basic-plotting-and-visualization.html#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="co"># geom_text() is used here to add counts above the bars</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
</div>
</div>
<div id="scatterplot" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Scatterplot</h2>
<p>Visualizing the relationship between two numeric variables.</p>
<div id="python-43" class="section level4 unnumbered">
<h4>Python</h4>
<p>The <code>scatter()</code> function, part of <strong>matplotlib</strong>, can produce scatterplots in Python. The <code>x</code> and <code>y</code> arguments specify the points to plot. In the example below, we also use the <code>c</code> and <code>marker</code> arguments to customize the point color and point shape, respectively. The <code>xlabel()</code>, <code>ylabel()</code>, and <code>title()</code> functions customize plot labels.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="basic-plotting-and-visualization.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb263-2"><a href="basic-plotting-and-visualization.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb263-3"><a href="basic-plotting-and-visualization.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> penguins_no_na <span class="op">=</span> penguins.dropna() <span class="co"># remove NA rows, as we only want to plot present data</span></span>
<span id="cb263-4"><a href="basic-plotting-and-visualization.html#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.clf() <span class="co"># clear the plotting space to prevent plot overlap</span></span>
<span id="cb263-5"><a href="basic-plotting-and-visualization.html#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.scatter(x <span class="op">=</span> penguins_no_na[<span class="st">&#39;body_mass_g&#39;</span>], y <span class="op">=</span> penguins_no_na[<span class="st">&#39;flipper_length_mm&#39;</span>], c <span class="op">=</span> <span class="st">&#39;lightblue&#39;</span>, marker <span class="op">=</span> <span class="st">&#39;d&#39;</span>) <span class="co"># &#39;d&#39; generates diamond markers; learn more about available marker shapes here: https://matplotlib.org/stable/api/markers_api.html#module-matplotlib.markers</span></span>
<span id="cb263-6"><a href="basic-plotting-and-visualization.html#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.xlabel(<span class="st">&#39;Body Mass (g)&#39;</span>)</span>
<span id="cb263-7"><a href="basic-plotting-and-visualization.html#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.ylabel(<span class="st">&#39;Flipper Length (mm)&#39;</span>)</span>
<span id="cb263-8"><a href="basic-plotting-and-visualization.html#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.title(<span class="st">&#39;Scatterplot of Body Mass and Flipper Length&#39;</span>)</span>
<span id="cb263-9"><a href="basic-plotting-and-visualization.html#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb263-10"><a href="basic-plotting-and-visualization.html#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
</div>
<div id="r-43" class="section level4 unnumbered">
<h4>R</h4>
<p>Scatterplots can be generated in base R with the <code>plot()</code> function. The <code>pch</code> argument below modifies the point shape (e.g., 20 = solid circle; 24 = unfilled triangle; etc.)</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="basic-plotting-and-visualization.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">plot</span>(<span class="at">x =</span> penguins<span class="sc">$</span>body_mass_g, <span class="at">y =</span> penguins<span class="sc">$</span>flipper_length_mm, </span>
<span id="cb264-2"><a href="basic-plotting-and-visualization.html#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>      <span class="at">col =</span> <span class="st">&#39;navy&#39;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb264-3"><a href="basic-plotting-and-visualization.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>      <span class="at">main =</span> <span class="st">&#39;Scatterplot of Body Mass and Flipper Length&#39;</span>, </span>
<span id="cb264-4"><a href="basic-plotting-and-visualization.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>      <span class="at">xlab =</span> <span class="st">&#39;Body Mass (g)&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Flipper Length (mm)&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-283-3.png" width="672" /></p>
<p>To generate a scatterplot with <strong>ggplot2</strong>, initialize a plot with <code>ggplot()</code>, then add a layer of points with <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="basic-plotting-and-visualization.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> body_mass_g, <span class="at">y =</span> flipper_length_mm)) <span class="sc">+</span></span>
<span id="cb265-2"><a href="basic-plotting-and-visualization.html#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;navy&#39;</span>) <span class="sc">+</span></span>
<span id="cb265-3"><a href="basic-plotting-and-visualization.html#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Scatterplot of Body Mass and Flipper Length&#39;</span>, </span>
<span id="cb265-4"><a href="basic-plotting-and-visualization.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">x =</span> <span class="st">&#39;Body Mass (g)&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Flipper Length (mm)&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-284-1.png" width="672" /></p>
</div>
</div>
<div id="stripcharts" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Stripcharts</h2>
<p>Stripcharts, or strip plots, are one-dimensional scatterplots. Like boxplots, they reveal the distribution of a numeric variable within levels of a categorical variable.</p>
<div id="python-44" class="section level4 unnumbered">
<h4>Python</h4>
<p>The <strong>seaborn</strong> package provides the <code>stripplot()</code> function. Specify which variables you want on the x and y axes. Below we specify island on the y axis to see the distribution of bill_depth_mm horizontally. Specify your Pandas data frame using the data argument. Finally create the plot using <code>plt.show()</code> from <strong>matplotlib</strong>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb266-1"><a href="basic-plotting-and-visualization.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb266-2"><a href="basic-plotting-and-visualization.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb266-3"><a href="basic-plotting-and-visualization.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> sns.stripplot(x<span class="op">=</span><span class="st">&quot;bill_depth_mm&quot;</span>, y<span class="op">=</span><span class="st">&quot;island&quot;</span>, data<span class="op">=</span>penguins)</span>
<span id="cb266-4"><a href="basic-plotting-and-visualization.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
<p>The <a href="https://seaborn.pydata.org/generated/seaborn.stripplot.html">stripplot</a> help page provides more examples.</p>
</div>
<div id="r-44" class="section level4 unnumbered">
<h4>R</h4>
<p>Base R offers the <code>stripchart()</code> function. To indicate the numeric variable and the grouping variable, you can use formula notation: <code>numeric_var ~ grouping_var</code>. Adding <code>methhod = 'jitter'</code> to the set of arguments spreads the points out slightly within each level of the grouping variable, making it easier to see points that might otherwise be obscured by overlap.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="basic-plotting-and-visualization.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">stripchart</span>(bill_depth_mm <span class="sc">~</span> island, <span class="at">data =</span> penguins, </span>
<span id="cb267-2"><a href="basic-plotting-and-visualization.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            <span class="at">method =</span> <span class="st">&#39;jitter&#39;</span>,</span>
<span id="cb267-3"><a href="basic-plotting-and-visualization.html#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            <span class="at">ylab =</span> <span class="st">&#39;Island&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Bill Depth (mm)&#39;</span>, </span>
<span id="cb267-4"><a href="basic-plotting-and-visualization.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>            <span class="at">main =</span> <span class="st">&#39;Stripchart of Bill Depth by Island&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-286-3.png" width="672" /></p>
<p>Stripcharts can also be made with <strong>ggplots2</strong>’s <code>geom_jitter()</code> function, as shown below. You can control the amount of jitter with a <code>position</code> argument in <code>geom_jitter()</code>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="basic-plotting-and-visualization.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> island, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb268-2"><a href="basic-plotting-and-visualization.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> island), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb268-3"><a href="basic-plotting-and-visualization.html#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;lightblue&#39;</span>, <span class="st">&#39;cornflowerblue&#39;</span>, <span class="st">&#39;darkslateblue&#39;</span>)) <span class="sc">+</span> <span class="co"># scale_fill_manual() is used to manually specify group colors once aes(color = island) is specified in `geom_jitter()`</span></span>
<span id="cb268-4"><a href="basic-plotting-and-visualization.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Stripchart of Bill Depth by Island&#39;</span>, </span>
<span id="cb268-5"><a href="basic-plotting-and-visualization.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">x =</span> <span class="st">&#39;Island&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Bill Depth (mm)&#39;</span>) <span class="sc">+</span></span>
<span id="cb268-6"><a href="basic-plotting-and-visualization.html#cb268-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb268-7"><a href="basic-plotting-and-visualization.html#cb268-7" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing <span class="fu">values</span> (geom_point).</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-287-1.png" width="672" /></p>
</div>
</div>
<div id="boxplots" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Boxplots</h2>
<p>Visualizing the relationship between a numeric variable and a categorical variable via five-number summaries.</p>
<div id="python-45" class="section level4 unnumbered">
<h4>Python</h4>
<p>The <code>boxplot()</code> function in seaborn generates boxplots, and matplotlib can be used for the aesthetics of the plot.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb269-1"><a href="basic-plotting-and-visualization.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb269-2"><a href="basic-plotting-and-visualization.html#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb269-3"><a href="basic-plotting-and-visualization.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.figure()</span>
<span id="cb269-4"><a href="basic-plotting-and-visualization.html#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> sns.boxplot(x<span class="op">=</span><span class="st">&quot;island&quot;</span>, y<span class="op">=</span><span class="st">&quot;bill_depth_mm&quot;</span>, data<span class="op">=</span>penguins)</span>
<span id="cb269-5"><a href="basic-plotting-and-visualization.html#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.xlabel(<span class="st">&quot;Island&quot;</span>)</span>
<span id="cb269-6"><a href="basic-plotting-and-visualization.html#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.ylabel(<span class="st">&quot;Bill Depth (mm)&quot;</span>)</span>
<span id="cb269-7"><a href="basic-plotting-and-visualization.html#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.title(<span class="st">&quot;Bill Depth by Island&quot;</span>)</span>
<span id="cb269-8"><a href="basic-plotting-and-visualization.html#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-288-1.png" width="672" /></p>
</div>
<div id="r-45" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>boxplot()</code> function in base R generates boxplots, and a user specifies the grouping variable and the numeric variable to be plotted in formula notation: <code>y ~ grouping_var</code>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="basic-plotting-and-visualization.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">boxplot</span>(bill_depth_mm <span class="sc">~</span> island, <span class="at">data =</span> penguins, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;lightblue&#39;</span>, <span class="st">&#39;cornflowerblue&#39;</span>, <span class="st">&#39;darkslateblue&#39;</span>),</span>
<span id="cb270-2"><a href="basic-plotting-and-visualization.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>         <span class="at">main =</span> <span class="st">&#39;Boxplot of Bill Depth by Island&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Island&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Bill Depth (mm)&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-289-3.png" width="672" /></p>
<p>To generate a boxplot with <strong>ggplot2</strong>, add a <code>geom_boxplot()</code> layer to a plot initialized with <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="basic-plotting-and-visualization.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> island, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb271-2"><a href="basic-plotting-and-visualization.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> island)) <span class="sc">+</span></span>
<span id="cb271-3"><a href="basic-plotting-and-visualization.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;lightblue&#39;</span>, <span class="st">&#39;cornflowerblue&#39;</span>, <span class="st">&#39;darkslateblue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb271-4"><a href="basic-plotting-and-visualization.html#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Boxplot of Bill Depth by Island&#39;</span>, </span>
<span id="cb271-5"><a href="basic-plotting-and-visualization.html#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">x =</span> <span class="st">&#39;Island&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Bill Depth (mm)&#39;</span>) <span class="sc">+</span></span>
<span id="cb271-6"><a href="basic-plotting-and-visualization.html#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
</div>
</div>
<div id="facet-plots" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Facet plots</h2>
<p>Facet plots (also called trellis plots, lattice plots, and conditional plots) are comprised of multiple smaller plots, where each subplot contains a subset of the overall data, with subsets defined by one or more faceting variables.</p>
<div id="python-46" class="section level4 unnumbered">
<h4>Python</h4>
<p>The seaborn package provides several functions for creating facet plots, including <code>relplot()</code>, <code>displot()</code>, <code>catplot()</code>, and <code>lmplot()</code>. Below we demonstrate the <code>lmplot()</code> function which allows you to create scatter plots at certain levels of categorical variable. Specify your x and y variables as character strings using the <code>x</code> and <code>y</code> arguments, respectively. Specing the grouping variable using either the <code>col</code> or <code>row</code> arguments. By default a linear-squares lines is added to the plot. Setting <code>ci = None</code> suppresses the confidence interval ribbon.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb272-1"><a href="basic-plotting-and-visualization.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> plt.clf()</span>
<span id="cb272-2"><a href="basic-plotting-and-visualization.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> sns.lmplot(x <span class="op">=</span> <span class="st">&quot;bill_length_mm&quot;</span>, y <span class="op">=</span> <span class="st">&quot;bill_depth_mm&quot;</span>, col <span class="op">=</span> <span class="st">&quot;species&quot;</span>,</span>
<span id="cb272-3"><a href="basic-plotting-and-visualization.html#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>           data <span class="op">=</span> penguins, ci <span class="op">=</span> <span class="va">None</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-291-1.png" width="744" /></p>
<p>To facet by two variables, provide variables to both the <code>col</code> and <code>row</code> arguments.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb273-1"><a href="basic-plotting-and-visualization.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> plt.clf()</span>
<span id="cb273-2"><a href="basic-plotting-and-visualization.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> sns.lmplot(x <span class="op">=</span> <span class="st">&quot;bill_length_mm&quot;</span>, y <span class="op">=</span> <span class="st">&quot;bill_depth_mm&quot;</span>, </span>
<span id="cb273-3"><a href="basic-plotting-and-visualization.html#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>            col <span class="op">=</span> <span class="st">&quot;species&quot;</span>, row <span class="op">=</span> <span class="st">&quot;sex&quot;</span>,</span>
<span id="cb273-4"><a href="basic-plotting-and-visualization.html#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>            data <span class="op">=</span> penguins, ci <span class="op">=</span> <span class="va">None</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-292-3.png" width="744" /></p>
<p>Set <code>lowess = True</code> for smooth trend lines. Notice also that color can be mapped to the same variable used for faceting.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb274-1"><a href="basic-plotting-and-visualization.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> plt.clf()</span>
<span id="cb274-2"><a href="basic-plotting-and-visualization.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> sns.lmplot(x <span class="op">=</span> <span class="st">&quot;bill_length_mm&quot;</span>, y <span class="op">=</span> <span class="st">&quot;bill_depth_mm&quot;</span>, </span>
<span id="cb274-3"><a href="basic-plotting-and-visualization.html#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>            col <span class="op">=</span> <span class="st">&quot;species&quot;</span>, hue <span class="op">=</span> <span class="st">&quot;species&quot;</span>,</span>
<span id="cb274-4"><a href="basic-plotting-and-visualization.html#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>            data <span class="op">=</span> penguins, ci <span class="op">=</span> <span class="va">None</span>, lowess <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-293-5.png" width="744" /></p>
<p>The <a href="https://seaborn.pydata.org/generated/seaborn.lmplot.html#seaborn.lmplot">lmplot</a> help page showcases other examples.</p>
</div>
<div id="r-46" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>coplot()</code> function in base R produces conditioning plots using formula notation: <code>y ~ x | grouping_var</code>. The <code>rows</code> and <code>columns</code> arguments control layout. Below we specify one row of plots. The <code>panel</code> argument controls what action is carried out in each plot. The default is a scatterplot. Below we use the base R <code>panel.smooth</code> function to create scatter plots with a smooth trend line.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="basic-plotting-and-visualization.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(bill_depth_mm <span class="sc">~</span> bill_length_mm <span class="sc">|</span> species, </span>
<span id="cb275-2"><a href="basic-plotting-and-visualization.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">data =</span> penguins,</span>
<span id="cb275-3"><a href="basic-plotting-and-visualization.html#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">panel =</span> panel.smooth,</span>
<span id="cb275-4"><a href="basic-plotting-and-visualization.html#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">rows =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;navy&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-294-7.png" width="672" /></p>
<p>To condition on two variables, use formula notation with syntax: <code>y ~ x | grp_var1 * grp_var2</code>.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="basic-plotting-and-visualization.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(bill_depth_mm <span class="sc">~</span> bill_length_mm <span class="sc">|</span> species <span class="sc">*</span> sex, </span>
<span id="cb276-2"><a href="basic-plotting-and-visualization.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">data =</span> penguins,</span>
<span id="cb276-3"><a href="basic-plotting-and-visualization.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">panel =</span> panel.smooth,</span>
<span id="cb276-4"><a href="basic-plotting-and-visualization.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">col =</span> <span class="st">&quot;navy&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-295-1.png" width="672" /></p>
<p>The labels of the conditioning variables unfortunately use a lot of real estate in the margins, and there is no easy way to modify that. However, this design works quite well when we condition on a <em>numeric variable</em>. The <code>coplot()</code> function automatically creates overlapping group intervals to condition on, and the stacked layout of the labels helps us visualize how the relationship between y and x changes between the groups. To manually set the number of groups, use the <code>number</code> argument. Below we specify 4 groups to be generated for “bill_length_mm”.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="basic-plotting-and-visualization.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">coplot</span>(flipper_length_mm <span class="sc">~</span> body_mass_g <span class="sc">|</span> bill_length_mm, </span>
<span id="cb277-2"><a href="basic-plotting-and-visualization.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">data =</span> penguins,</span>
<span id="cb277-3"><a href="basic-plotting-and-visualization.html#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">panel =</span> panel.smooth,</span>
<span id="cb277-4"><a href="basic-plotting-and-visualization.html#cb277-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">number =</span> <span class="dv">4</span>, </span>
<span id="cb277-5"><a href="basic-plotting-and-visualization.html#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>        <span class="at">rows =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;navy&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
<p>Alternatively, <strong>ggplot2</strong> provides a intuitive and easy-to-use method for generating facet plots: A user specifies the aesthetics of the plot using standard <strong>ggplot2</strong> syntax (i.e., as a series of added layers) and then adds an additional call, <code>facet_wrap()</code> (or <code>facet_grid()</code>; differences are discussed below), specifying the faceting variable(s) to split up the plots by.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="basic-plotting-and-visualization.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb278-2"><a href="basic-plotting-and-visualization.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;navy&#39;</span>) <span class="sc">+</span></span>
<span id="cb278-3"><a href="basic-plotting-and-visualization.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&#39;salmon&#39;</span>) <span class="sc">+</span> <span class="co"># Add least-squares line</span></span>
<span id="cb278-4"><a href="basic-plotting-and-visualization.html#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>species)</span>
<span id="cb278-5"><a href="basic-plotting-and-visualization.html#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="st">&#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-297-1.png" width="672" /></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="basic-plotting-and-visualization.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Use formula notation, a character vector, or vars() to specify faceting</span></span>
<span id="cb279-2"><a href="basic-plotting-and-visualization.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># variables; e.g., ~species, c(&#39;species&#39;), or vars(species)</span></span></code></pre></div>
<p>The number of rows and columns can be manually specified with <code>nrow</code> and <code>ncol</code> arguments in <code>facet_wrap()</code>. By default, the x and y axes of all facet plots will be on the same scale. The axis ranges can be set to vary freely by adding <code>scales = 'free'</code> as an argument (or, alternatively, <code>scales = 'free_x'</code> or <code>scales = 'free_y'</code> to free just the x or y axis).</p>
<p>Both <code>facet_wrap()</code> and <code>facet_grid()</code> can be used to make facet plots. When faceting based on multiple variables (e.g., species and sex), <code>facet_wrap()</code> will drop group combinations for which there are no data points, whereas <code>facet_grid()</code> will generate a plot for all possible group combinations:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="basic-plotting-and-visualization.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb280-2"><a href="basic-plotting-and-visualization.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;navy&#39;</span>) <span class="sc">+</span></span>
<span id="cb280-3"><a href="basic-plotting-and-visualization.html#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&#39;salmon&#39;</span>) <span class="sc">+</span></span>
<span id="cb280-4"><a href="basic-plotting-and-visualization.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(species, sex))</span>
<span id="cb280-5"><a href="basic-plotting-and-visualization.html#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="st">&#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="basic-plotting-and-visualization.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb281-2"><a href="basic-plotting-and-visualization.html#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb281-3"><a href="basic-plotting-and-visualization.html#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&#39;navy&#39;</span>) <span class="sc">+</span></span>
<span id="cb281-4"><a href="basic-plotting-and-visualization.html#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&#39;salmon&#39;</span>) <span class="sc">+</span></span>
<span id="cb281-5"><a href="basic-plotting-and-visualization.html#cb281-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(sex), <span class="at">cols =</span> <span class="fu">vars</span>(species)) </span>
<span id="cb281-6"><a href="basic-plotting-and-visualization.html#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="st">&#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-298-2.png" width="672" /></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="basic-plotting-and-visualization.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Note that facet_grid() has separate `rows` and `cols` arguments for specifying</span></span>
<span id="cb282-2"><a href="basic-plotting-and-visualization.html#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># faceting variables</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aggregation-and-group-operations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="selected-topics-in-statistical-inference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uvastatlab/Python_and_R/edit/main/07-basic-plotting-and-visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
