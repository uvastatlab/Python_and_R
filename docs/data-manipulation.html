<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Manipulation | Python and R</title>
  <meta name="description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Manipulation | Python and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="github-repo" content="uvastatlab/Python_and_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Manipulation | Python and R" />
  
  <meta name="twitter:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  

<meta name="author" content="Clay Ford, Jacob Goldstein-Greenwood, Oyinkansola Adenekan, Samantha Lomuscio" />


<meta name="date" content="2022-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="import-export-and-save-data.html"/>
<link rel="next" href="combine-reshape-and-merge.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Python and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>1</b> Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics.html"><a href="basics.html#math"><i class="fa fa-check"></i><b>1.1</b> Math</a></li>
<li class="chapter" data-level="1.2" data-path="basics.html"><a href="basics.html#missing-values"><i class="fa fa-check"></i><b>1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.3" data-path="basics.html"><a href="basics.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Assignment</a></li>
<li class="chapter" data-level="1.4" data-path="basics.html"><a href="basics.html#printing-a-value"><i class="fa fa-check"></i><b>1.4</b> Printing a value</a></li>
<li class="chapter" data-level="1.5" data-path="basics.html"><a href="basics.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a></li>
<li class="chapter" data-level="1.6" data-path="basics.html"><a href="basics.html#logic"><i class="fa fa-check"></i><b>1.6</b> Logic</a></li>
<li class="chapter" data-level="1.7" data-path="basics.html"><a href="basics.html#generating-a-sequence-of-values"><i class="fa fa-check"></i><b>1.7</b> Generating a sequence of values</a></li>
<li class="chapter" data-level="1.8" data-path="basics.html"><a href="basics.html#calculating-means-and-medians"><i class="fa fa-check"></i><b>1.8</b> Calculating means and medians</a></li>
<li class="chapter" data-level="1.9" data-path="basics.html"><a href="basics.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.9</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#one-dimensional-data"><i class="fa fa-check"></i><b>2.1</b> One-dimensional data</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-data"><i class="fa fa-check"></i><b>2.2</b> Two-dimensional data</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#three-dimensional-and-higher-data"><i class="fa fa-check"></i><b>2.3</b> Three-dimensional and higher data</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#general-data-structures"><i class="fa fa-check"></i><b>2.4</b> General data structures</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html"><i class="fa fa-check"></i><b>3</b> Import, Export, and Save Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#csv"><i class="fa fa-check"></i><b>3.1</b> CSV</a></li>
<li class="chapter" data-level="3.2" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xlsxlsx-excel"><i class="fa fa-check"></i><b>3.2</b> XLS/XLSX (Excel)</a></li>
<li class="chapter" data-level="3.3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#json"><i class="fa fa-check"></i><b>3.3</b> JSON</a></li>
<li class="chapter" data-level="3.4" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xml"><i class="fa fa-check"></i><b>3.4</b> XML</a></li>
<li class="chapter" data-level="3.5" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#exportingwritingsaving-data-and-variables"><i class="fa fa-check"></i><b>3.5</b> Exporting/Writing/Saving data and variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#view-variable-names-and-types"><i class="fa fa-check"></i><b>4.1</b> View variable names and types</a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#select-variables"><i class="fa fa-check"></i><b>4.2</b> Select variables</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#filtersubset-variables"><i class="fa fa-check"></i><b>4.3</b> Filter/Subset variables</a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#rename-variables"><i class="fa fa-check"></i><b>4.4</b> Rename variables</a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation.html"><a href="data-manipulation.html#create-replace-and-remove-variables"><i class="fa fa-check"></i><b>4.5</b> Create, replace and remove variables</a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation.html"><a href="data-manipulation.html#create-strings-from-numbers"><i class="fa fa-check"></i><b>4.6</b> Create strings from numbers</a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation.html"><a href="data-manipulation.html#create-numbers-from-strings"><i class="fa fa-check"></i><b>4.7</b> Create numbers from strings</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation.html"><a href="data-manipulation.html#combine-strings"><i class="fa fa-check"></i><b>4.8</b> Combine strings</a></li>
<li class="chapter" data-level="4.9" data-path="data-manipulation.html"><a href="data-manipulation.html#finding-and-replacing-patterns-within-strings"><i class="fa fa-check"></i><b>4.9</b> Finding and replacing patterns within strings</a></li>
<li class="chapter" data-level="4.10" data-path="data-manipulation.html"><a href="data-manipulation.html#change-case"><i class="fa fa-check"></i><b>4.10</b> Change case</a></li>
<li class="chapter" data-level="4.11" data-path="data-manipulation.html"><a href="data-manipulation.html#drop-duplicate-rows"><i class="fa fa-check"></i><b>4.11</b> Drop duplicate rows</a></li>
<li class="chapter" data-level="4.12" data-path="data-manipulation.html"><a href="data-manipulation.html#format-dates"><i class="fa fa-check"></i><b>4.12</b> Format dates</a></li>
<li class="chapter" data-level="4.13" data-path="data-manipulation.html"><a href="data-manipulation.html#randomly-sample-rows"><i class="fa fa-check"></i><b>4.13</b> Randomly sample rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html"><i class="fa fa-check"></i><b>5</b> Combine, Reshape and Merge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-rows"><i class="fa fa-check"></i><b>5.1</b> Combine rows</a></li>
<li class="chapter" data-level="5.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-columns"><i class="fa fa-check"></i><b>5.2</b> Combine columns</a></li>
<li class="chapter" data-level="5.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#reshaping-data"><i class="fa fa-check"></i><b>5.3</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#wide-to-long"><i class="fa fa-check"></i><b>5.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="5.3.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#long-to-wide"><i class="fa fa-check"></i><b>5.3.2</b> Long to wide</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#mergejoin"><i class="fa fa-check"></i><b>5.4</b> Merge/Join</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#left-join"><i class="fa fa-check"></i><b>5.4.1</b> Left Join</a></li>
<li class="chapter" data-level="5.4.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#right-join"><i class="fa fa-check"></i><b>5.4.2</b> Right Join</a></li>
<li class="chapter" data-level="5.4.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#inner-join"><i class="fa fa-check"></i><b>5.4.3</b> Inner Join</a></li>
<li class="chapter" data-level="5.4.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#outer-join"><i class="fa fa-check"></i><b>5.4.4</b> Outer Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html"><i class="fa fa-check"></i><b>6</b> Aggregation and Group Operations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#cross-tabulation"><i class="fa fa-check"></i><b>6.1</b> Cross tabulation</a></li>
<li class="chapter" data-level="6.2" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#group-summaries"><i class="fa fa-check"></i><b>6.2</b> Group summaries</a></li>
<li class="chapter" data-level="6.3" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.3</b> Centering and Scaling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html"><i class="fa fa-check"></i><b>7</b> Basic Plotting and Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#barplots"><i class="fa fa-check"></i><b>7.2</b> Barplots</a></li>
<li class="chapter" data-level="7.3" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#scatterplot"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.4" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#stripcharts"><i class="fa fa-check"></i><b>7.4</b> Stripcharts</a></li>
<li class="chapter" data-level="7.5" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#boxplots"><i class="fa fa-check"></i><b>7.5</b> Boxplots</a></li>
<li class="chapter" data-level="7.6" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#facet-plots"><i class="fa fa-check"></i><b>7.6</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html"><i class="fa fa-check"></i><b>8</b> Selected Topics in Statistical Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-means"><i class="fa fa-check"></i><b>8.1</b> Comparing group means</a></li>
<li class="chapter" data-level="8.2" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-proportions"><i class="fa fa-check"></i><b>8.2</b> Comparing group proportions</a></li>
<li class="chapter" data-level="8.3" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#linear-modeling"><i class="fa fa-check"></i><b>8.3</b> Linear modeling</a></li>
<li class="chapter" data-level="8.4" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-manipulation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Data Manipulation<a href="data-manipulation.html#data-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter discusses strategies for filtering, selecting, modifying, and deriving variables in data. Unless otherwise stated, examples are for DataFrames (Python) and data frames (R) and use the <code>mtcars</code> data frame that is included with R.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb237-1"><a href="data-manipulation.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python</span></span>
<span id="cb237-2"><a href="data-manipulation.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas</span>
<span id="cb237-3"><a href="data-manipulation.html#cb237-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">=</span> pandas.read_csv(<span class="st">&#39;data/mtcars.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="data-manipulation.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R</span></span>
<span id="cb238-2"><a href="data-manipulation.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb238-3"><a href="data-manipulation.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># drop row names to match Python version of data</span></span>
<span id="cb238-4"><a href="data-manipulation.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mtcars) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div id="view-variable-names-and-types" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> View variable names and types<a href="data-manipulation.html#view-variable-names-and-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>View and inspect the names of variables and their types (numeric, string, logical, etc.).</p>
<div id="python-17" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-17" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>.info()</code> function in pandas returns information about a DataFrame.</p>
<p>Setting the argument <code>verbose</code> to <code>True</code> prints the names of the columns, their lengths excluding <code>NULL</code> values, and their data types (<code>dtype</code>) in a table. The function lists the unique data types in the DataFrame, and it prints the amount of memory the DataFrame occupies.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="data-manipulation.html#cb239-1" aria-hidden="true" tabindex="-1"></a>mtcars.info(verbose <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<pre><code>## &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
## RangeIndex: 32 entries, 0 to 31
## Data columns (total 11 columns):
##  #   Column  Non-Null Count  Dtype  
## ---  ------  --------------  -----  
##  0   mpg     32 non-null     float64
##  1   cyl     32 non-null     int64  
##  2   disp    32 non-null     float64
##  3   hp      32 non-null     int64  
##  4   drat    32 non-null     float64
##  5   wt      32 non-null     float64
##  6   qsec    32 non-null     float64
##  7   vs      32 non-null     int64  
##  8   am      32 non-null     int64  
##  9   gear    32 non-null     int64  
##  10  carb    32 non-null     int64  
## dtypes: float64(5), int64(6)
## memory usage: 2.9 KB</code></pre>
<p>Setting <code>verbose</code> to <code>False</code> excludes the table describing each column.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="data-manipulation.html#cb241-1" aria-hidden="true" tabindex="-1"></a>mtcars.info(verbose <span class="op">=</span> <span class="va">False</span>)</span></code></pre></div>
<pre><code>## &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
## RangeIndex: 32 entries, 0 to 31
## Columns: 11 entries, mpg to carb
## dtypes: float64(5), int64(6)
## memory usage: 2.9 KB</code></pre>
<p>If a DataFrame has 100 or fewer columns, the <code>verbose</code> argument defaults to <code>True</code>.</p>
</div>
<div id="r-17" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-17" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>str()</code> function in R lists the names of the variables, their types, the first few values of each, and the object dimensions.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="data-manipulation.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<p>To see just the names of the data frame, use the <code>names()</code> function.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="data-manipulation.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot; &quot;carb&quot;</code></pre>
<p>To see just the dimensions of the data frame, use the <code>dim()</code> function. It returns the number of rows and columns, respectively.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data-manipulation.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mtcars)</span></code></pre></div>
<pre><code>## [1] 32 11</code></pre>
</div>
</div>
<div id="select-variables" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Select variables<a href="data-manipulation.html#select-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How to select specific columns of data frames.</p>
<div id="python-18" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-18" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The period operator <code>.</code> provides access to a column in a DataFrame as a vector. This returns a pandas Series. A pandas Series can do everything a NumPy array can do.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="data-manipulation.html#cb249-1" aria-hidden="true" tabindex="-1"></a>mtcars.mpg</span></code></pre></div>
<pre><code>## 0     21.0
## 1     21.0
## 2     22.8
## 3     21.4
## 4     18.7
## 5     18.1
## 6     14.3
## 7     24.4
## 8     22.8
## 9     19.2
## 10    17.8
## 11    16.4
## 12    17.3
## 13    15.2
## 14    10.4
## 15    10.4
## 16    14.7
## 17    32.4
## 18    30.4
## 19    33.9
## 20    21.5
## 21    15.5
## 22    15.2
## 23    13.3
## 24    19.2
## 25    27.3
## 26    26.0
## 27    30.4
## 28    15.8
## 29    19.7
## 30    15.0
## 31    21.4
## Name: mpg, dtype: float64</code></pre>
<p>Indexing also provides access to columns as a pandas Series. Single and double quotations both work.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb251-1"><a href="data-manipulation.html#cb251-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">&#39;mpg&#39;</span>]</span></code></pre></div>
<pre><code>## 0     21.0
## 1     21.0
## 2     22.8
## 3     21.4
## 4     18.7
## 5     18.1
## 6     14.3
## 7     24.4
## 8     22.8
## 9     19.2
## 10    17.8
## 11    16.4
## 12    17.3
## 13    15.2
## 14    10.4
## 15    10.4
## 16    14.7
## 17    32.4
## 18    30.4
## 19    33.9
## 20    21.5
## 21    15.5
## 22    15.2
## 23    13.3
## 24    19.2
## 25    27.3
## 26    26.0
## 27    30.4
## 28    15.8
## 29    19.7
## 30    15.0
## 31    21.4
## Name: mpg, dtype: float64</code></pre>
<p>Operations on NumPy arrays are faster than operations on pandas Series. But in many cases, using pandas Series is fine performance-wise. This consideration is primarily important for large data sets on which many operations are performed. The <code>.values</code> function returns a NumPy array from a pandas DataFrame.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb253-1"><a href="data-manipulation.html#cb253-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">&#39;mpg&#39;</span>].values</span></code></pre></div>
<pre><code>## array([21. , 21. , 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.8,
##        16.4, 17.3, 15.2, 10.4, 10.4, 14.7, 32.4, 30.4, 33.9, 21.5, 15.5,
##        15.2, 13.3, 19.2, 27.3, 26. , 30.4, 15.8, 19.7, 15. , 21.4])</code></pre>
<p>Double indexing returns a pandas DataFrame instead of a NumPy array or pandas Series.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb255-1"><a href="data-manipulation.html#cb255-1" aria-hidden="true" tabindex="-1"></a>mtcars[[<span class="st">&#39;mpg&#39;</span>]]</span></code></pre></div>
<pre><code>##      mpg
## 0   21.0
## 1   21.0
## 2   22.8
## 3   21.4
## 4   18.7
## 5   18.1
## 6   14.3
## 7   24.4
## 8   22.8
## 9   19.2
## 10  17.8
## 11  16.4
## 12  17.3
## 13  15.2
## 14  10.4
## 15  10.4
## 16  14.7
## 17  32.4
## 18  30.4
## 19  33.9
## 20  21.5
## 21  15.5
## 22  15.2
## 23  13.3
## 24  19.2
## 25  27.3
## 26  26.0
## 27  30.4
## 28  15.8
## 29  19.7
## 30  15.0
## 31  21.4</code></pre>
<p>The <code>head()</code> and <code>tail()</code> functions return the first five or last five values, respectively. Use the <code>n</code> argument to change the number of values. This function works on NumPy arrays, pandas Series and pandas DataFrames.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb257-1"><a href="data-manipulation.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First six values</span></span>
<span id="cb257-2"><a href="data-manipulation.html#cb257-2" aria-hidden="true" tabindex="-1"></a>mtcars.mpg.head()</span></code></pre></div>
<pre><code>## 0    21.0
## 1    21.0
## 2    22.8
## 3    21.4
## 4    18.7
## Name: mpg, dtype: float64</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="data-manipulation.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Last row of DataFrame</span></span>
<span id="cb259-2"><a href="data-manipulation.html#cb259-2" aria-hidden="true" tabindex="-1"></a>mtcars.tail(n <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##      mpg  cyl   disp   hp  drat    wt  qsec  vs  am  gear  carb
## 31  21.4    4  121.0  109  4.11  2.78  18.6   1   1     4     2</code></pre>
</div>
<div id="r-18" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-18" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The dollar sign operator, <code>$</code>, provides access to a column in a data frame as a vector.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-manipulation.html#cb261-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>mpg</span></code></pre></div>
<pre><code>##  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7 15.0 21.4</code></pre>
<p>Double-indexing brackets also provide access to columns as a vector.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-manipulation.html#cb263-1" aria-hidden="true" tabindex="-1"></a>mtcars[[<span class="st">&quot;mpg&quot;</span>]]</span></code></pre></div>
<pre><code>##  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7 15.0 21.4</code></pre>
<p>Single-indexing brackets work as well, but they return a data frame instead of a vector (if used with a data frame).</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-manipulation.html#cb265-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">&quot;mpg&quot;</span>]</span></code></pre></div>
<pre><code>##     mpg
## 1  21.0
## 2  21.0
## 3  22.8
## 4  21.4
## 5  18.7
## 6  18.1
## 7  14.3
## 8  24.4
## 9  22.8
## 10 19.2
## 11 17.8
## 12 16.4
## 13 17.3
## 14 15.2
## 15 10.4
## 16 10.4
## 17 14.7
## 18 32.4
## 19 30.4
## 20 33.9
## 21 21.5
## 22 15.5
## 23 15.2
## 24 13.3
## 25 19.2
## 26 27.3
## 27 26.0
## 28 30.4
## 29 15.8
## 30 19.7
## 31 15.0
## 32 21.4</code></pre>
<p>Single-indexing brackets also allow selection of rows when used with a comma. The syntax is <code>rows, columns</code></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-manipulation.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First three rows</span></span>
<span id="cb267-2"><a href="data-manipulation.html#cb267-2" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">&quot;mpg&quot;</span>]</span></code></pre></div>
<pre><code>## [1] 21.0 21.0 22.8</code></pre>
<p>Finally single-indexing brackets allow us to select multiple columns. Request columns either by name or position using a vector.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="data-manipulation.html#cb269-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="fu">c</span>(<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;cyl&quot;</span>)] </span></code></pre></div>
<pre><code>##     mpg cyl
## 1  21.0   6
## 2  21.0   6
## 3  22.8   4
## 4  21.4   6
## 5  18.7   8
## 6  18.1   6
## 7  14.3   8
## 8  24.4   4
## 9  22.8   4
## 10 19.2   6
## 11 17.8   6
## 12 16.4   8
## 13 17.3   8
## 14 15.2   8
## 15 10.4   8
## 16 10.4   8
## 17 14.7   8
## 18 32.4   4
## 19 30.4   4
## 20 33.9   4
## 21 21.5   4
## 22 15.5   8
## 23 15.2   8
## 24 13.3   8
## 25 19.2   8
## 26 27.3   4
## 27 26.0   4
## 28 30.4   4
## 29 15.8   8
## 30 19.7   6
## 31 15.0   8
## 32 21.4   4</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="data-manipulation.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent to mtcars[1:2] </span></span></code></pre></div>
<p>The <code>head()</code> and <code>tail()</code> functions return the first six or last six values, respectively. Use the <code>n</code> argument to change the number of values. These functions work with vectors, data frames, matrices, and more.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-manipulation.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First six values</span></span>
<span id="cb272-2"><a href="data-manipulation.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars<span class="sc">$</span>mpg)</span></code></pre></div>
<pre><code>## [1] 21.0 21.0 22.8 21.4 18.7 18.1</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="data-manipulation.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Last row of data frame</span></span>
<span id="cb274-2"><a href="data-manipulation.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(mtcars, <span class="at">n =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##     mpg cyl disp  hp drat   wt qsec vs am gear carb
## 32 21.4   4  121 109 4.11 2.78 18.6  1  1    4    2</code></pre>
</div>
</div>
<div id="filtersubset-variables" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Filter/Subset variables<a href="data-manipulation.html#filtersubset-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Selecting rows of a rectangular data set that meet certain conditions.</p>
<div id="python-19" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-19" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can filter rows of a DataFrame based on subsetting conditions; the data type returned depends on the filtration method.</p>
<p>The following example returns a DataFrame, not a Series, as there is more than one column selected from the DataFrame. Use a list, square brackets [], to subset more than one column.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb276-1"><a href="data-manipulation.html#cb276-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars[<span class="st">&quot;mpg&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>][[<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;cyl&quot;</span>]]</span></code></pre></div>
<pre><code>##      mpg  cyl
## 17  32.4    4
## 18  30.4    4
## 19  33.9    4
## 27  30.4    4</code></pre>
<p>Both pandas Series and NumPy arrays can be used for fast performance and vector operations. Many functions require a vector as input.</p>
<p>The following code returns one column, <code>mpg</code>, as a pandas Series. A pandas Series is one column from a pandas DataFrame.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb278-1"><a href="data-manipulation.html#cb278-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars[<span class="st">&quot;mpg&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>][<span class="st">&quot;mpg&quot;</span>]</span></code></pre></div>
<pre><code>## 17    32.4
## 18    30.4
## 19    33.9
## 27    30.4
## Name: mpg, dtype: float64</code></pre>
<p>The following code also returns a pandas Series, but it uses the <code>.</code> operator to select a column, rather than square brackets <code>[]</code>.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb280-1"><a href="data-manipulation.html#cb280-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars[<span class="st">&quot;mpg&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>].mpg</span></code></pre></div>
<pre><code>## 17    32.4
## 18    30.4
## 19    33.9
## 27    30.4
## Name: mpg, dtype: float64</code></pre>
<p>Both of the following lines of code return NumPy arrays using the <code>.values</code> function. <code>df1</code> is one dimension, reflecting just the <code>mpg</code> column, and <code>df2</code> is two dimensions, reflecting the <code>mpg</code> and <code>cyl</code> columns.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb282-1"><a href="data-manipulation.html#cb282-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> mtcars[mtcars[<span class="st">&quot;mpg&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>][<span class="st">&quot;mpg&quot;</span>].values</span>
<span id="cb282-2"><a href="data-manipulation.html#cb282-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> mtcars[mtcars[<span class="st">&quot;mpg&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>][[<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;cyl&quot;</span>]].values</span></code></pre></div>
<p>You can also filter using multiple row conditions:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb283-1"><a href="data-manipulation.html#cb283-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars[<span class="st">&quot;mpg&quot;</span>] <span class="op">&gt;</span> <span class="dv">30</span>][mtcars[<span class="st">&quot;hp&quot;</span>] <span class="op">&lt;</span> <span class="dv">66</span>]</span></code></pre></div>
<pre><code>##      mpg  cyl  disp  hp  drat     wt   qsec  vs  am  gear  carb
## 18  30.4    4  75.7  52  4.93  1.615  18.52   1   1     4     2
## 19  33.9    4  71.1  65  4.22  1.835  19.90   1   1     4     1
## 
## &lt;string&gt;:1: UserWarning: Boolean Series key will be reindexed to match DataFrame index.</code></pre>
</div>
<div id="r-19" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-19" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In base R, we can use subsetting brackets or the <code>subset()</code> function to select rows based on some condition. Below, we demonstrate both approaches, returning only those rows with <code>mpg</code> greater than 30. We begin with subsetting brackets, which take three arguments:</p>
<ol style="list-style-type: decimal">
<li><code>i</code>: the condition to subset on.</li>
<li><code>j</code>: the columns to show. If none specified, all columns are returned</li>
<li><code>drop</code>: an optional logical argument (TRUE/FALSE) to determine whether or not to coerce the output to the lowest possible dimension. The default is TRUE.</li>
</ol>
<p>We rarely type the first two argument names, <code>i</code> and <code>j</code>, when using subsetting brackets.</p>
<p>This example returns only the rows with mpg &gt; 30 and all columns. Notice we need to preface mpg with <code>mtcars$</code> to tell R where to find the “mpg” column and that we need to provide a comma after the condition.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="data-manipulation.html#cb285-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">30</span>, ]</span></code></pre></div>
<pre><code>##     mpg cyl disp  hp drat    wt  qsec vs am gear carb
## 18 32.4   4 78.7  66 4.08 2.200 19.47  1  1    4    1
## 19 30.4   4 75.7  52 4.93 1.615 18.52  1  1    4    2
## 20 33.9   4 71.1  65 4.22 1.835 19.90  1  1    4    1
## 28 30.4   4 95.1 113 3.77 1.513 16.90  1  1    5    2</code></pre>
<p>We can select the columns to return in the second argument as a vector. Notice that we only need to specify the column names as a character vector. We can also use numbers corresponding to the column positions, as well as conditional statements.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="data-manipulation.html#cb287-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="fu">c</span>(<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;wt&quot;</span>, <span class="st">&quot;gear&quot;</span>)]</span></code></pre></div>
<pre><code>##     mpg    wt gear
## 18 32.4 2.200    4
## 19 30.4 1.615    4
## 20 33.9 1.835    4
## 28 30.4 1.513    5</code></pre>
<p>Show the first three columns:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="data-manipulation.html#cb289-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##     mpg cyl disp
## 18 32.4   4 78.7
## 19 30.4   4 75.7
## 20 33.9   4 71.1
## 28 30.4   4 95.1</code></pre>
<p>Show columns with names consisting of only two characters. The <code>nchar()</code> function counts the number of characters in a string. The expression <code>nchar(names(mtcars)) == 2</code> returns a vector of <code>TRUE</code>/<code>FALSE</code> values where <code>TRUE</code> indicates the column name is only two characters in length.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="data-manipulation.html#cb291-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="fu">nchar</span>(<span class="fu">names</span>(mtcars)) <span class="sc">==</span> <span class="dv">2</span>]</span></code></pre></div>
<pre><code>##     hp    wt vs am
## 18  66 2.200  1  1
## 19  52 1.615  1  1
## 20  65 1.835  1  1
## 28 113 1.513  1  1</code></pre>
<p>Notice that when we specify only one column, the brackets return a vector.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="data-manipulation.html#cb293-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="st">&quot;mpg&quot;</span>]</span></code></pre></div>
<pre><code>## [1] 32.4 30.4 33.9 30.4</code></pre>
<p>To get a data frame, set the <code>drop</code> argument to FALSE.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="data-manipulation.html#cb295-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="st">&quot;mpg&quot;</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div>
<pre><code>##     mpg
## 18 32.4
## 19 30.4
## 20 33.9
## 28 30.4</code></pre>
<p>The <code>subset()</code> function allows us to refer to column names without using the <code>$</code> extractor function or quoting column names. It also has a drop argument, but its default is <code>FALSE.</code> It has four arguments:</p>
<ol style="list-style-type: decimal">
<li><code>x</code>: the data frame to subset.</li>
<li><code>subset</code>: the condition to subset on.</li>
<li><code>select</code>: the columns to select.</li>
<li><code>drop</code>: an optional logical argument (TRUE/FALSE) to determine whether or not to coerce the output to the lowest possible dimension. The default is FALSE.</li>
</ol>
<p>We rarely type the first three argument names, <code>x</code>, <code>subset</code> and <code>select</code>, when using <code>subset()</code>.</p>
<p>Below we replicate the previous examples using <code>subset()</code>.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="data-manipulation.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return rows where mpg &gt; 30 and all columns</span></span>
<span id="cb297-2"><a href="data-manipulation.html#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##     mpg cyl disp  hp drat    wt  qsec vs am gear carb
## 18 32.4   4 78.7  66 4.08 2.200 19.47  1  1    4    1
## 19 30.4   4 75.7  52 4.93 1.615 18.52  1  1    4    2
## 20 33.9   4 71.1  65 4.22 1.835 19.90  1  1    4    1
## 28 30.4   4 95.1 113 3.77 1.513 16.90  1  1    5    2</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="data-manipulation.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return rows where mpg &gt; 30 and the mpg, wt, and gear columns</span></span>
<span id="cb299-2"><a href="data-manipulation.html#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="fu">c</span>(mpg, wt, gear))</span></code></pre></div>
<pre><code>##     mpg    wt gear
## 18 32.4 2.200    4
## 19 30.4 1.615    4
## 20 33.9 1.835    4
## 28 30.4 1.513    5</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="data-manipulation.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return rows where mpg &gt; 30 and the first three columns</span></span>
<span id="cb301-2"><a href="data-manipulation.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     mpg cyl disp
## 18 32.4   4 78.7
## 19 30.4   4 75.7
## 20 33.9   4 71.1
## 28 30.4   4 95.1</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="data-manipulation.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return rows where mpg &gt; 30 and columns consisting of two characters</span></span>
<span id="cb303-2"><a href="data-manipulation.html#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="fu">nchar</span>(<span class="fu">names</span>(mtcars)) <span class="sc">==</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##     hp    wt vs am
## 18  66 2.200  1  1
## 19  52 1.615  1  1
## 20  65 1.835  1  1
## 28 113 1.513  1  1</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="data-manipulation.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return rows where mpg &gt; 30 and mpg column, as a vector</span></span>
<span id="cb305-2"><a href="data-manipulation.html#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">30</span>, mpg, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 32.4 30.4 33.9 30.4</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="data-manipulation.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return rows where mpg &gt; 30 and mpg column, as a data frame</span></span>
<span id="cb307-2"><a href="data-manipulation.html#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(mtcars, mpg <span class="sc">&gt;</span> <span class="dv">30</span>, mpg)</span></code></pre></div>
<pre><code>##     mpg
## 18 32.4
## 19 30.4
## 20 33.9
## 28 30.4</code></pre>
<p>Another difference between subsetting brackets and the <code>subset()</code> function is how they handle missing values. Subsetting brackets return missing values while <code>subset()</code> does not. We demonstrate below with a toy data frame. Notice the <code>x</code> column has a missing value.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="data-manipulation.html#cb309-1" aria-hidden="true" tabindex="-1"></a>dframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">5</span>), </span>
<span id="cb309-2"><a href="data-manipulation.html#cb309-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">21</span>, <span class="dv">34</span>))</span>
<span id="cb309-3"><a href="data-manipulation.html#cb309-3" aria-hidden="true" tabindex="-1"></a>dframe</span></code></pre></div>
<pre><code>##    x  y
## 1  1 12
## 2 NA 21
## 3  5 34</code></pre>
<p>When we condition on <code>x &lt; 3</code>, the subsetting bracket approach returns a row with <code>NA</code> values.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="data-manipulation.html#cb311-1" aria-hidden="true" tabindex="-1"></a>dframe[dframe<span class="sc">$</span>x <span class="sc">&lt;</span> <span class="dv">3</span>, ]</span></code></pre></div>
<pre><code>##     x  y
## 1   1 12
## NA NA NA</code></pre>
<p>The <code>subset()</code> approach ignores the missing value.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data-manipulation.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(dframe, x <span class="sc">&lt;</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   x  y
## 1 1 12</code></pre>
<p>To replicate the <code>subset()</code> result with the subsetting brackets, we need to include an additional condition to only show rows where x is <em>not</em> missing. We can do that with the <code>is.na()</code> function. The <code>is.na()</code> function returns <code>TRUE</code> if a value is missing and <code>FALSE</code> otherwise. If we preface with <code>!</code>, we get <code>TRUE</code> if a value is <em>not</em> missing and <code>FALSE</code> otherwise.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data-manipulation.html#cb315-1" aria-hidden="true" tabindex="-1"></a>dframe[dframe<span class="sc">$</span>x <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dframe<span class="sc">$</span>x),]</span></code></pre></div>
<pre><code>##   x  y
## 1 1 12</code></pre>
<p>See also the <code>filter()</code> function in the <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> package and the enhanced subsetting brackets in the <a href="https://rdatatable.gitlab.io/data.table/"><strong>data.table</strong></a> package.</p>
</div>
</div>
<div id="rename-variables" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Rename variables<a href="data-manipulation.html#rename-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="python-20" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-20" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Column names can be changed using the function <code>.rename()</code>. Below, we change the column names <code>cyl</code> and <code>wt</code> to <code>cylinder</code> and <code>WT</code>, respectively.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb317-1"><a href="data-manipulation.html#cb317-1" aria-hidden="true" tabindex="-1"></a>mtcars.rename(columns <span class="op">=</span> {<span class="st">&quot;cyl&quot;</span>:<span class="st">&quot;cylinder&quot;</span>, <span class="st">&quot;wt&quot;</span>:<span class="st">&quot;WT&quot;</span>})</span></code></pre></div>
<pre><code>##      mpg  cylinder   disp   hp  drat     WT   qsec  vs  am  gear  carb
## 0   21.0         6  160.0  110  3.90  2.620  16.46   0   1     4     4
## 1   21.0         6  160.0  110  3.90  2.875  17.02   0   1     4     4
## 2   22.8         4  108.0   93  3.85  2.320  18.61   1   1     4     1
## 3   21.4         6  258.0  110  3.08  3.215  19.44   1   0     3     1
## 4   18.7         8  360.0  175  3.15  3.440  17.02   0   0     3     2
## 5   18.1         6  225.0  105  2.76  3.460  20.22   1   0     3     1
## 6   14.3         8  360.0  245  3.21  3.570  15.84   0   0     3     4
## 7   24.4         4  146.7   62  3.69  3.190  20.00   1   0     4     2
## 8   22.8         4  140.8   95  3.92  3.150  22.90   1   0     4     2
## 9   19.2         6  167.6  123  3.92  3.440  18.30   1   0     4     4
## 10  17.8         6  167.6  123  3.92  3.440  18.90   1   0     4     4
## 11  16.4         8  275.8  180  3.07  4.070  17.40   0   0     3     3
## 12  17.3         8  275.8  180  3.07  3.730  17.60   0   0     3     3
## 13  15.2         8  275.8  180  3.07  3.780  18.00   0   0     3     3
## 14  10.4         8  472.0  205  2.93  5.250  17.98   0   0     3     4
## 15  10.4         8  460.0  215  3.00  5.424  17.82   0   0     3     4
## 16  14.7         8  440.0  230  3.23  5.345  17.42   0   0     3     4
## 17  32.4         4   78.7   66  4.08  2.200  19.47   1   1     4     1
## 18  30.4         4   75.7   52  4.93  1.615  18.52   1   1     4     2
## 19  33.9         4   71.1   65  4.22  1.835  19.90   1   1     4     1
## 20  21.5         4  120.1   97  3.70  2.465  20.01   1   0     3     1
## 21  15.5         8  318.0  150  2.76  3.520  16.87   0   0     3     2
## 22  15.2         8  304.0  150  3.15  3.435  17.30   0   0     3     2
## 23  13.3         8  350.0  245  3.73  3.840  15.41   0   0     3     4
## 24  19.2         8  400.0  175  3.08  3.845  17.05   0   0     3     2
## 25  27.3         4   79.0   66  4.08  1.935  18.90   1   1     4     1
## 26  26.0         4  120.3   91  4.43  2.140  16.70   0   1     5     2
## 27  30.4         4   95.1  113  3.77  1.513  16.90   1   1     5     2
## 28  15.8         8  351.0  264  4.22  3.170  14.50   0   1     5     4
## 29  19.7         6  145.0  175  3.62  2.770  15.50   0   1     5     6
## 30  15.0         8  301.0  335  3.54  3.570  14.60   0   1     5     8
## 31  21.4         4  121.0  109  4.11  2.780  18.60   1   1     4     2</code></pre>
<p>Alternatively, column names can be changed by replacing the vector of column names with a new vector. Below, we create a vector of columns that replaces <code>drat</code> with <code>axle_ratio</code> using conditional match and that replaces <code>disp</code> with <code>DISP</code> using indexing.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb319-1"><a href="data-manipulation.html#cb319-1" aria-hidden="true" tabindex="-1"></a>column_names <span class="op">=</span> mtcars.columns.values</span>
<span id="cb319-2"><a href="data-manipulation.html#cb319-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-3"><a href="data-manipulation.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using conditional match</span></span>
<span id="cb319-4"><a href="data-manipulation.html#cb319-4" aria-hidden="true" tabindex="-1"></a>column_names[column_names <span class="op">==</span> <span class="st">&quot;drat&quot;</span>] <span class="op">=</span> <span class="st">&quot;axle_ratio&quot;</span></span>
<span id="cb319-5"><a href="data-manipulation.html#cb319-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-6"><a href="data-manipulation.html#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Using indexing</span></span>
<span id="cb319-7"><a href="data-manipulation.html#cb319-7" aria-hidden="true" tabindex="-1"></a>column_names[<span class="dv">2</span>] <span class="op">=</span> <span class="st">&quot;DISP&quot;</span></span>
<span id="cb319-8"><a href="data-manipulation.html#cb319-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-9"><a href="data-manipulation.html#cb319-9" aria-hidden="true" tabindex="-1"></a>mtcars.columns <span class="op">=</span> column_names</span>
<span id="cb319-10"><a href="data-manipulation.html#cb319-10" aria-hidden="true" tabindex="-1"></a>mtcars.columns</span></code></pre></div>
<pre><code>## Index([&#39;mpg&#39;, &#39;cyl&#39;, &#39;DISP&#39;, &#39;hp&#39;, &#39;axle_ratio&#39;, &#39;wt&#39;, &#39;qsec&#39;, &#39;vs&#39;, &#39;am&#39;,
##        &#39;gear&#39;, &#39;carb&#39;],
##       dtype=&#39;object&#39;)</code></pre>
</div>
<div id="r-20" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-20" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Variable names can be changed by referencing their indexes (i.e., their positions among the columns in a data frame). Below the second column is <code>cyl</code>. We change the name to <code>cylinders.</code></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="data-manipulation.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] &quot;cyl&quot;</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="data-manipulation.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;cylinders&quot;</span></span>
<span id="cb323-2"><a href="data-manipulation.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;       &quot;cylinders&quot; &quot;disp&quot;      &quot;hp&quot;        &quot;drat&quot;      &quot;wt&quot;        &quot;qsec&quot;      &quot;vs&quot;        &quot;am&quot;        &quot;gear&quot;      &quot;carb&quot;</code></pre>
<p>Variable names can also be changed by conditional match. Below we find the variable name that matches <code>drat</code> and change it to <code>axle_ratio.</code></p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="data-manipulation.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)[<span class="fu">names</span>(mtcars) <span class="sc">==</span> <span class="st">&quot;drat&quot;</span>]</span></code></pre></div>
<pre><code>## [1] &quot;drat&quot;</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="data-manipulation.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)[<span class="fu">names</span>(mtcars) <span class="sc">==</span> <span class="st">&quot;drat&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;axle_ratio&quot;</span></span>
<span id="cb327-2"><a href="data-manipulation.html#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;        &quot;cylinders&quot;  &quot;disp&quot;       &quot;hp&quot;         &quot;axle_ratio&quot; &quot;wt&quot;         &quot;qsec&quot;       &quot;vs&quot;         &quot;am&quot;         &quot;gear&quot;       &quot;carb&quot;</code></pre>
<p>More than one variable name can be changed using a vector of positions or matches.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="data-manipulation.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)[<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;weight&quot;</span>, <span class="st">&quot;engine&quot;</span>)</span>
<span id="cb329-2"><a href="data-manipulation.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively: names(mtcars)[names(mtcars) %in% c(&quot;wt&quot;, &quot;vs&quot;)] &lt;- c(&quot;weight&quot;, &quot;engine&quot;)</span></span>
<span id="cb329-3"><a href="data-manipulation.html#cb329-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-4"><a href="data-manipulation.html#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;        &quot;cylinders&quot;  &quot;disp&quot;       &quot;hp&quot;         &quot;axle_ratio&quot; &quot;weight&quot;     &quot;qsec&quot;       &quot;engine&quot;     &quot;am&quot;         &quot;gear&quot;       &quot;carb&quot;</code></pre>
<p>See also the <code>rename()</code> function in the <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> package.</p>
</div>
</div>
<div id="create-replace-and-remove-variables" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Create, replace and remove variables<a href="data-manipulation.html#create-replace-and-remove-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We often need to create variables that are functions of other variables, or we need to replace existing variables with updated versions thereof.</p>
<div id="python-21" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-21" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Adding a new variable via indexing notation and assigning a result to it adds a new column.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb331-1"><a href="data-manipulation.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column for kilometer per liter</span></span>
<span id="cb331-2"><a href="data-manipulation.html#cb331-2" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">&#39;kpl&#39;</span>] <span class="op">=</span> mtcars.mpg <span class="op">/</span> <span class="fl">2.352</span></span></code></pre></div>
<p>Doing the same with an <em>existing</em> column updates the values in the column.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb332-1"><a href="data-manipulation.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update to liters per 100 kilometers</span></span>
<span id="cb332-2"><a href="data-manipulation.html#cb332-2" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">&#39;kpl&#39;</span>] <span class="op">=</span> <span class="dv">100</span> <span class="op">/</span> mtcars.kpl </span></code></pre></div>
<p>Alternatively, the <code>.</code> notation can be used to update the values in a column.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb333-1"><a href="data-manipulation.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update to liters per 50 Kilometers</span></span>
<span id="cb333-2"><a href="data-manipulation.html#cb333-2" aria-hidden="true" tabindex="-1"></a>mtcars.kpl <span class="op">=</span> <span class="dv">50</span> <span class="op">/</span> mtcars.kpl </span></code></pre></div>
<p>To remove a column, use the <code>.drop()</code> function.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb334-1"><a href="data-manipulation.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the kpl variable</span></span>
<span id="cb334-2"><a href="data-manipulation.html#cb334-2" aria-hidden="true" tabindex="-1"></a>mtcars.drop(columns <span class="op">=</span> [<span class="st">&#39;kpl&#39;</span>])</span></code></pre></div>
<pre><code>##      mpg  cyl   DISP   hp  axle_ratio     wt   qsec  vs  am  gear  carb
## 0   21.0    6  160.0  110        3.90  2.620  16.46   0   1     4     4
## 1   21.0    6  160.0  110        3.90  2.875  17.02   0   1     4     4
## 2   22.8    4  108.0   93        3.85  2.320  18.61   1   1     4     1
## 3   21.4    6  258.0  110        3.08  3.215  19.44   1   0     3     1
## 4   18.7    8  360.0  175        3.15  3.440  17.02   0   0     3     2
## 5   18.1    6  225.0  105        2.76  3.460  20.22   1   0     3     1
## 6   14.3    8  360.0  245        3.21  3.570  15.84   0   0     3     4
## 7   24.4    4  146.7   62        3.69  3.190  20.00   1   0     4     2
## 8   22.8    4  140.8   95        3.92  3.150  22.90   1   0     4     2
## 9   19.2    6  167.6  123        3.92  3.440  18.30   1   0     4     4
## 10  17.8    6  167.6  123        3.92  3.440  18.90   1   0     4     4
## 11  16.4    8  275.8  180        3.07  4.070  17.40   0   0     3     3
## 12  17.3    8  275.8  180        3.07  3.730  17.60   0   0     3     3
## 13  15.2    8  275.8  180        3.07  3.780  18.00   0   0     3     3
## 14  10.4    8  472.0  205        2.93  5.250  17.98   0   0     3     4
## 15  10.4    8  460.0  215        3.00  5.424  17.82   0   0     3     4
## 16  14.7    8  440.0  230        3.23  5.345  17.42   0   0     3     4
## 17  32.4    4   78.7   66        4.08  2.200  19.47   1   1     4     1
## 18  30.4    4   75.7   52        4.93  1.615  18.52   1   1     4     2
## 19  33.9    4   71.1   65        4.22  1.835  19.90   1   1     4     1
## 20  21.5    4  120.1   97        3.70  2.465  20.01   1   0     3     1
## 21  15.5    8  318.0  150        2.76  3.520  16.87   0   0     3     2
## 22  15.2    8  304.0  150        3.15  3.435  17.30   0   0     3     2
## 23  13.3    8  350.0  245        3.73  3.840  15.41   0   0     3     4
## 24  19.2    8  400.0  175        3.08  3.845  17.05   0   0     3     2
## 25  27.3    4   79.0   66        4.08  1.935  18.90   1   1     4     1
## 26  26.0    4  120.3   91        4.43  2.140  16.70   0   1     5     2
## 27  30.4    4   95.1  113        3.77  1.513  16.90   1   1     5     2
## 28  15.8    8  351.0  264        4.22  3.170  14.50   0   1     5     4
## 29  19.7    6  145.0  175        3.62  2.770  15.50   0   1     5     6
## 30  15.0    8  301.0  335        3.54  3.570  14.60   0   1     5     8
## 31  21.4    4  121.0  109        4.11  2.780  18.60   1   1     4     2</code></pre>
</div>
<div id="r-21" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-21" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Adding a new variable name after the dollar sign notation and assigning a result to it adds a new column.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="data-manipulation.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column for kilometer per liter</span></span>
<span id="cb336-2"><a href="data-manipulation.html#cb336-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>kpl <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg <span class="sc">/</span> <span class="fl">2.352</span></span></code></pre></div>
<p>Doing the same with an <em>existing</em> variable updates the values in a column.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="data-manipulation.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update to liters per 100 Kilometers</span></span>
<span id="cb337-2"><a href="data-manipulation.html#cb337-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>kpl <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">/</span> mtcars<span class="sc">$</span>kpl </span></code></pre></div>
<p>To remove a variable, assign it <code>NULL</code>.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="data-manipulation.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the kpl variable</span></span>
<span id="cb338-2"><a href="data-manipulation.html#cb338-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>kpl <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>See also the <code>mutate()</code> function in the <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> package.</p>
</div>
</div>
<div id="create-strings-from-numbers" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Create strings from numbers<a href="data-manipulation.html#create-strings-from-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may have data that is numeric but that needs to be treated as a string.</p>
<div id="python-22" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can change the data type of a column in a DataFrame using the <code>astype</code> function.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb339-1"><a href="data-manipulation.html#cb339-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">&#39;am&#39;</span>] <span class="op">=</span> mtcars[<span class="st">&#39;am&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb339-2"><a href="data-manipulation.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(mtcars.am[<span class="dv">0</span>]) <span class="co"># check the type of the first item in am column</span></span></code></pre></div>
<pre><code>## &lt;class &#39;str&#39;&gt;</code></pre>
<p>A potential number-to-string conversion task in Python might be formatting 5-digit American ZIP Codes. Some zip codes begin with 0, but if stored as a numeric value, the 0 is dropped. For example, consider the following pandas DataFrame. Notice that the leading 0 is dropped from two of the ZIP Codes.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb341-1"><a href="data-manipulation.html#cb341-1" aria-hidden="true" tabindex="-1"></a>zc <span class="op">=</span> pandas.read_csv(<span class="st">&#39;data/zc.csv&#39;</span>)</span>
<span id="cb341-2"><a href="data-manipulation.html#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(zc)</span></code></pre></div>
<pre><code>##   state    zip
## 0    VT   5001
## 1    VA  22901
## 2    NH   3282</code></pre>
<p>One way to fix this is using the string <code>zfill()</code> method. First, we convert the numeric column to string type using the method we just demonstrated. Then we access the <code>zip</code> column using <code>zc.zip</code> and the <code>zfill()</code> method using <code>str.zfill</code> with the width parameter set to 5. This pads the string with <code>0</code> on the left as necessary to make each value five characters wide.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb343-1"><a href="data-manipulation.html#cb343-1" aria-hidden="true" tabindex="-1"></a>zc[<span class="st">&#39;zip&#39;</span>] <span class="op">=</span> zc[<span class="st">&#39;zip&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb343-2"><a href="data-manipulation.html#cb343-2" aria-hidden="true" tabindex="-1"></a>zc[<span class="st">&#39;zip&#39;</span>] <span class="op">=</span> zc.<span class="bu">zip</span>.<span class="bu">str</span>.zfill(<span class="dv">5</span>)</span>
<span id="cb343-3"><a href="data-manipulation.html#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(zc)</span></code></pre></div>
<pre><code>##   state    zip
## 0    VT  05001
## 1    VA  22901
## 2    NH  03282</code></pre>
<p>If we knew we were importing zip codes using <code>read_csv</code>, we could also use the <code>dtype</code> argument to specify which storage type to use for the <code>zip</code> column. Below, we pass a dictionary that maps the <code>str</code> type to the <code>zip</code> column. The result is a properly formatted ZIP Code column.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb345-1"><a href="data-manipulation.html#cb345-1" aria-hidden="true" tabindex="-1"></a>zc <span class="op">=</span> pandas.read_csv(<span class="st">&#39;data/zc.csv&#39;</span>, dtype <span class="op">=</span> {<span class="st">&#39;zip&#39;</span>:<span class="st">&#39;str&#39;</span>})</span>
<span id="cb345-2"><a href="data-manipulation.html#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(zc)</span></code></pre></div>
<pre><code>##   state    zip
## 0    VT  05001
## 1    VA  22901
## 2    NH  03282</code></pre>
</div>
<div id="r-22" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-22" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>as.character()</code> function takes a vector and converts it to string format.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="data-manipulation.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars<span class="sc">$</span>am)</span></code></pre></div>
<pre><code>## [1] 1 1 1 0 0 0</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="data-manipulation.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as.character</span>(mtcars<span class="sc">$</span>am))</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot;</code></pre>
<p>To save the results of this process—this conversion—we need to <em>assign</em> the result to the data frame.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="data-manipulation.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add new string variable am_ch</span></span>
<span id="cb351-2"><a href="data-manipulation.html#cb351-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am_ch <span class="ot">&lt;-</span> <span class="fu">as.character</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb351-3"><a href="data-manipulation.html#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars<span class="sc">$</span>am_ch)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; &quot;0&quot;</code></pre>
<p>The <code>factor()</code> function can also be used to convert a numeric vector into a categorical variable. However, the result is not exactly a string: A factor is made of integers with character labels. Factors are useful for character data that have a fixed set of levels (e.g., “grade 1,” grade 2,” etc.).</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="data-manipulation.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to factor</span></span>
<span id="cb353-2"><a href="data-manipulation.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars<span class="sc">$</span>am)</span></code></pre></div>
<pre><code>## [1] 1 1 1 0 0 0</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="data-manipulation.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>am))</span></code></pre></div>
<pre><code>## [1] 1 1 1 0 0 0
## Levels: 0 1</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="data-manipulation.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to factor with labels</span></span>
<span id="cb357-2"><a href="data-manipulation.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>am, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;automatic&quot;</span>, <span class="st">&quot;manual&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] manual    manual    manual    automatic automatic automatic
## Levels: automatic manual</code></pre>
<p>As before, to save the results of this conversion to the data frame, we need to assign the results to a variable:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="data-manipulation.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create factor variable am_fac</span></span>
<span id="cb359-2"><a href="data-manipulation.html#cb359-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am_fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>am, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;automatic&quot;</span>, <span class="st">&quot;manual&quot;</span>))</span>
<span id="cb359-3"><a href="data-manipulation.html#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars<span class="sc">$</span>am_fac)</span></code></pre></div>
<pre><code>## [1] manual    manual    manual    automatic automatic automatic
## Levels: automatic manual</code></pre>
<p>A common number-to-string conversion task in R is formatting 5-digit American ZIP Codes as demonstrated above in Python. Some zip codes begin with 0, but if stored as a numeric value, the 0 is dropped.</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="data-manipulation.html#cb361-1" aria-hidden="true" tabindex="-1"></a>zip_codes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">03766</span>, <span class="dv">03748</span>, <span class="dv">22901</span>, <span class="dv">03264</span>)</span>
<span id="cb361-2"><a href="data-manipulation.html#cb361-2" aria-hidden="true" tabindex="-1"></a>zip_codes</span></code></pre></div>
<pre><code>## [1]  3766  3748 22901  3264</code></pre>
<p>We need to store the zip code as a character value so the 0 is preserved. One way to do this is via the <code>sprintf()</code> function in base R. The first argument is the <em>format string</em> or <em>conversion specification</em>. A conversion specification begins with <code>%</code>. The following <code>0</code> and <code>5</code> says to format the zip_codes vector as a 5-digit string padded by zeroes on the left. The final <code>i</code> says we’re working with integer values.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="data-manipulation.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;%05i&quot;</span>, zip_codes)</span></code></pre></div>
<pre><code>## [1] &quot;03766&quot; &quot;03748&quot; &quot;22901&quot; &quot;03264&quot;</code></pre>
<p>See also the <code>str_pad()</code> function in the <strong>stringr</strong> package.</p>
</div>
</div>
<div id="create-numbers-from-strings" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Create numbers from strings<a href="data-manipulation.html#create-numbers-from-strings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>String variables that ought to be numbers usually have some character data contained in the values, such as units (e.g., “4 cm”). To create numbers from strings, it’s important to remove any character data that cannot be converted to a number.</p>
<div id="python-23" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-23" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>astype(float)</code> or <code>astype(int)</code> function will coerce strings to numerical representation.</p>
<p>For demonstration, let’s say we have the following NumPy array:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb365-1"><a href="data-manipulation.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb365-2"><a href="data-manipulation.html#cb365-2" aria-hidden="true" tabindex="-1"></a>weight <span class="op">=</span> np.array([<span class="st">&quot;125 lbs.&quot;</span>, <span class="st">&quot;132 lbs.&quot;</span>, <span class="st">&quot;156 lbs.&quot;</span>])</span></code></pre></div>
<p>The <code>astype(float)</code> function throws an error due to the presence of strings. The <code>astype()</code> function is for NumPy arrays.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb366-1"><a href="data-manipulation.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb366-2"><a href="data-manipulation.html#cb366-2" aria-hidden="true" tabindex="-1"></a>  weight.astype(<span class="bu">float</span>)</span>
<span id="cb366-3"><a href="data-manipulation.html#cb366-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb366-4"><a href="data-manipulation.html#cb366-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;ValueError: could not convert string to float: &#39;125 lbs.&#39;&quot;</span>)</span></code></pre></div>
<pre><code>## ValueError: could not convert string to float: &#39;125 lbs.&#39;</code></pre>
<p>One way to approach this is to first remove the strings from the objects and then use <code>astype(float)</code>. Below we use the <code>strip()</code> function to find ” lbs.” using a list comprehension.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb368-1"><a href="data-manipulation.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [] indicates a list in python</span></span>
<span id="cb368-2"><a href="data-manipulation.html#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="co"># np.array() changes the list back into an array</span></span>
<span id="cb368-3"><a href="data-manipulation.html#cb368-3" aria-hidden="true" tabindex="-1"></a>weight <span class="op">=</span> np.array([w.strip(<span class="st">&quot; lbs.&quot;</span>) <span class="cf">for</span> w <span class="kw">in</span> weight])</span></code></pre></div>
<p>Now we can use the <code>astype()</code> function to change the elements in weight from <code>str</code> to <code>float</code>.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb369-1"><a href="data-manipulation.html#cb369-1" aria-hidden="true" tabindex="-1"></a>weight.astype(<span class="bu">float</span>)</span></code></pre></div>
<pre><code>## array([125., 132., 156.])</code></pre>
</div>
<div id="r-23" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-23" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>as.numeric()</code> function will attempt to coerce strings to numeric type <em>if possible</em>. Any non-numeric values are coerced to <code>NA</code>.</p>
<p>For demonstration, say we have the following vector:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="data-manipulation.html#cb371-1" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;125 lbs.&quot;</span>, <span class="st">&quot;132 lbs.&quot;</span>, <span class="st">&quot;156 lbs.&quot;</span>)</span></code></pre></div>
<p>The <code>as.numeric()</code> function returns all NA due to presence of character data.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="data-manipulation.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(weight)</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<pre><code>## [1] NA NA NA</code></pre>
<p>There are many ways to approach this. A common approach is to first remove the characters and then use <code>as.numeric()</code>. Below, we use the <code>gsub()</code> function to find “lbs.” and replace it with nothing (find-and-replace procedures are discussed more below).</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="data-manipulation.html#cb375-1" aria-hidden="true" tabindex="-1"></a>weightN <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; lbs.&quot;</span>, <span class="st">&quot;&quot;</span>, weight)</span>
<span id="cb375-2"><a href="data-manipulation.html#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(weightN)</span></code></pre></div>
<pre><code>## [1] 125 132 156</code></pre>
<p>The <code>parse_number()</code> function in the <strong>readr</strong> package can often take care of these situations automatically.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="data-manipulation.html#cb377-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">parse_number</span>(weight)</span></code></pre></div>
<pre><code>## [1] 125 132 156</code></pre>
</div>
</div>
<div id="combine-strings" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Combine strings<a href="data-manipulation.html#combine-strings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>String concatenation—turning “Jane” and “Smith” into “Jane Smith”—is easily done in both languages.</p>
<div id="python-24" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-24" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>+</code> operator can combine strings in Python.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb379-1"><a href="data-manipulation.html#cb379-1" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> <span class="st">&#39;yellow-bellied sea snake&#39;</span></span>
<span id="cb379-2"><a href="data-manipulation.html#cb379-2" aria-hidden="true" tabindex="-1"></a>tail_shape <span class="op">=</span> <span class="st">&#39;paddle-shaped&#39;</span></span>
<span id="cb379-3"><a href="data-manipulation.html#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="data-manipulation.html#cb379-4" aria-hidden="true" tabindex="-1"></a>statement <span class="op">=</span> <span class="st">&#39;The &#39;</span> <span class="op">+</span> species <span class="op">+</span> <span class="st">&#39; has a &#39;</span> <span class="op">+</span> tail_shape <span class="op">+</span> <span class="st">&#39; tail that helps it swim.&#39;</span></span>
<span id="cb379-5"><a href="data-manipulation.html#cb379-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statement)</span></code></pre></div>
<pre><code>## The yellow-bellied sea snake has a paddle-shaped tail that helps it swim.</code></pre>
</div>
<div id="r-24" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-24" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>paste()</code> and <code>paste0()</code> functions combine strings in R. The former concatenates strings and places spaces between them; the latter concatenates sans spaces.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="data-manipulation.html#cb381-1" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="st">&#39;rainbow boa&#39;</span></span>
<span id="cb381-2"><a href="data-manipulation.html#cb381-2" aria-hidden="true" tabindex="-1"></a>appearance <span class="ot">&lt;-</span> <span class="st">&#39;iridescent&#39;</span></span>
<span id="cb381-3"><a href="data-manipulation.html#cb381-3" aria-hidden="true" tabindex="-1"></a>location <span class="ot">&lt;-</span> <span class="st">&#39;Central and South America&#39;</span></span>
<span id="cb381-4"><a href="data-manipulation.html#cb381-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-5"><a href="data-manipulation.html#cb381-5" aria-hidden="true" tabindex="-1"></a>statement1 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&#39;The&#39;</span>, species, <span class="st">&#39;has an&#39;</span>, appearance, <span class="st">&#39;sheen.&#39;</span>)</span>
<span id="cb381-6"><a href="data-manipulation.html#cb381-6" aria-hidden="true" tabindex="-1"></a>statement1</span></code></pre></div>
<pre><code>## [1] &quot;The rainbow boa has an iridescent sheen.&quot;</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="data-manipulation.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that spaces must be provided explicitly when using paste0()</span></span>
<span id="cb383-2"><a href="data-manipulation.html#cb383-2" aria-hidden="true" tabindex="-1"></a>statement2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;The &#39;</span>, species, <span class="st">&#39; is found in &#39;</span>, location)</span>
<span id="cb383-3"><a href="data-manipulation.html#cb383-3" aria-hidden="true" tabindex="-1"></a>statement2</span></code></pre></div>
<pre><code>## [1] &quot;The rainbow boa is found in Central and South America&quot;</code></pre>
</div>
</div>
<div id="finding-and-replacing-patterns-within-strings" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Finding and replacing patterns within strings<a href="data-manipulation.html#finding-and-replacing-patterns-within-strings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section reviews key functions in Python and R for finding and replacing character patterns. The functions we discuss can search for fixed character patterns (e.g., “Meredith Rollins” to case-sensitively match that name and that name alone) or regular expression (regex) patterns (e.g., <code>\w+</code> to capture all instances of &gt;=1 alphabetic character). Note that in R, meta characters like <code>w</code> (to match word characters) and <code>d</code> (to match digits) are escaped with <em>two</em> backslashes (e.g., <code>\\w</code> and <code>\\d</code>). In Python, regex patterns are generally headed by <code>r</code>, which allows meta characters in the regex itself to be escaped with just one <code>\</code> (e.g., <code>r"\w+"</code>). Regex is an enormous topic, and we don’t discuss it at any length here, but you can learn more about regular expressions—and how they’re implemented in different programming languages—at these websites: <a href="https://www.regular-expressions.info/" class="uri">https://www.regular-expressions.info/</a>; <a href="https://regexone.com/" class="uri">https://regexone.com/</a></p>
<div id="python-25" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-25" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>re</strong> module provides a set of functions for searching and manipulating strings. The <code>search()</code> function does exactly as its name suggests: It identifies matches for a fixed or regex character pattern in a string. <code>sub()</code> searches for and replaces character patterns (fixed or regex). The <code>count</code> argument in <code>sub()</code> allows a user to specify how many instances of the matched pattern they want to to replace; e.g., use <code>count = 1</code> to replace just the first instance of a match.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb385-1"><a href="data-manipulation.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb385-2"><a href="data-manipulation.html#cb385-2" aria-hidden="true" tabindex="-1"></a>statement <span class="op">=</span> <span class="st">&#39;Pencils with an HB graphite grade are commonly used for writing. An HB pencil is approximately equal to a #2 pencil.&#39;</span></span>
<span id="cb385-3"><a href="data-manipulation.html#cb385-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-4"><a href="data-manipulation.html#cb385-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for &quot;HB&quot; using fixed and regex patterns</span></span>
<span id="cb385-5"><a href="data-manipulation.html#cb385-5" aria-hidden="true" tabindex="-1"></a>search_result1 <span class="op">=</span> re.search(pattern <span class="op">=</span> <span class="st">&quot;HB&quot;</span>, string <span class="op">=</span> statement)</span>
<span id="cb385-6"><a href="data-manipulation.html#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(search_result1)</span></code></pre></div>
<pre><code>## &lt;re.Match object; span=(16, 18), match=&#39;HB&#39;&gt;</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb387-1"><a href="data-manipulation.html#cb387-1" aria-hidden="true" tabindex="-1"></a>search_result2 <span class="op">=</span> re.search(pattern <span class="op">=</span> <span class="vs">r&quot;[H,B]</span><span class="sc">{2}</span><span class="vs">&quot;</span>, string <span class="op">=</span> statement)</span>
<span id="cb387-2"><a href="data-manipulation.html#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(search_result2)</span></code></pre></div>
<pre><code>## &lt;re.Match object; span=(16, 18), match=&#39;HB&#39;&gt;</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb389-1"><a href="data-manipulation.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of &quot;HB&quot;</span></span>
<span id="cb389-2"><a href="data-manipulation.html#cb389-2" aria-hidden="true" tabindex="-1"></a>all_replaced <span class="op">=</span> re.sub(pattern <span class="op">=</span> <span class="st">&#39;HB&#39;</span>, repl <span class="op">=</span> <span class="st">&#39;HB (hard black)&#39;</span>, string <span class="op">=</span> statement)</span>
<span id="cb389-3"><a href="data-manipulation.html#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(all_replaced)</span></code></pre></div>
<pre><code>## Pencils with an HB (hard black) graphite grade are commonly used for writing. An HB (hard black) pencil is approximately equal to a #2 pencil.</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb391-1"><a href="data-manipulation.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace just the first instance of HB</span></span>
<span id="cb391-2"><a href="data-manipulation.html#cb391-2" aria-hidden="true" tabindex="-1"></a>one_replaced <span class="op">=</span> re.sub(pattern <span class="op">=</span> <span class="st">&#39;HB&#39;</span>, repl <span class="op">=</span> <span class="st">&#39;HB (hard black)&#39;</span>, string <span class="op">=</span> statement, count <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb391-3"><a href="data-manipulation.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(one_replaced)</span></code></pre></div>
<pre><code>## Pencils with an HB (hard black) graphite grade are commonly used for writing. An HB pencil is approximately equal to a #2 pencil.</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb393-1"><a href="data-manipulation.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Search and replace using a regex pattern instead of a fixed string</span></span>
<span id="cb393-2"><a href="data-manipulation.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Replace a space after a period with a line break)</span></span>
<span id="cb393-3"><a href="data-manipulation.html#cb393-3" aria-hidden="true" tabindex="-1"></a>regex_replaced <span class="op">=</span> re.sub(pattern <span class="op">=</span> <span class="vs">r&#39;(?&lt;=\.)\s</span><span class="sc">{1}</span><span class="vs">&#39;</span>, repl <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, string <span class="op">=</span> statement)</span>
<span id="cb393-4"><a href="data-manipulation.html#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(regex_replaced)</span></code></pre></div>
<pre><code>## Pencils with an HB graphite grade are commonly used for writing.
## An HB pencil is approximately equal to a #2 pencil.</code></pre>
</div>
<div id="r-25" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-25" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The standard-issue string-search function in base R is <code>grep()</code>; it returns the index of the elements in a set of one or more strings for which a pattern match was found. (<code>grepl()</code> acts similarly but returns a vector of <code>TRUE</code>/<code>FALSE</code> indicating whether a match was found in each string passed to the function.) The functions <code>sub()</code> and <code>gsub()</code> can be used to find and replace instances of a pattern: The former replaces just the first instance; the latter replaces all instances. The search pattern can be provided as a raw character string or as a regular expression.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="data-manipulation.html#cb395-1" aria-hidden="true" tabindex="-1"></a>statements <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Great Pencil Co. primarily sells pencils of the following grades: HB; B; and 3B.&#39;</span>,</span>
<span id="cb395-2"><a href="data-manipulation.html#cb395-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;Great Pencil Co. has its headquarters in Maine, and Great Pencil Co. has supplied the Northeast for decades.&#39;</span>)</span>
<span id="cb395-3"><a href="data-manipulation.html#cb395-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-4"><a href="data-manipulation.html#cb395-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Search for a pattern and return the indexes of elements for which a match is found</span></span>
<span id="cb395-5"><a href="data-manipulation.html#cb395-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">&#39;pencil&#39;</span>, <span class="at">x =</span> statements, <span class="at">fixed =</span> <span class="cn">TRUE</span>) <span class="co"># use `fixed = T` to search for exactly the declared string: &quot;pencil&quot; in all lowercase, which is only found in one string</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="data-manipulation.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="at">pattern =</span> <span class="st">&#39;(?i)pencil&#39;</span>, <span class="at">x =</span> statements) <span class="co"># using regex allows for flexible searches, such as a case-insensitive search for &quot;P/pencil&quot;, which, unlike &quot;pencil&quot; is found in in both strings</span></span></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="data-manipulation.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace the first instance of a pattern (Co. --&gt; Company)</span></span>
<span id="cb399-2"><a href="data-manipulation.html#cb399-2" aria-hidden="true" tabindex="-1"></a>revised <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="at">pattern =</span> <span class="st">&#39;Co</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;Company&#39;</span>, <span class="at">x =</span> statements)</span>
<span id="cb399-3"><a href="data-manipulation.html#cb399-3" aria-hidden="true" tabindex="-1"></a>revised</span></code></pre></div>
<pre><code>## [1] &quot;Great Pencil Company primarily sells pencils of the following grades: HB; B; and 3B.&quot;                             &quot;Great Pencil Company has its headquarters in Maine, and Great Pencil Co. has supplied the Northeast for decades.&quot;</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="data-manipulation.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of a pattern (; --&gt; ,)</span></span>
<span id="cb401-2"><a href="data-manipulation.html#cb401-2" aria-hidden="true" tabindex="-1"></a>revised2 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&#39;;&#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;,&#39;</span>, <span class="at">x =</span> revised)</span>
<span id="cb401-3"><a href="data-manipulation.html#cb401-3" aria-hidden="true" tabindex="-1"></a>revised2</span></code></pre></div>
<pre><code>## [1] &quot;Great Pencil Company primarily sells pencils of the following grades: HB, B, and 3B.&quot;                             &quot;Great Pencil Company has its headquarters in Maine, and Great Pencil Co. has supplied the Northeast for decades.&quot;</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="data-manipulation.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and replace a pattern using regex (3B --&gt; 2B)</span></span>
<span id="cb403-2"><a href="data-manipulation.html#cb403-2" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="at">pattern =</span> <span class="st">&#39;</span><span class="sc">\\</span><span class="st">d{1}&#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;2&#39;</span>, <span class="at">x =</span> revised2)</span>
<span id="cb403-3"><a href="data-manipulation.html#cb403-3" aria-hidden="true" tabindex="-1"></a>final</span></code></pre></div>
<pre><code>## [1] &quot;Great Pencil Company primarily sells pencils of the following grades: HB, B, and 2B.&quot;                             &quot;Great Pencil Company has its headquarters in Maine, and Great Pencil Co. has supplied the Northeast for decades.&quot;</code></pre>
<p>Those functions can be used to trim excess (or all) white space in character strings.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="data-manipulation.html#cb405-1" aria-hidden="true" tabindex="-1"></a>spaced_string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;This      string    started  out with too    many    spaces.&#39;</span>)</span>
<span id="cb405-2"><a href="data-manipulation.html#cb405-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of &gt;=2 spaces with single spaces</span></span>
<span id="cb405-3"><a href="data-manipulation.html#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&#39;</span><span class="sc">\\</span><span class="st">s{2,}&#39;</span>, <span class="at">replacement =</span> <span class="st">&#39; &#39;</span>, <span class="at">x =</span> spaced_string)</span></code></pre></div>
<pre><code>## [1] &quot;This string started out with too many spaces.&quot;</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="data-manipulation.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all white space</span></span>
<span id="cb407-2"><a href="data-manipulation.html#cb407-2" aria-hidden="true" tabindex="-1"></a>collapse_these <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;9:00 - 10:15&#39;</span>, <span class="st">&#39;10:15 - 11:30&#39;</span>, <span class="st">&#39;11:30 - 12:00&#39;</span>)</span>
<span id="cb407-3"><a href="data-manipulation.html#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">&#39;</span><span class="sc">\\</span><span class="st">s&#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;&#39;</span>, <span class="at">x =</span> collapse_these)</span></code></pre></div>
<pre><code>## [1] &quot;9:00-10:15&quot;  &quot;10:15-11:30&quot; &quot;11:30-12:00&quot;</code></pre>
<p>The package <strong>stringi</strong> also provides an array of string-search and string-manipulation functions, including <code>stri_detect()</code>, <code>stri_replace()</code>, and <code>stri_extract()</code>, all of which easily handle fixed and regex search patterns. For example:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="data-manipulation.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringi)</span>
<span id="cb409-2"><a href="data-manipulation.html#cb409-2" aria-hidden="true" tabindex="-1"></a>user_dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&#39;Shire, Jane E&#39;</span>, <span class="st">&#39;Winchester, Marcus L&#39;</span>, <span class="st">&#39;Fox, Sal&#39;</span>),</span>
<span id="cb409-3"><a href="data-manipulation.html#cb409-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">id_number =</span> <span class="fu">c</span>(<span class="st">&#39;aaa101&#39;</span>, <span class="st">&#39;aaa102&#39;</span>, <span class="st">&#39;aaa103&#39;</span>))</span>
<span id="cb409-4"><a href="data-manipulation.html#cb409-4" aria-hidden="true" tabindex="-1"></a>user_dat</span></code></pre></div>
<pre><code>##                   name id_number
## 1        Shire, Jane E    aaa101
## 2 Winchester, Marcus L    aaa102
## 3             Fox, Sal    aaa103</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="data-manipulation.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Say we want to to eliminate the &#39;aaa&#39; patterns from the user IDs and then add</span></span>
<span id="cb411-2"><a href="data-manipulation.html#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="co"># middle initials---for those users who have them---to the data frame</span></span>
<span id="cb411-3"><a href="data-manipulation.html#cb411-3" aria-hidden="true" tabindex="-1"></a>user_dat<span class="sc">$</span>id_number <span class="ot">&lt;-</span> <span class="fu">stri_replace</span>(user_dat<span class="sc">$</span>id_number, <span class="at">regex =</span> <span class="st">&#39;^</span><span class="sc">\\</span><span class="st">w{3}(?=</span><span class="sc">\\</span><span class="st">d+)&#39;</span>, <span class="at">replacement =</span> <span class="st">&#39;&#39;</span>) <span class="co"># alternatively: stri_extract(user_dat$id_number, regex = &#39;(?&lt;=\\w{3})\\d+$&#39;)</span></span>
<span id="cb411-4"><a href="data-manipulation.html#cb411-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-5"><a href="data-manipulation.html#cb411-5" aria-hidden="true" tabindex="-1"></a>user_dat<span class="sc">$</span>middle_initial <span class="ot">&lt;-</span> <span class="fu">stri_extract</span>(user_dat<span class="sc">$</span>name, <span class="at">regex =</span> <span class="st">&#39;</span><span class="sc">\\</span><span class="st">b</span><span class="sc">\\</span><span class="st">w{1}$&#39;</span>)</span>
<span id="cb411-6"><a href="data-manipulation.html#cb411-6" aria-hidden="true" tabindex="-1"></a>user_dat</span></code></pre></div>
<pre><code>##                   name id_number middle_initial
## 1        Shire, Jane E       101              E
## 2 Winchester, Marcus L       102              L
## 3             Fox, Sal       103           &lt;NA&gt;</code></pre>
</div>
</div>
<div id="change-case" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Change case<a href="data-manipulation.html#change-case" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How to change the case of strings. The most common case transformations are lower case, upper case, and title case.</p>
<div id="python-26" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-26" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>lower()</code>, <code>upper()</code>, and <code>title()</code> functions convert strings to lower, upper, and title case, respectively. We can use a list comprehension to apply these functions to each string in a list.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb413-1"><a href="data-manipulation.html#cb413-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> [col.upper() <span class="cf">for</span> col <span class="kw">in</span> mtcars.columns]</span>
<span id="cb413-2"><a href="data-manipulation.html#cb413-2" aria-hidden="true" tabindex="-1"></a>mtcars.columns <span class="op">=</span> col_names</span></code></pre></div>
</div>
<div id="r-26" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-26" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>tolower()</code> and <code>toupper()</code> functions convert case to lower and upper, respectively.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="data-manipulation.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars) <span class="ot">&lt;-</span> <span class="fu">toupper</span>(<span class="fu">names</span>(mtcars))</span>
<span id="cb414-2"><a href="data-manipulation.html#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;MPG&quot;        &quot;CYLINDERS&quot;  &quot;DISP&quot;       &quot;HP&quot;         &quot;AXLE_RATIO&quot; &quot;WEIGHT&quot;     &quot;QSEC&quot;       &quot;ENGINE&quot;     &quot;AM&quot;         &quot;GEAR&quot;       &quot;CARB&quot;       &quot;AM_CH&quot;      &quot;AM_FAC&quot;</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="data-manipulation.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars) <span class="ot">&lt;-</span> <span class="fu">tolower</span>(<span class="fu">names</span>(mtcars))</span>
<span id="cb416-2"><a href="data-manipulation.html#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;        &quot;cylinders&quot;  &quot;disp&quot;       &quot;hp&quot;         &quot;axle_ratio&quot; &quot;weight&quot;     &quot;qsec&quot;       &quot;engine&quot;     &quot;am&quot;         &quot;gear&quot;       &quot;carb&quot;       &quot;am_ch&quot;      &quot;am_fac&quot;</code></pre>
<p>The <strong>stringr</strong> package provides a convenient title-case conversion function, <code>str_to_title()</code>, which capitalizes the first letter of each string.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="data-manipulation.html#cb418-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_to_title</span>(<span class="fu">names</span>(mtcars))</span></code></pre></div>
<pre><code>##  [1] &quot;Mpg&quot;        &quot;Cylinders&quot;  &quot;Disp&quot;       &quot;Hp&quot;         &quot;Axle_ratio&quot; &quot;Weight&quot;     &quot;Qsec&quot;       &quot;Engine&quot;     &quot;Am&quot;         &quot;Gear&quot;       &quot;Carb&quot;       &quot;Am_ch&quot;      &quot;Am_fac&quot;</code></pre>
</div>
</div>
<div id="drop-duplicate-rows" class="section level2 hasAnchor" number="4.11">
<h2><span class="header-section-number">4.11</span> Drop duplicate rows<a href="data-manipulation.html#drop-duplicate-rows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How to find and drop duplicate elements.</p>
<div id="python-27" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-27" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>duplicated()</code> function determines which rows of a DataFrame are duplicates of previous rows.</p>
<p>First, we create a DataFrame with a duplicate row by using the pandas <code>concat()</code> function. <code>concat()</code> combines DataFrames by rows or columns (by rows is the default).</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb420-1"><a href="data-manipulation.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrame with duplicate rows</span></span>
<span id="cb420-2"><a href="data-manipulation.html#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb420-3"><a href="data-manipulation.html#cb420-3" aria-hidden="true" tabindex="-1"></a>mtcars2 <span class="op">=</span> pd.concat([mtcars.iloc[<span class="dv">0</span>:<span class="dv">3</span>,<span class="dv">0</span>:<span class="dv">6</span>], mtcars.iloc[<span class="dv">0</span>:<span class="dv">1</span>,<span class="dv">0</span>:<span class="dv">6</span>]])</span></code></pre></div>
<p>The <code>duplicated()</code> function returns a logical vector. TRUE indicates a row is a duplicate of a previous row.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb421-1"><a href="data-manipulation.html#cb421-1" aria-hidden="true" tabindex="-1"></a>mtcars2.duplicated()</span></code></pre></div>
<pre><code>## 0    False
## 1    False
## 2    False
## 0     True
## dtype: bool</code></pre>
</div>
<div id="r-27" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-27" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>duplicated()</code> function “determines which elements of a vector or data frame are duplicates of elements with smaller subscripts” (from <code>?duplicated</code>).</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="data-manipulation.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with duplicate rows</span></span>
<span id="cb423-2"><a href="data-manipulation.html#cb423-2" aria-hidden="true" tabindex="-1"></a>mtcars2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], mtcars[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb423-3"><a href="data-manipulation.html#cb423-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Last row is duplicate of first</span></span>
<span id="cb423-4"><a href="data-manipulation.html#cb423-4" aria-hidden="true" tabindex="-1"></a>mtcars2</span></code></pre></div>
<pre><code>##    mpg cylinders disp  hp axle_ratio weight
## 1 21.0         6  160 110       3.90  2.620
## 2 21.0         6  160 110       3.90  2.875
## 3 22.8         4  108  93       3.85  2.320
## 4 21.0         6  160 110       3.90  2.620</code></pre>
<p>The <code>duplicated()</code> function returns a logical vector. <code>TRUE</code> indicates that a given element is a duplicate of a previous one (and here, element = row).</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="data-manipulation.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The last row is a duplicate</span></span>
<span id="cb425-2"><a href="data-manipulation.html#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(mtcars2)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE</code></pre>
<p>The <code>TRUE</code>/<code>FALSE</code> vector can be used to extract or drop duplicate rows. Since <code>TRUE</code> in indexing brackets will keep a row, we can use <code>!</code> to negate the logicals and keep those that are <em>not</em> <code>TRUE.</code></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="data-manipulation.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the duplicate and update the data frame</span></span>
<span id="cb427-2"><a href="data-manipulation.html#cb427-2" aria-hidden="true" tabindex="-1"></a>mtcars3 <span class="ot">&lt;-</span> mtcars2[<span class="sc">!</span><span class="fu">duplicated</span>(mtcars2), ]</span>
<span id="cb427-3"><a href="data-manipulation.html#cb427-3" aria-hidden="true" tabindex="-1"></a>mtcars3</span></code></pre></div>
<pre><code>##    mpg cylinders disp  hp axle_ratio weight
## 1 21.0         6  160 110       3.90  2.620
## 2 21.0         6  160 110       3.90  2.875
## 3 22.8         4  108  93       3.85  2.320</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="data-manipulation.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and investigate the duplicate row</span></span>
<span id="cb429-2"><a href="data-manipulation.html#cb429-2" aria-hidden="true" tabindex="-1"></a>mtcars2[<span class="fu">duplicated</span>(mtcars2), ]</span></code></pre></div>
<pre><code>##   mpg cylinders disp  hp axle_ratio weight
## 4  21         6  160 110        3.9   2.62</code></pre>
<p>The <code>anyDuplicated()</code> function returns the row number of duplicate rows.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="data-manipulation.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyDuplicated</span>(mtcars2)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
</div>
</div>
<div id="format-dates" class="section level2 hasAnchor" number="4.12">
<h2><span class="header-section-number">4.12</span> Format dates<a href="data-manipulation.html#format-dates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With formatted dates, we can calculate elapsed times, extract components of a date, properly order the names of months, and more.</p>
<div id="python-28" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-28" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Python module <strong>datetime</strong> can be used to create various date and time objects. Here, we discuss four of the main classes within <strong>datetime</strong></p>
<p>The first class is the <code>date()</code> class. This creates a date object whose only attributes are year, month, and day.</p>
<p>Below, we create a date object using the <code>date()</code> class. The attributes are specified as integers in the arguments of <code>date()</code> in the following order: <code>date(year, month, day)</code>.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb433-1"><a href="data-manipulation.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt </span>
<span id="cb433-2"><a href="data-manipulation.html#cb433-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-3"><a href="data-manipulation.html#cb433-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> dt.date(<span class="dv">2001</span>, <span class="dv">4</span>, <span class="dv">12</span>)</span>
<span id="cb433-4"><a href="data-manipulation.html#cb433-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code></pre></div>
<pre><code>## 2001-04-12</code></pre>
<p>To get today’s date, we can use the <code>date.today()</code> function:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb435-1"><a href="data-manipulation.html#cb435-1" aria-hidden="true" tabindex="-1"></a>today <span class="op">=</span> dt.date.today()</span>
<span id="cb435-2"><a href="data-manipulation.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(today)</span></code></pre></div>
<pre><code>## 2022-05-26</code></pre>
<p>Note that the output of both <code>x</code> and <code>today</code> are only year-month-day because they are date objects.</p>
<p>We can extract each of these attributes (year, month, day) from the date object as follows:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb437-1"><a href="data-manipulation.html#cb437-1" aria-hidden="true" tabindex="-1"></a>today.year </span></code></pre></div>
<pre><code>## 2022</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb439-1"><a href="data-manipulation.html#cb439-1" aria-hidden="true" tabindex="-1"></a>today.month</span></code></pre></div>
<pre><code>## 5</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb441-1"><a href="data-manipulation.html#cb441-1" aria-hidden="true" tabindex="-1"></a>today.day</span></code></pre></div>
<pre><code>## 26</code></pre>
<p>Next is the <code>time()</code> class. This class creates time objects containing information about only a time. The attributes that go into the <code>time()</code> class are hours, minutes, and seconds in that order. Like the date class, these attributes must be input as integers.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb443-1"><a href="data-manipulation.html#cb443-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> dt.time(<span class="dv">11</span>, <span class="dv">34</span>, <span class="dv">56</span>)</span>
<span id="cb443-2"><a href="data-manipulation.html#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span></code></pre></div>
<pre><code>## 11:34:56</code></pre>
<p>If you want a time object containing only hours and minutes, or only seconds, etc. you can specify the attributes by name when creating the time object.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb445-1"><a href="data-manipulation.html#cb445-1" aria-hidden="true" tabindex="-1"></a>only_hrs <span class="op">=</span> dt.time(hour <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb445-2"><a href="data-manipulation.html#cb445-2" aria-hidden="true" tabindex="-1"></a>only_mins <span class="op">=</span> dt.time(minute <span class="op">=</span> <span class="dv">55</span>)</span>
<span id="cb445-3"><a href="data-manipulation.html#cb445-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-4"><a href="data-manipulation.html#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(only_hrs)</span></code></pre></div>
<pre><code>## 10:00:00</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb447-1"><a href="data-manipulation.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(only_mins)</span></code></pre></div>
<pre><code>## 00:55:00</code></pre>
<p>Again, similar to the date class, we can extract hour, minute, and second attributes from time-classed objects:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb449-1"><a href="data-manipulation.html#cb449-1" aria-hidden="true" tabindex="-1"></a>y.hour</span></code></pre></div>
<pre><code>## 11</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb451-1"><a href="data-manipulation.html#cb451-1" aria-hidden="true" tabindex="-1"></a>y.minute</span></code></pre></div>
<pre><code>## 34</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb453-1"><a href="data-manipulation.html#cb453-1" aria-hidden="true" tabindex="-1"></a>y.second</span></code></pre></div>
<pre><code>## 56</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb455-1"><a href="data-manipulation.html#cb455-1" aria-hidden="true" tabindex="-1"></a>y.microsecond</span></code></pre></div>
<pre><code>## 0</code></pre>
<p>The <code>datetime()</code> class that creates a datetime object containing information about both date and time. The attributes must be input as integers wiht the following default order: year, month, day, hour, minute, and second. Like the date and time classes, we can specify specific attributes in the arguments using the names thereof. If we don’t specify any time components, the datetime object defaults to time 00:00:00.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb457-1"><a href="data-manipulation.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input attributes in order</span></span>
<span id="cb457-2"><a href="data-manipulation.html#cb457-2" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> dt.datetime(<span class="dv">1981</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">34</span>, <span class="dv">56</span>)</span>
<span id="cb457-3"><a href="data-manipulation.html#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z)</span></code></pre></div>
<pre><code>## 1981-04-12 11:34:56</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb459-1"><a href="data-manipulation.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input attributes using attribute names (any order)</span></span>
<span id="cb459-2"><a href="data-manipulation.html#cb459-2" aria-hidden="true" tabindex="-1"></a>z2<span class="op">=</span> dt.datetime(year <span class="op">=</span> <span class="dv">2021</span>, day <span class="op">=</span> <span class="dv">6</span>, month <span class="op">=</span> <span class="dv">12</span>, hour <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb459-3"><a href="data-manipulation.html#cb459-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z2)</span></code></pre></div>
<pre><code>## 2021-12-06 06:00:00</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb461-1"><a href="data-manipulation.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No time attributes</span></span>
<span id="cb461-2"><a href="data-manipulation.html#cb461-2" aria-hidden="true" tabindex="-1"></a>z3 <span class="op">=</span> dt.datetime(<span class="dv">1981</span>, <span class="dv">4</span>, <span class="dv">12</span>)</span>
<span id="cb461-3"><a href="data-manipulation.html#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z3)</span></code></pre></div>
<pre><code>## 1981-04-12 00:00:00</code></pre>
<p>Again, we can extract attributes in exactly the same way as we did for the date and time classes.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb463-1"><a href="data-manipulation.html#cb463-1" aria-hidden="true" tabindex="-1"></a>z.year</span></code></pre></div>
<pre><code>## 1981</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb465-1"><a href="data-manipulation.html#cb465-1" aria-hidden="true" tabindex="-1"></a>z.day</span></code></pre></div>
<pre><code>## 12</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb467-1"><a href="data-manipulation.html#cb467-1" aria-hidden="true" tabindex="-1"></a>z.hour</span></code></pre></div>
<pre><code>## 11</code></pre>
<p>The final class discussed here is the timedelta class. This class is used to store date/time differences between date objects.</p>
<p>The default settings for a timedelta object are as follows: <code>timedelta(weeks = 0, days = 0, hours = 0, minutes = 0, seconds = 0, milliseconds = 0, microseconds = 0)</code>.</p>
<p>To add or subtract dates and times to/from these objects, we can use operators like <code>+</code> and <code>-</code>:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb469-1"><a href="data-manipulation.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a datetime object for the current time</span></span>
<span id="cb469-2"><a href="data-manipulation.html#cb469-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> dt.datetime.now()</span>
<span id="cb469-3"><a href="data-manipulation.html#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d1)</span></code></pre></div>
<pre><code>## 2022-05-26 14:20:37.116303</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb471-1"><a href="data-manipulation.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add 550 days to the datetime object </span></span>
<span id="cb471-2"><a href="data-manipulation.html#cb471-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> d1 <span class="op">+</span> dt.timedelta(days <span class="op">=</span> <span class="dv">550</span>)</span>
<span id="cb471-3"><a href="data-manipulation.html#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d2)</span></code></pre></div>
<pre><code>## 2023-11-27 14:20:37.116303</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb473-1"><a href="data-manipulation.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtract five hours from the datetime object </span></span>
<span id="cb473-2"><a href="data-manipulation.html#cb473-2" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> d1 <span class="op">-</span> dt.timedelta(hours <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb473-3"><a href="data-manipulation.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d3)</span></code></pre></div>
<pre><code>## 2022-05-26 09:20:37.116303</code></pre>
<p>Finally, we will discuss how to convert strings to datetime objects and vice versa.</p>
<p>The attribute <code>strftime()</code> converts datetime objects to strings. In the argument of <code>strftime()</code>, you can specify the format you would like.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb475-1"><a href="data-manipulation.html#cb475-1" aria-hidden="true" tabindex="-1"></a>d1</span></code></pre></div>
<pre><code>## datetime.datetime(2022, 5, 26, 14, 20, 37, 116303)</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb477-1"><a href="data-manipulation.html#cb477-1" aria-hidden="true" tabindex="-1"></a>d1.strftime(<span class="st">&quot;%A %m %Y&quot;</span>)</span></code></pre></div>
<pre><code>## &#39;Thursday 05 2022&#39;</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb479-1"><a href="data-manipulation.html#cb479-1" aria-hidden="true" tabindex="-1"></a>d1.strftime(<span class="st">&quot;%a %m %y&quot;</span>)</span></code></pre></div>
<pre><code>## &#39;Thu 05 22&#39;</code></pre>
<p>The attribute <code>strptime()</code> converts strings into datetime objects. In the argument of <code>strptime()</code>, you must specify the string and then the format of the string.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb481-1"><a href="data-manipulation.html#cb481-1" aria-hidden="true" tabindex="-1"></a>d4 <span class="op">=</span> <span class="st">&quot;27/10/98 11:03:9.033&quot;</span></span>
<span id="cb481-2"><a href="data-manipulation.html#cb481-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-3"><a href="data-manipulation.html#cb481-3" aria-hidden="true" tabindex="-1"></a>d1.strptime(d4, <span class="st">&quot;</span><span class="sc">%d</span><span class="st">/%m/%y %H:%M:%S.</span><span class="sc">%f</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## datetime.datetime(1998, 10, 27, 11, 3, 9, 33000)</code></pre>
</div>
<div id="r-28" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-28" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dates in R can be stored as a Date class or a Date-Time class. Dates are stored as the number of days since January 1, 1970. Date-Times are stored as the number of seconds since January 1, 1970. With dates stored in this manner, we can calculate elapsed time in units such as days, weeks, hours, minutes, and so forth.</p>
<p>Below are the dates of the first five NASA <a href="https://en.wikipedia.org/wiki/List_of_Space_Shuttle_missions#Shuttle_flights">Columbia Space Shuttle flights</a> entered as a character vector.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="data-manipulation.html#cb483-1" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;12 April 1981&quot;</span>, </span>
<span id="cb483-2"><a href="data-manipulation.html#cb483-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;12 November 1981&quot;</span>, </span>
<span id="cb483-3"><a href="data-manipulation.html#cb483-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;22 March 1982&quot;</span>, </span>
<span id="cb483-4"><a href="data-manipulation.html#cb483-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;27 June 1982&quot;</span>, </span>
<span id="cb483-5"><a href="data-manipulation.html#cb483-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;11 November 1982&quot;</span>)</span></code></pre></div>
<p>R does not immediately recognize these as a Date class. To format as a Date class, we can use either the base R <code>as.Date()</code> function or one of the convenience functions in the <strong>lubridate</strong> package. The <code>as.Date()</code> function requires a specified POSIX conversion specification as documented in <code>?strptime</code>. Below, the conversion code <code>%d %B %Y</code> indicates that the date is entered as a two-digit day of month (<code>%d</code>), a full month name (<code>%B</code>), and a year with century (<code>%Y</code>).</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="data-manipulation.html#cb484-1" aria-hidden="true" tabindex="-1"></a>date1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(date, <span class="at">format =</span> <span class="st">&quot;%d %B %Y&quot;</span>)</span>
<span id="cb484-2"><a href="data-manipulation.html#cb484-2" aria-hidden="true" tabindex="-1"></a>date1</span></code></pre></div>
<pre><code>## [1] &quot;1981-04-12&quot; &quot;1981-11-12&quot; &quot;1982-03-22&quot; &quot;1982-06-27&quot; &quot;1982-11-11&quot;</code></pre>
<p>The dates now print in year-month-day format; however, they are stored internally as number of days since January 1, 1970. This can be seen by using <code>as.numeric()</code> on the <code>date1</code> vector.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="data-manipulation.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(date1)</span></code></pre></div>
<pre><code>## [1] 4119 4333 4463 4560 4697</code></pre>
<p>The <strong>lubridate</strong> package provides a series of functions that are permutations of the letters “m”, “d”, and “y” to represent the order of date components. To format the original “date” vector, we use the <code>dmy()</code> function since the date components are ordered as day, month and year. We must load the <strong>lubridate</strong> package to use this function.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="data-manipulation.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb488-2"><a href="data-manipulation.html#cb488-2" aria-hidden="true" tabindex="-1"></a>date2 <span class="ot">&lt;-</span> <span class="fu">dmy</span>(date)</span>
<span id="cb488-3"><a href="data-manipulation.html#cb488-3" aria-hidden="true" tabindex="-1"></a>date2</span></code></pre></div>
<pre><code>## [1] &quot;1981-04-12&quot; &quot;1981-11-12&quot; &quot;1982-03-22&quot; &quot;1982-06-27&quot; &quot;1982-11-11&quot;</code></pre>
<p>When dates are formatted, we can easily extract information such as the day of week or the month. For example, to extract the day of week of the launches as an ordered factor, we can use the <strong>lubridate</strong> function <code>wday()</code> with <code>label = TRUE</code> and <code>abbr = FALSE</code>.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="data-manipulation.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(date2, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] Sunday   Thursday Monday   Sunday   Thursday
## Levels: Sunday &lt; Monday &lt; Tuesday &lt; Wednesday &lt; Thursday &lt; Friday &lt; Saturday</code></pre>
<p>To calculate elapsed time between launches in days, we can use the base R <code>diff()</code> function.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="data-manipulation.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(date2)</span></code></pre></div>
<pre><code>## Time differences in days
## [1] 214 130  97 137</code></pre>
<p>To store a date as a Date-Time class, we need to include a time component. Below are the first five Columbia launch dates with times. (UTC refers to <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time">Universal Coordinated Time</a>.)</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="data-manipulation.html#cb494-1" aria-hidden="true" tabindex="-1"></a>datetime <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;12 April 1981 12:00:04 UTC&quot;</span>,</span>
<span id="cb494-2"><a href="data-manipulation.html#cb494-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;12 November 1981 15:10:00 UTC&quot;</span>,</span>
<span id="cb494-3"><a href="data-manipulation.html#cb494-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;22 March 1982 16:00:00 UTC&quot;</span>,</span>
<span id="cb494-4"><a href="data-manipulation.html#cb494-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;27 June 1982 15:00:00 UTC&quot;</span>,</span>
<span id="cb494-5"><a href="data-manipulation.html#cb494-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;11 November 1982 12:19:00 UTC&quot;</span>)</span></code></pre></div>
<p>To format as a Date-Time class, we can use either the base R <code>as.POSIXct()</code> function or one of the convenience functions in the <strong>lubridate</strong> package. To use <code>as.POSIXct()</code>, we need to include additional POSIX conversion specifications for the hour, minute, and second of launch. The <code>%H:%M:%S</code> specification refers to hours, minutes, and seconds. The <code>tz</code> argument specifies the time zone of the times.</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="data-manipulation.html#cb495-1" aria-hidden="true" tabindex="-1"></a>datetime1 <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(datetime, </span>
<span id="cb495-2"><a href="data-manipulation.html#cb495-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">format =</span> <span class="st">&quot;%d %B %Y %H:%M:%S&quot;</span>, </span>
<span id="cb495-3"><a href="data-manipulation.html#cb495-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb495-4"><a href="data-manipulation.html#cb495-4" aria-hidden="true" tabindex="-1"></a>datetime1</span></code></pre></div>
<pre><code>## [1] &quot;1981-04-12 12:00:04 UTC&quot; &quot;1981-11-12 15:10:00 UTC&quot; &quot;1982-03-22 16:00:00 UTC&quot; &quot;1982-06-27 15:00:00 UTC&quot; &quot;1982-11-11 12:19:00 UTC&quot;</code></pre>
<p>When we use <code>as.numeric()</code> on the <code>datetime1</code> vector, we see it is stored as number of seconds since January 1, 1970.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="data-manipulation.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(datetime1)</span></code></pre></div>
<pre><code>## [1] 355924804 374425800 385660800 394038000 405865140</code></pre>
<p>Using <strong>lubridate</strong>, we can append <code>_hms()</code> to any of the “mdy” functions to format dates with time components as a Date-Time class. Notice the default time zone in <strong>lubridate</strong> is UTC.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="data-manipulation.html#cb499-1" aria-hidden="true" tabindex="-1"></a>datetime2 <span class="ot">&lt;-</span> <span class="fu">dmy_hms</span>(datetime)</span>
<span id="cb499-2"><a href="data-manipulation.html#cb499-2" aria-hidden="true" tabindex="-1"></a>datetime2</span></code></pre></div>
<pre><code>## [1] &quot;1981-04-12 12:00:04 UTC&quot; &quot;1981-11-12 15:10:00 UTC&quot; &quot;1982-03-22 16:00:00 UTC&quot; &quot;1982-06-27 15:00:00 UTC&quot; &quot;1982-11-11 12:19:00 UTC&quot;</code></pre>
<p>To calculate the elapsed time between launches in hours, we can use the <strong>lubridate</strong> function <code>time_length()</code> with <code>unit = "hours"</code>. Below, we use <code>diff()</code> and then pipe the result to <code>time_length()</code>.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="data-manipulation.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(datetime2) <span class="sc">|&gt;</span> <span class="fu">time_length</span>(<span class="at">unit =</span> <span class="st">&quot;hours&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 5139.166 3120.833 2327.000 3285.317</code></pre>
<p>For more information on working with dates and times in R, see the vignette accompanying the <strong>lubridate</strong> package.</p>
</div>
</div>
<div id="randomly-sample-rows" class="section level2 hasAnchor" number="4.13">
<h2><span class="header-section-number">4.13</span> Randomly sample rows<a href="data-manipulation.html#randomly-sample-rows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How to take a random sample of rows from a data frame. The sample is usually either a fixed size or a proportion.</p>
<div id="python-29" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="data-manipulation.html#python-29" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The pandas package provides a function for taking a sample of fixed size or a proportion, <code>sample()</code>. To sample with replacement, set <code>replace = TRUE</code>.</p>
<p>By default, the random sample will change every time the code is run. To always generate the same “random” sample, set <code>random_state</code> to any positive integer.</p>
<p>To create a sample with a fixed number of rows, use the <code>n</code> argument.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb503-1"><a href="data-manipulation.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample five rows from mtcars</span></span>
<span id="cb503-2"><a href="data-manipulation.html#cb503-2" aria-hidden="true" tabindex="-1"></a>mtcars.sample(n <span class="op">=</span> <span class="dv">5</span>, replace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<pre><code>##      MPG  CYL   DISP   HP  AXLE_RATIO  ...  VS  AM  GEAR CARB       KPL
## 7   24.4    4  146.7   62        3.69  ...   1   0     4    2  5.187075
## 12  17.3    8  275.8  180        3.07  ...   0   0     3    3  3.677721
## 18  30.4    4   75.7   52        4.93  ...   1   1     4    2  6.462585
## 26  26.0    4  120.3   91        4.43  ...   0   1     5    2  5.527211
## 9   19.2    6  167.6  123        3.92  ...   1   0     4    4  4.081633
## 
## [5 rows x 12 columns]</code></pre>
<p>To create a sample of a proportion, use the <code>frac</code> argument.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb505-1"><a href="data-manipulation.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 20% of the rows from mtcars</span></span>
<span id="cb505-2"><a href="data-manipulation.html#cb505-2" aria-hidden="true" tabindex="-1"></a>mtcars.sample(frac <span class="op">=</span> <span class="fl">0.20</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##      MPG  CYL   DISP   HP  AXLE_RATIO  ...  VS  AM  GEAR CARB       KPL
## 27  30.4    4   95.1  113        3.77  ...   1   1     5    2  6.462585
## 3   21.4    6  258.0  110        3.08  ...   1   0     3    1  4.549320
## 22  15.2    8  304.0  150        3.15  ...   0   0     3    2  3.231293
## 18  30.4    4   75.7   52        4.93  ...   1   1     4    2  6.462585
## 23  13.3    8  350.0  245        3.73  ...   0   0     3    4  2.827381
## 17  32.4    4   78.7   66        4.08  ...   1   1     4    1  6.887755
## 
## [6 rows x 12 columns]</code></pre>
<p>The NumPy function <code>random.choice()</code> in combination with the <code>loc()</code> function can be used to sample from a DataFrame.</p>
<p>The <code>random.choice()</code> function creates a random sample according to the given parameters. The <code>loc()</code> function is used to access rows and columns by index.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb507-1"><a href="data-manipulation.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb507-2"><a href="data-manipulation.html#cb507-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-3"><a href="data-manipulation.html#cb507-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a random sample of size five with replacement</span></span>
<span id="cb507-4"><a href="data-manipulation.html#cb507-4" aria-hidden="true" tabindex="-1"></a>random_sample <span class="op">=</span> np.random.choice(<span class="bu">len</span>(mtcars), (<span class="dv">5</span>, ), replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb507-5"><a href="data-manipulation.html#cb507-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-6"><a href="data-manipulation.html#cb507-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use random_sample to sample from mtcars</span></span>
<span id="cb507-7"><a href="data-manipulation.html#cb507-7" aria-hidden="true" tabindex="-1"></a>mtcars.loc[random_sample, ]</span></code></pre></div>
<pre><code>##      MPG  CYL   DISP   HP  AXLE_RATIO  ...  VS  AM  GEAR CARB       KPL
## 10  17.8    6  167.6  123        3.92  ...   1   0     4    4  3.784014
## 24  19.2    8  400.0  175        3.08  ...   0   0     3    2  4.081633
## 25  27.3    4   79.0   66        4.08  ...   1   1     4    1  5.803571
## 13  15.2    8  275.8  180        3.07  ...   0   0     3    3  3.231293
## 3   21.4    6  258.0  110        3.08  ...   1   0     3    1  4.549320
## 
## [5 rows x 12 columns]</code></pre>
<p>As before, setting <code>random.seed()</code> to a positive integer will ensure that the same “random” sample is generated each time the code is run.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb509-1"><a href="data-manipulation.html#cb509-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb509-2"><a href="data-manipulation.html#cb509-2" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> np.random.choice(<span class="bu">len</span>(mtcars), (<span class="dv">5</span>,), replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb509-3"><a href="data-manipulation.html#cb509-3" aria-hidden="true" tabindex="-1"></a>mtcars.loc[sample, ]</span></code></pre></div>
<pre><code>##      MPG  CYL   DISP   HP  AXLE_RATIO    WT   QSEC  VS AM  GEAR  CARB       KPL
## 30  15.0    8  301.0  335        3.54  3.57  14.60   0  1     5     8  3.188776
## 13  15.2    8  275.8  180        3.07  3.78  18.00   0  0     3     3  3.231293
## 30  15.0    8  301.0  335        3.54  3.57  14.60   0  1     5     8  3.188776
## 2   22.8    4  108.0   93        3.85  2.32  18.61   1  1     4     1  4.846939
## 28  15.8    8  351.0  264        4.22  3.17  14.50   0  1     5     4  3.358844</code></pre>
</div>
<div id="r-29" class="section level4 unnumbered hasAnchor">
<h4>R<a href="data-manipulation.html#r-29" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are many ways to sample rows from a data frame in R. The <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> package provides a convenience function, <code>slice_sample()</code>, for taking either a fixed sample size or a proportion.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="data-manipulation.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample five rows from mtcars</span></span>
<span id="cb511-2"><a href="data-manipulation.html#cb511-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(mtcars, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##    mpg cylinders  disp  hp axle_ratio weight  qsec engine am gear carb am_ch    am_fac
## 1 26.0         4 120.3  91       4.43  2.140 16.70      0  1    5    2     1    manual
## 2 18.1         6 225.0 105       2.76  3.460 20.22      1  0    3    1     0 automatic
## 3 30.4         4  75.7  52       4.93  1.615 18.52      1  1    4    2     1    manual
## 4 15.2         8 275.8 180       3.07  3.780 18.00      0  0    3    3     0 automatic
## 5 16.4         8 275.8 180       3.07  4.070 17.40      0  0    3    3     0 automatic</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="data-manipulation.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 20% of rows from mtcars</span></span>
<span id="cb513-2"><a href="data-manipulation.html#cb513-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(mtcars, <span class="at">prop =</span> <span class="fl">0.20</span>)</span></code></pre></div>
<pre><code>##    mpg cylinders  disp  hp axle_ratio weight  qsec engine am gear carb am_ch    am_fac
## 1 19.2         8 400.0 175       3.08  3.845 17.05      0  0    3    2     0 automatic
## 2 10.4         8 472.0 205       2.93  5.250 17.98      0  0    3    4     0 automatic
## 3 22.8         4 140.8  95       3.92  3.150 22.90      1  0    4    2     0 automatic
## 4 21.4         4 121.0 109       4.11  2.780 18.60      1  1    4    2     1    manual
## 5 19.2         6 167.6 123       3.92  3.440 18.30      1  0    4    4     0 automatic
## 6 10.4         8 460.0 215       3.00  5.424 17.82      0  0    3    4     0 automatic</code></pre>
<p>To sample with replacement, set <code>replace = TRUE</code>.</p>
<p>The base R functions <code>sample()</code> and <code>runif()</code> can be combined to sample fixed sizes or approximate proportions.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="data-manipulation.html#cb515-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample five rows from mtcars</span></span>
<span id="cb515-2"><a href="data-manipulation.html#cb515-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First, get five random row numbers</span></span>
<span id="cb515-3"><a href="data-manipulation.html#cb515-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(mtcars), <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb515-4"><a href="data-manipulation.html#cb515-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, use i to subset those rows</span></span>
<span id="cb515-5"><a href="data-manipulation.html#cb515-5" aria-hidden="true" tabindex="-1"></a>mtcars[i, ]</span></code></pre></div>
<pre><code>##     mpg cylinders  disp  hp axle_ratio weight  qsec engine am gear carb am_ch    am_fac
## 13 17.3         8 275.8 180       3.07  3.730 17.60      0  0    3    3     0 automatic
## 19 30.4         4  75.7  52       4.93  1.615 18.52      1  1    4    2     1    manual
## 20 33.9         4  71.1  65       4.22  1.835 19.90      1  1    4    1     1    manual
## 26 27.3         4  79.0  66       4.08  1.935 18.90      1  1    4    1     1    manual
## 30 19.7         6 145.0 175       3.62  2.770 15.50      0  1    5    6     1    manual</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="data-manipulation.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample about 20% of rows from mtcars</span></span>
<span id="cb517-2"><a href="data-manipulation.html#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="co"># First, generate random values on range of [0,1]</span></span>
<span id="cb517-3"><a href="data-manipulation.html#cb517-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(mtcars))</span>
<span id="cb517-4"><a href="data-manipulation.html#cb517-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, use i &lt; 0.20 logical vector to select rows that correspond to TRUE</span></span>
<span id="cb517-5"><a href="data-manipulation.html#cb517-5" aria-hidden="true" tabindex="-1"></a>mtcars[i <span class="sc">&lt;</span> <span class="fl">0.20</span>, ]</span></code></pre></div>
<pre><code>##     mpg cylinders  disp  hp axle_ratio weight  qsec engine am gear carb am_ch    am_fac
## 1  21.0         6 160.0 110       3.90  2.620 16.46      0  1    4    4     1    manual
## 12 16.4         8 275.8 180       3.07  4.070 17.40      0  0    3    3     0 automatic
## 13 17.3         8 275.8 180       3.07  3.730 17.60      0  0    3    3     0 automatic
## 21 21.5         4 120.1  97       3.70  2.465 20.01      1  0    3    1     0 automatic</code></pre>
<p>The random sample will change every time the code is run. To always generate the same “random” sample, use the <code>set.seed()</code> function with any positive integer.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="data-manipulation.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb519-2"><a href="data-manipulation.html#cb519-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(mtcars))</span>
<span id="cb519-3"><a href="data-manipulation.html#cb519-3" aria-hidden="true" tabindex="-1"></a>mtcars[i <span class="sc">&lt;</span> <span class="fl">0.20</span>,]</span></code></pre></div>
<pre><code>##     mpg cylinders  disp  hp axle_ratio weight  qsec engine am gear carb am_ch    am_fac
## 6  18.1         6 225.0 105       2.76   3.46 20.22      1  0    3    1     0 automatic
## 15 10.4         8 472.0 205       2.93   5.25 17.98      0  0    3    4     0 automatic
## 18 32.4         4  78.7  66       4.08   2.20 19.47      1  1    4    1     1    manual
## 30 19.7         6 145.0 175       3.62   2.77 15.50      0  1    5    6     1    manual</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="import-export-and-save-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="combine-reshape-and-merge.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uvastatlab/Python_and_R/edit/main/04-data-manipulation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
