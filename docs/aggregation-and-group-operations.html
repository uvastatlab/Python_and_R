<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Aggregation and Group Operations | Python and R</title>
  <meta name="description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Aggregation and Group Operations | Python and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="github-repo" content="uvastatlab/Python_and_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Aggregation and Group Operations | Python and R" />
  
  <meta name="twitter:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  

<meta name="author" content="Clay Ford, Jacob Goldstein-Greenwood, Oyinkansola Adenekan, Samantha Lomuscio" />


<meta name="date" content="2022-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="combine-reshape-and-merge.html"/>
<link rel="next" href="basic-plotting-and-visualization.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Python and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>1</b> Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics.html"><a href="basics.html#math"><i class="fa fa-check"></i><b>1.1</b> Math</a></li>
<li class="chapter" data-level="1.2" data-path="basics.html"><a href="basics.html#missing-values"><i class="fa fa-check"></i><b>1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.3" data-path="basics.html"><a href="basics.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Assignment</a></li>
<li class="chapter" data-level="1.4" data-path="basics.html"><a href="basics.html#printing-a-value"><i class="fa fa-check"></i><b>1.4</b> Printing a value</a></li>
<li class="chapter" data-level="1.5" data-path="basics.html"><a href="basics.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a></li>
<li class="chapter" data-level="1.6" data-path="basics.html"><a href="basics.html#logic"><i class="fa fa-check"></i><b>1.6</b> Logic</a></li>
<li class="chapter" data-level="1.7" data-path="basics.html"><a href="basics.html#generating-a-sequence-of-values"><i class="fa fa-check"></i><b>1.7</b> Generating a sequence of values</a></li>
<li class="chapter" data-level="1.8" data-path="basics.html"><a href="basics.html#calculating-means-and-medians"><i class="fa fa-check"></i><b>1.8</b> Calculating means and medians</a></li>
<li class="chapter" data-level="1.9" data-path="basics.html"><a href="basics.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.9</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#one-dimensional-data"><i class="fa fa-check"></i><b>2.1</b> One-dimensional data</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-data"><i class="fa fa-check"></i><b>2.2</b> Two-dimensional data</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#three-dimensional-and-higher-data"><i class="fa fa-check"></i><b>2.3</b> Three-dimensional and higher data</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#general-data-structures"><i class="fa fa-check"></i><b>2.4</b> General data structures</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html"><i class="fa fa-check"></i><b>3</b> Import, Export, and Save Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#csv"><i class="fa fa-check"></i><b>3.1</b> CSV</a></li>
<li class="chapter" data-level="3.2" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xlsxlsx-excel"><i class="fa fa-check"></i><b>3.2</b> XLS/XLSX (Excel)</a></li>
<li class="chapter" data-level="3.3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#json"><i class="fa fa-check"></i><b>3.3</b> JSON</a></li>
<li class="chapter" data-level="3.4" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xml"><i class="fa fa-check"></i><b>3.4</b> XML</a></li>
<li class="chapter" data-level="3.5" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#exportingwritingsaving-data-and-variables"><i class="fa fa-check"></i><b>3.5</b> Exporting/Writing/Saving data and variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#names-of-variables-and-their-types"><i class="fa fa-check"></i><b>4.1</b> Names of variables and their types</a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#select-variables"><i class="fa fa-check"></i><b>4.2</b> Select variables</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#filtersubset-variables"><i class="fa fa-check"></i><b>4.3</b> Filter/Subset variables</a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#rename-variables"><i class="fa fa-check"></i><b>4.4</b> Rename variables</a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation.html"><a href="data-manipulation.html#create-replace-and-remove-variables"><i class="fa fa-check"></i><b>4.5</b> Create, replace and remove variables</a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation.html"><a href="data-manipulation.html#create-strings-from-numbers"><i class="fa fa-check"></i><b>4.6</b> Create strings from numbers</a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation.html"><a href="data-manipulation.html#create-numbers-from-strings"><i class="fa fa-check"></i><b>4.7</b> Create numbers from strings</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation.html"><a href="data-manipulation.html#combine-strings"><i class="fa fa-check"></i><b>4.8</b> Combine strings</a></li>
<li class="chapter" data-level="4.9" data-path="data-manipulation.html"><a href="data-manipulation.html#finding-and-replacing-patterns-within-strings"><i class="fa fa-check"></i><b>4.9</b> Finding and replacing patterns within strings</a></li>
<li class="chapter" data-level="4.10" data-path="data-manipulation.html"><a href="data-manipulation.html#change-case"><i class="fa fa-check"></i><b>4.10</b> Change case</a></li>
<li class="chapter" data-level="4.11" data-path="data-manipulation.html"><a href="data-manipulation.html#drop-duplicate-rows"><i class="fa fa-check"></i><b>4.11</b> Drop duplicate rows</a></li>
<li class="chapter" data-level="4.12" data-path="data-manipulation.html"><a href="data-manipulation.html#format-dates"><i class="fa fa-check"></i><b>4.12</b> Format dates</a></li>
<li class="chapter" data-level="4.13" data-path="data-manipulation.html"><a href="data-manipulation.html#randomly-sample-rows"><i class="fa fa-check"></i><b>4.13</b> Randomly sample rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html"><i class="fa fa-check"></i><b>5</b> Combine, Reshape and Merge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-rows"><i class="fa fa-check"></i><b>5.1</b> Combine rows</a></li>
<li class="chapter" data-level="5.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-columns"><i class="fa fa-check"></i><b>5.2</b> Combine columns</a></li>
<li class="chapter" data-level="5.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#reshaping-data"><i class="fa fa-check"></i><b>5.3</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#wide-to-long"><i class="fa fa-check"></i><b>5.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="5.3.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#long-to-wide"><i class="fa fa-check"></i><b>5.3.2</b> Long to wide</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#mergejoin"><i class="fa fa-check"></i><b>5.4</b> Merge/Join</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#left-join"><i class="fa fa-check"></i><b>5.4.1</b> Left Join</a></li>
<li class="chapter" data-level="5.4.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#right-join"><i class="fa fa-check"></i><b>5.4.2</b> Right Join</a></li>
<li class="chapter" data-level="5.4.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#inner-join"><i class="fa fa-check"></i><b>5.4.3</b> Inner Join</a></li>
<li class="chapter" data-level="5.4.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#outer-join"><i class="fa fa-check"></i><b>5.4.4</b> Outer Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html"><i class="fa fa-check"></i><b>6</b> Aggregation and Group Operations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#cross-tabulation"><i class="fa fa-check"></i><b>6.1</b> Cross tabulation</a></li>
<li class="chapter" data-level="6.2" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#group-summaries"><i class="fa fa-check"></i><b>6.2</b> Group summaries</a></li>
<li class="chapter" data-level="6.3" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.3</b> Centering and Scaling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html"><i class="fa fa-check"></i><b>7</b> Basic Plotting and Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#barplots"><i class="fa fa-check"></i><b>7.2</b> Barplots</a></li>
<li class="chapter" data-level="7.3" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#scatterplot"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.4" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#stripcharts"><i class="fa fa-check"></i><b>7.4</b> Stripcharts</a></li>
<li class="chapter" data-level="7.5" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#boxplots"><i class="fa fa-check"></i><b>7.5</b> Boxplots</a></li>
<li class="chapter" data-level="7.6" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#facet-plots"><i class="fa fa-check"></i><b>7.6</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html"><i class="fa fa-check"></i><b>8</b> Selected Topics in Statistical Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-means"><i class="fa fa-check"></i><b>8.1</b> Comparing group means</a></li>
<li class="chapter" data-level="8.2" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-proportions"><i class="fa fa-check"></i><b>8.2</b> Comparing group proportions</a></li>
<li class="chapter" data-level="8.3" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#linear-modeling"><i class="fa fa-check"></i><b>8.3</b> Linear modeling</a></li>
<li class="chapter" data-level="8.4" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aggregation-and-group-operations" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Aggregation and Group Operations</h1>
<p>This chapter looks at manipulating and summarizing data by groups.</p>
<div id="cross-tabulation" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Cross tabulation</h2>
<p>Cross tabulation is the process of determining frequencies per group (or determining values based on frequencies, like proportions), with groups delineated by one or more variables (e.g., nationality and sex).</p>
<p>The Python and R examples of cross tabulation below both make use of the following dataset, <code>dat</code>:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="aggregation-and-group-operations.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> dat</span>
<span id="cb236-2"><a href="aggregation-and-group-operations.html#cb236-2" aria-hidden="true" tabindex="-1"></a>  nationality sex</span>
<span id="cb236-3"><a href="aggregation-and-group-operations.html#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    Canadian   m</span>
<span id="cb236-4"><a href="aggregation-and-group-operations.html#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      French   f</span>
<span id="cb236-5"><a href="aggregation-and-group-operations.html#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      French   f</span>
<span id="cb236-6"><a href="aggregation-and-group-operations.html#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    Egyptian   m</span>
<span id="cb236-7"><a href="aggregation-and-group-operations.html#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    Canadian   f</span></code></pre></div>
<div id="python-38" class="section level4 unnumbered">
<h4>Python</h4>
<p>The <strong>pandas</strong> package contains a <code>crosstab()</code> function for cross tabulation with two or more variables. Alternatively, the <code>groupby()</code> function, also in <strong>pandas</strong>, facilitates cross tabulation by one or more variables when used in combination with <code>count()</code>.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb237-1"><a href="aggregation-and-group-operations.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb237-2"><a href="aggregation-and-group-operations.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> pd.crosstab(dat.nationality, dat.sex)</span>
<span id="cb237-3"><a href="aggregation-and-group-operations.html#cb237-3" aria-hidden="true" tabindex="-1"></a>sex          f  m</span>
<span id="cb237-4"><a href="aggregation-and-group-operations.html#cb237-4" aria-hidden="true" tabindex="-1"></a>nationality      </span>
<span id="cb237-5"><a href="aggregation-and-group-operations.html#cb237-5" aria-hidden="true" tabindex="-1"></a>Canadian     <span class="dv">1</span>  <span class="dv">1</span></span>
<span id="cb237-6"><a href="aggregation-and-group-operations.html#cb237-6" aria-hidden="true" tabindex="-1"></a>Egyptian     <span class="dv">0</span>  <span class="dv">1</span></span>
<span id="cb237-7"><a href="aggregation-and-group-operations.html#cb237-7" aria-hidden="true" tabindex="-1"></a>French       <span class="dv">2</span>  <span class="dv">0</span></span>
<span id="cb237-8"><a href="aggregation-and-group-operations.html#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dat.groupby(by <span class="op">=</span> <span class="st">&#39;nationality&#39;</span>).nationality.count()</span>
<span id="cb237-9"><a href="aggregation-and-group-operations.html#cb237-9" aria-hidden="true" tabindex="-1"></a>nationality</span>
<span id="cb237-10"><a href="aggregation-and-group-operations.html#cb237-10" aria-hidden="true" tabindex="-1"></a>Canadian    <span class="dv">2</span></span>
<span id="cb237-11"><a href="aggregation-and-group-operations.html#cb237-11" aria-hidden="true" tabindex="-1"></a>Egyptian    <span class="dv">1</span></span>
<span id="cb237-12"><a href="aggregation-and-group-operations.html#cb237-12" aria-hidden="true" tabindex="-1"></a>French      <span class="dv">2</span></span>
<span id="cb237-13"><a href="aggregation-and-group-operations.html#cb237-13" aria-hidden="true" tabindex="-1"></a>Name: nationality, dtype: int64</span>
<span id="cb237-14"><a href="aggregation-and-group-operations.html#cb237-14" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> dat.groupby(by <span class="op">=</span> [<span class="st">&#39;nationality&#39;</span>, <span class="st">&#39;sex&#39;</span>]).nationality.count()</span>
<span id="cb237-15"><a href="aggregation-and-group-operations.html#cb237-15" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="co"># Or: dat.groupby(by = [&#39;nationality&#39;, &#39;sex&#39;]).sex.count()</span></span>
<span id="cb237-16"><a href="aggregation-and-group-operations.html#cb237-16" aria-hidden="true" tabindex="-1"></a>nationality  sex</span>
<span id="cb237-17"><a href="aggregation-and-group-operations.html#cb237-17" aria-hidden="true" tabindex="-1"></a>Canadian     f      <span class="dv">1</span></span>
<span id="cb237-18"><a href="aggregation-and-group-operations.html#cb237-18" aria-hidden="true" tabindex="-1"></a>             m      <span class="dv">1</span></span>
<span id="cb237-19"><a href="aggregation-and-group-operations.html#cb237-19" aria-hidden="true" tabindex="-1"></a>Egyptian     m      <span class="dv">1</span></span>
<span id="cb237-20"><a href="aggregation-and-group-operations.html#cb237-20" aria-hidden="true" tabindex="-1"></a>French       f      <span class="dv">2</span></span>
<span id="cb237-21"><a href="aggregation-and-group-operations.html#cb237-21" aria-hidden="true" tabindex="-1"></a>Name: nationality, dtype: int64</span></code></pre></div>
</div>
<div id="r-38" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>table()</code> function performs cross tabulation in R. A user can enter a single grouping variable or enter multiple grouping variables separated by a comma(s). The <code>xtabs()</code> function also computes cross-tabs; a user enters the variables to be used for grouping in formula notation.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="aggregation-and-group-operations.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">table</span>(dat<span class="sc">$</span>nationality)</span>
<span id="cb238-2"><a href="aggregation-and-group-operations.html#cb238-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-3"><a href="aggregation-and-group-operations.html#cb238-3" aria-hidden="true" tabindex="-1"></a>Canadian Egyptian   French </span>
<span id="cb238-4"><a href="aggregation-and-group-operations.html#cb238-4" aria-hidden="true" tabindex="-1"></a>       <span class="dv">2</span>        <span class="dv">1</span>        <span class="dv">2</span> </span>
<span id="cb238-5"><a href="aggregation-and-group-operations.html#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">table</span>(dat<span class="sc">$</span>nationality, dat<span class="sc">$</span>sex)</span>
<span id="cb238-6"><a href="aggregation-and-group-operations.html#cb238-6" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb238-7"><a href="aggregation-and-group-operations.html#cb238-7" aria-hidden="true" tabindex="-1"></a>           f m</span>
<span id="cb238-8"><a href="aggregation-and-group-operations.html#cb238-8" aria-hidden="true" tabindex="-1"></a>  Canadian <span class="dv">1</span> <span class="dv">1</span></span>
<span id="cb238-9"><a href="aggregation-and-group-operations.html#cb238-9" aria-hidden="true" tabindex="-1"></a>  Egyptian <span class="dv">0</span> <span class="dv">1</span></span>
<span id="cb238-10"><a href="aggregation-and-group-operations.html#cb238-10" aria-hidden="true" tabindex="-1"></a>  French   <span class="dv">2</span> <span class="dv">0</span></span>
<span id="cb238-11"><a href="aggregation-and-group-operations.html#cb238-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">xtabs</span>(<span class="at">formula =</span> <span class="sc">~</span>nationality <span class="sc">+</span> sex, <span class="at">data =</span> dat)</span>
<span id="cb238-12"><a href="aggregation-and-group-operations.html#cb238-12" aria-hidden="true" tabindex="-1"></a>           sex</span>
<span id="cb238-13"><a href="aggregation-and-group-operations.html#cb238-13" aria-hidden="true" tabindex="-1"></a>nationality f m</span>
<span id="cb238-14"><a href="aggregation-and-group-operations.html#cb238-14" aria-hidden="true" tabindex="-1"></a>   Canadian <span class="dv">1</span> <span class="dv">1</span></span>
<span id="cb238-15"><a href="aggregation-and-group-operations.html#cb238-15" aria-hidden="true" tabindex="-1"></a>   Egyptian <span class="dv">0</span> <span class="dv">1</span></span>
<span id="cb238-16"><a href="aggregation-and-group-operations.html#cb238-16" aria-hidden="true" tabindex="-1"></a>   French   <span class="dv">2</span> <span class="dv">0</span></span></code></pre></div>
</div>
</div>
<div id="group-summaries" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Group summaries</h2>
<p>Computing statistical summaries per group.</p>
<div id="python-39" class="section level4 unnumbered">
<h4>Python</h4>
<p>The <code>groupby()</code> function from <strong>Pandas</strong> splits up a data set based on one or more grouping variables. Summarizing functions—like <code>mean()</code>, <code>sum()</code>, and so on—can then be applied to those groups. In the first example below, we use <code>groupby()</code> to group rows of the <code>mtcars</code> dataset by the number of cylinders each car has; from there, we select just the <code>mpg</code> column and call <code>mean()</code>, thus producing the average miles per gallon within each cylinder group. In the second example, we again group observations by <code>cyl</code>, but instead of then selecting just the <code>mpg</code> column, we directly call <code>mean()</code>; this gives the mean for each variable in the data set within each cylinder group. Finally, in the third example, we group by two variables—<code>cyl</code> and <code>vs</code>—and then use the <code>describe()</code> function to generate a set of descriptive statistics for <code>mpg</code> within each <code>cylinder</code>*<code>vs</code> group (e.g., mean, SD, minimum, etc.).</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="aggregation-and-group-operations.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb239-2"><a href="aggregation-and-group-operations.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb239-3"><a href="aggregation-and-group-operations.html#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> mean_mpg_by_cyl <span class="op">=</span> mtcars.groupby(by <span class="op">=</span> <span class="st">&#39;cyl&#39;</span>)[<span class="st">&#39;mpg&#39;</span>].mean()</span>
<span id="cb239-4"><a href="aggregation-and-group-operations.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="bu">print</span>(mean_mpg_by_cyl)</span>
<span id="cb239-5"><a href="aggregation-and-group-operations.html#cb239-5" aria-hidden="true" tabindex="-1"></a>cyl</span>
<span id="cb239-6"><a href="aggregation-and-group-operations.html#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="fl">4.0</span>    <span class="fl">26.663636</span></span>
<span id="cb239-7"><a href="aggregation-and-group-operations.html#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="fl">6.0</span>    <span class="fl">19.742857</span></span>
<span id="cb239-8"><a href="aggregation-and-group-operations.html#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="fl">8.0</span>    <span class="fl">15.100000</span></span>
<span id="cb239-9"><a href="aggregation-and-group-operations.html#cb239-9" aria-hidden="true" tabindex="-1"></a>Name: mpg, dtype: float64</span>
<span id="cb239-10"><a href="aggregation-and-group-operations.html#cb239-10" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> means_all_vars <span class="op">=</span> mtcars.groupby(by <span class="op">=</span> <span class="st">&#39;cyl&#39;</span>).mean()</span>
<span id="cb239-11"><a href="aggregation-and-group-operations.html#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="bu">print</span>(means_all_vars)</span>
<span id="cb239-12"><a href="aggregation-and-group-operations.html#cb239-12" aria-hidden="true" tabindex="-1"></a>           mpg        disp          hp  ...        am      gear      carb</span>
<span id="cb239-13"><a href="aggregation-and-group-operations.html#cb239-13" aria-hidden="true" tabindex="-1"></a>cyl                                     ...                              </span>
<span id="cb239-14"><a href="aggregation-and-group-operations.html#cb239-14" aria-hidden="true" tabindex="-1"></a><span class="fl">4.0</span>  <span class="fl">26.663636</span>  <span class="fl">105.136364</span>   <span class="fl">82.636364</span>  ...  <span class="fl">0.727273</span>  <span class="fl">4.090909</span>  <span class="fl">1.545455</span></span>
<span id="cb239-15"><a href="aggregation-and-group-operations.html#cb239-15" aria-hidden="true" tabindex="-1"></a><span class="fl">6.0</span>  <span class="fl">19.742857</span>  <span class="fl">183.314286</span>  <span class="fl">122.285714</span>  ...  <span class="fl">0.428571</span>  <span class="fl">3.857143</span>  <span class="fl">3.428571</span></span>
<span id="cb239-16"><a href="aggregation-and-group-operations.html#cb239-16" aria-hidden="true" tabindex="-1"></a><span class="fl">8.0</span>  <span class="fl">15.100000</span>  <span class="fl">353.100000</span>  <span class="fl">209.214286</span>  ...  <span class="fl">0.142857</span>  <span class="fl">3.285714</span>  <span class="fl">3.500000</span></span>
<span id="cb239-17"><a href="aggregation-and-group-operations.html#cb239-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-18"><a href="aggregation-and-group-operations.html#cb239-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span> rows x <span class="dv">10</span> columns]</span>
<span id="cb239-19"><a href="aggregation-and-group-operations.html#cb239-19" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> mpg_by_cyl_vs <span class="op">=</span> mtcars.groupby(by <span class="op">=</span> [<span class="st">&#39;cyl&#39;</span>, <span class="st">&#39;vs&#39;</span>])[<span class="st">&#39;mpg&#39;</span>].describe()</span>
<span id="cb239-20"><a href="aggregation-and-group-operations.html#cb239-20" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> <span class="bu">print</span>(mpg_by_cyl_vs)</span>
<span id="cb239-21"><a href="aggregation-and-group-operations.html#cb239-21" aria-hidden="true" tabindex="-1"></a>         count       mean       std   <span class="bu">min</span>     <span class="dv">25</span><span class="op">%</span>    <span class="dv">50</span><span class="op">%</span>    <span class="dv">75</span><span class="op">%</span>   <span class="bu">max</span></span>
<span id="cb239-22"><a href="aggregation-and-group-operations.html#cb239-22" aria-hidden="true" tabindex="-1"></a>cyl vs                                                               </span>
<span id="cb239-23"><a href="aggregation-and-group-operations.html#cb239-23" aria-hidden="true" tabindex="-1"></a><span class="fl">4.0</span> <span class="fl">0.0</span>    <span class="fl">1.0</span>  <span class="fl">26.000000</span>       NaN  <span class="fl">26.0</span>  <span class="fl">26.000</span>  <span class="fl">26.00</span>  <span class="fl">26.00</span>  <span class="fl">26.0</span></span>
<span id="cb239-24"><a href="aggregation-and-group-operations.html#cb239-24" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.0</span>   <span class="fl">10.0</span>  <span class="fl">26.730000</span>  <span class="fl">4.748111</span>  <span class="fl">21.4</span>  <span class="fl">22.800</span>  <span class="fl">25.85</span>  <span class="fl">30.40</span>  <span class="fl">33.9</span></span>
<span id="cb239-25"><a href="aggregation-and-group-operations.html#cb239-25" aria-hidden="true" tabindex="-1"></a><span class="fl">6.0</span> <span class="fl">0.0</span>    <span class="fl">3.0</span>  <span class="fl">20.566667</span>  <span class="fl">0.750555</span>  <span class="fl">19.7</span>  <span class="fl">20.350</span>  <span class="fl">21.00</span>  <span class="fl">21.00</span>  <span class="fl">21.0</span></span>
<span id="cb239-26"><a href="aggregation-and-group-operations.html#cb239-26" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.0</span>    <span class="fl">4.0</span>  <span class="fl">19.125000</span>  <span class="fl">1.631717</span>  <span class="fl">17.8</span>  <span class="fl">18.025</span>  <span class="fl">18.65</span>  <span class="fl">19.75</span>  <span class="fl">21.4</span></span>
<span id="cb239-27"><a href="aggregation-and-group-operations.html#cb239-27" aria-hidden="true" tabindex="-1"></a><span class="fl">8.0</span> <span class="fl">0.0</span>   <span class="fl">14.0</span>  <span class="fl">15.100000</span>  <span class="fl">2.560048</span>  <span class="fl">10.4</span>  <span class="fl">14.400</span>  <span class="fl">15.20</span>  <span class="fl">16.25</span>  <span class="fl">19.2</span></span></code></pre></div>
</div>
<div id="r-39" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>aggregate()</code> function can be used to generate by-group statistical summaries based on one or more grouping variables. Grouping variables can be declared as a list in the function’s <code>by</code> argument. Alternatively, the grouping variable(s) and the variable to be summarized can be passed to <code>aggregate()</code> in formula notation: <code>var_to_be_aggregated ~ grouping_var_1 + ... + grouping_var_N</code>. The summarizing function (e.g., <code>mean()</code>; <code>median()</code>; etc.) is declared in the <code>FUN</code> argument.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="aggregation-and-group-operations.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># One grouping variable</span></span>
<span id="cb240-2"><a href="aggregation-and-group-operations.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Calculating mean of `mpg` in each `cyl` group</span></span>
<span id="cb240-3"><a href="aggregation-and-group-operations.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">aggregate</span>(<span class="at">x =</span> mtcars<span class="sc">$</span>mpg, </span>
<span id="cb240-4"><a href="aggregation-and-group-operations.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="at">by =</span> <span class="fu">list</span>(<span class="at">cyl =</span> mtcars<span class="sc">$</span>cyl), </span>
<span id="cb240-5"><a href="aggregation-and-group-operations.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="at">FUN =</span> <span class="st">&quot;mean&quot;</span>) </span>
<span id="cb240-6"><a href="aggregation-and-group-operations.html#cb240-6" aria-hidden="true" tabindex="-1"></a>  cyl        x</span>
<span id="cb240-7"><a href="aggregation-and-group-operations.html#cb240-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">4</span> <span class="fl">26.66364</span></span>
<span id="cb240-8"><a href="aggregation-and-group-operations.html#cb240-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">6</span> <span class="fl">19.74286</span></span>
<span id="cb240-9"><a href="aggregation-and-group-operations.html#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">8</span> <span class="fl">15.10000</span></span></code></pre></div>
<p>Adding <code>drop=FALSE</code> ensures all combinations of levels are returned even if no data exist at that combination. Below the final row is <code>NA</code> since there are no 8-cylinder cars with a “straight” engine (vs = 1).</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="aggregation-and-group-operations.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Two or more grouping variables</span></span>
<span id="cb241-2"><a href="aggregation-and-group-operations.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># Calculating max of `mpg` in each `cyl`*`vs` group</span></span>
<span id="cb241-3"><a href="aggregation-and-group-operations.html#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">aggregate</span>(<span class="at">x =</span> mtcars<span class="sc">$</span>mpg, </span>
<span id="cb241-4"><a href="aggregation-and-group-operations.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="at">by =</span> <span class="fu">list</span>(<span class="at">cyl =</span> mtcars<span class="sc">$</span>cyl, <span class="at">vs =</span> mtcars<span class="sc">$</span>vs), </span>
<span id="cb241-5"><a href="aggregation-and-group-operations.html#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>           <span class="at">FUN =</span> <span class="st">&quot;max&quot;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>) </span>
<span id="cb241-6"><a href="aggregation-and-group-operations.html#cb241-6" aria-hidden="true" tabindex="-1"></a>  cyl vs    x</span>
<span id="cb241-7"><a href="aggregation-and-group-operations.html#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">4</span>  <span class="dv">0</span> <span class="fl">26.0</span></span>
<span id="cb241-8"><a href="aggregation-and-group-operations.html#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">6</span>  <span class="dv">0</span> <span class="fl">21.0</span></span>
<span id="cb241-9"><a href="aggregation-and-group-operations.html#cb241-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">8</span>  <span class="dv">0</span> <span class="fl">19.2</span></span>
<span id="cb241-10"><a href="aggregation-and-group-operations.html#cb241-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">4</span>  <span class="dv">1</span> <span class="fl">33.9</span></span>
<span id="cb241-11"><a href="aggregation-and-group-operations.html#cb241-11" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">6</span>  <span class="dv">1</span> <span class="fl">21.4</span></span>
<span id="cb241-12"><a href="aggregation-and-group-operations.html#cb241-12" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">8</span>  <span class="dv">1</span>   <span class="cn">NA</span></span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="aggregation-and-group-operations.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># Or, specify the variable to summarize and the grouping variables in formula notation</span></span>
<span id="cb242-2"><a href="aggregation-and-group-operations.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">aggregate</span>(mpg <span class="sc">~</span> cyl <span class="sc">+</span> vs, <span class="at">data =</span> mtcars, <span class="at">FUN =</span> max)</span></code></pre></div>
<p>The <strong>tidyverse</strong> also offers a summarizing function, <code>summarize()</code> (or <code>summarise()</code>, for the Britons), which is in the <strong>dplyr</strong> package. After grouping a data frame/tibble (with, e.g., <strong>dplyr</strong>’s <code>group_by()</code> function), a user passes it to <code>summarize()</code>, specifying in the function call how the summary statistic should be calculated.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="aggregation-and-group-operations.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(dplyr)</span>
<span id="cb243-2"><a href="aggregation-and-group-operations.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb243-3"><a href="aggregation-and-group-operations.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">group_by</span>(cyl, vs) <span class="sc">%&gt;%</span> </span>
<span id="cb243-4"><a href="aggregation-and-group-operations.html#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">summarize</span>(<span class="at">avg_mpg =</span> <span class="fu">mean</span>(mpg))</span>
<span id="cb243-5"><a href="aggregation-and-group-operations.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">summarise()</span><span class="st">`</span> has grouped output by <span class="st">&#39;cyl&#39;</span>. You can override using the <span class="st">`</span><span class="at">.groups</span><span class="st">`</span> argument.</span>
<span id="cb243-6"><a href="aggregation-and-group-operations.html#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 5 x 3</span></span>
<span id="cb243-7"><a href="aggregation-and-group-operations.html#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   cyl [3]</span></span>
<span id="cb243-8"><a href="aggregation-and-group-operations.html#cb243-8" aria-hidden="true" tabindex="-1"></a>    cyl    vs avg_mpg</span>
<span id="cb243-9"><a href="aggregation-and-group-operations.html#cb243-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb243-10"><a href="aggregation-and-group-operations.html#cb243-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">4</span>     <span class="dv">0</span>    <span class="dv">26</span>  </span>
<span id="cb243-11"><a href="aggregation-and-group-operations.html#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">4</span>     <span class="dv">1</span>    <span class="fl">26.7</span></span>
<span id="cb243-12"><a href="aggregation-and-group-operations.html#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">6</span>     <span class="dv">0</span>    <span class="fl">20.6</span></span>
<span id="cb243-13"><a href="aggregation-and-group-operations.html#cb243-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">6</span>     <span class="dv">1</span>    <span class="fl">19.1</span></span>
<span id="cb243-14"><a href="aggregation-and-group-operations.html#cb243-14" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">8</span>     <span class="dv">0</span>    <span class="fl">15.1</span></span></code></pre></div>
<p><code>summarize()</code> makes it easy to specify relatively complicated summary calculations without needing to write an external function.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="aggregation-and-group-operations.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb244-2"><a href="aggregation-and-group-operations.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">group_by</span>(cyl, vs) <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="aggregation-and-group-operations.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>   <span class="fu">summarize</span>(<span class="at">avg_mpg =</span> <span class="fu">mean</span>(mpg),</span>
<span id="cb244-4"><a href="aggregation-and-group-operations.html#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>             <span class="at">complicated_summary_calculation =</span> </span>
<span id="cb244-5"><a href="aggregation-and-group-operations.html#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="fu">min</span>(mpg)<span class="sc">^</span><span class="fl">0.5</span> <span class="sc">*</span> </span>
<span id="cb244-6"><a href="aggregation-and-group-operations.html#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="fu">mean</span>(wt)<span class="sc">^</span><span class="fl">0.5</span> <span class="sc">+</span> </span>
<span id="cb244-7"><a href="aggregation-and-group-operations.html#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>               <span class="fu">mean</span>(disp)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(hp)))</span>
<span id="cb244-8"><a href="aggregation-and-group-operations.html#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">summarise()</span><span class="st">`</span> has grouped output by <span class="st">&#39;cyl&#39;</span>. You can override using the <span class="st">`</span><span class="at">.groups</span><span class="st">`</span> argument.</span>
<span id="cb244-9"><a href="aggregation-and-group-operations.html#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 5 x 4</span></span>
<span id="cb244-10"><a href="aggregation-and-group-operations.html#cb244-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Groups:   cyl [3]</span></span>
<span id="cb244-11"><a href="aggregation-and-group-operations.html#cb244-11" aria-hidden="true" tabindex="-1"></a>    cyl    vs avg_mpg complicated_summary_calculation</span>
<span id="cb244-12"><a href="aggregation-and-group-operations.html#cb244-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>   <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>                           <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb244-13"><a href="aggregation-and-group-operations.html#cb244-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">4</span>     <span class="dv">0</span>    <span class="dv">26</span>                              <span class="fl">8.51</span></span>
<span id="cb244-14"><a href="aggregation-and-group-operations.html#cb244-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">4</span>     <span class="dv">1</span>    <span class="fl">26.7</span>                            <span class="fl">8.07</span></span>
<span id="cb244-15"><a href="aggregation-and-group-operations.html#cb244-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">6</span>     <span class="dv">0</span>    <span class="fl">20.6</span>                            <span class="fl">8.41</span></span>
<span id="cb244-16"><a href="aggregation-and-group-operations.html#cb244-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">6</span>     <span class="dv">1</span>    <span class="fl">19.1</span>                            <span class="fl">8.81</span></span>
<span id="cb244-17"><a href="aggregation-and-group-operations.html#cb244-17" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">8</span>     <span class="dv">0</span>    <span class="fl">15.1</span>                            <span class="fl">7.48</span></span></code></pre></div>
</div>
</div>
<div id="centering-and-scaling" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Centering and Scaling</h2>
<p><em>Centering</em> refers to subtracting a constant, such as the mean, from every one of set of values. This is sometimes performed to aid interpretation of linear model coefficients.</p>
<p><em>Scaling</em> refers to rescaling a column or vector of values such that their mean is zero and their standard deviation is one. This is sometimes performed to put multiple variables on the same scale and is often recommended for procedures such as principal components analysis (PCA).</p>
<div id="python-40" class="section level4 unnumbered">
<h4>Python</h4>
<p>The <code>scale()</code> function from the <strong>preprocessing</strong> module of the <strong>scikit-learn</strong> package provides one-step centering and scaling. To center a variable at zero without scaling it, use <code>scale()</code> with <code>with_mean = True</code> and <code>with_std = False</code> (both are <code>True</code> by default).</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb245-1"><a href="aggregation-and-group-operations.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb245-2"><a href="aggregation-and-group-operations.html#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb245-3"><a href="aggregation-and-group-operations.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> centered_mpg <span class="op">=</span> preprocessing.scale(mtcars.mpg, with_mean <span class="op">=</span> <span class="va">True</span>, with_std <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb245-4"><a href="aggregation-and-group-operations.html#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> centered_mpg.mean()</span>
<span id="cb245-5"><a href="aggregation-and-group-operations.html#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">3.1086244689504383e-15</span></span></code></pre></div>
<p>To scale a variable after centering it (so that its mean is zero and its standard deviation is one), use <code>scale()</code> with <code>with_mean = True</code> and <code>with_std = True</code>.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb246-1"><a href="aggregation-and-group-operations.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb246-2"><a href="aggregation-and-group-operations.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> </span>
<span id="cb246-3"><a href="aggregation-and-group-operations.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> scaled_mpg <span class="op">=</span> preprocessing.scale(mtcars.mpg, with_mean <span class="op">=</span> <span class="va">True</span>, with_std <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb246-4"><a href="aggregation-and-group-operations.html#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> scaled_mpg.mean()</span>
<span id="cb246-5"><a href="aggregation-and-group-operations.html#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">4.996003610813204e-16</span></span>
<span id="cb246-6"><a href="aggregation-and-group-operations.html#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> scaled_mpg.std()</span>
<span id="cb246-7"><a href="aggregation-and-group-operations.html#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0</span></span></code></pre></div>
</div>
<div id="r-40" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>scale()</code> function can both center and scale variables.</p>
<p>To center a variable without scaling it, call <code>scale()</code> with the <code>center</code> argument set to <code>TRUE</code> and the <code>scale</code> argument set to <code>FALSE</code>. The variable’s mean will be subtracted off of each of the variable values. (Note: If desired, the <code>center</code> argument can be set to a numeric value instead of <code>TRUE</code>/<code>FALSE</code>; in that case, each variable value will have the argument value subtracted off of it.)</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="aggregation-and-group-operations.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> centered_mpg <span class="ot">&lt;-</span> <span class="fu">scale</span>(mtcars<span class="sc">$</span>mpg, <span class="at">center =</span> T, <span class="at">scale =</span> F)</span>
<span id="cb247-2"><a href="aggregation-and-group-operations.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mean</span>(centered_mpg)</span>
<span id="cb247-3"><a href="aggregation-and-group-operations.html#cb247-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">4.440892e-16</span></span></code></pre></div>
<p>To scale a variable (while also centering it), call <code>scale()</code> with the <code>center</code> and <code>scale</code> arguments set to <code>TRUE</code> (these are the default argument values). The variable’s mean will be subtracted off of each of the variable values, and each value will then be divided by the variable’s standard deviation. (Note: As with the <code>center</code> argument, the <code>scale</code> argument can also be set to a numeric value instead of <code>TRUE</code>/<code>FALSE</code>; in that case, the divisor will be the argument value instead of the standard deviation.)</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="aggregation-and-group-operations.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> scaled_mpg <span class="ot">&lt;-</span> <span class="fu">scale</span>(mtcars<span class="sc">$</span>mpg, <span class="at">center =</span> T, <span class="at">scale =</span> T)</span>
<span id="cb248-2"><a href="aggregation-and-group-operations.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">mean</span>(scaled_mpg)</span>
<span id="cb248-3"><a href="aggregation-and-group-operations.html#cb248-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">7.112366e-17</span></span>
<span id="cb248-4"><a href="aggregation-and-group-operations.html#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">sd</span>(scaled_mpg)</span>
<span id="cb248-5"><a href="aggregation-and-group-operations.html#cb248-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="combine-reshape-and-merge.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-plotting-and-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uvastatlab/Python_and_R/edit/main/06-aggregation-and_group_operations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
