<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Combine, Reshape and Merge | Python and R</title>
  <meta name="description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Combine, Reshape and Merge | Python and R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="github-repo" content="uvastatlab/Python_and_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Combine, Reshape and Merge | Python and R" />
  
  <meta name="twitter:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  

<meta name="author" content="Clay Ford, Jacob Goldstein-Greenwood, Oyinkansola Adenekan, Samantha Lomuscio" />


<meta name="date" content="2022-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-manipulation.html"/>
<link rel="next" href="aggregation-and-group-operations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Python and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>1</b> Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics.html"><a href="basics.html#math"><i class="fa fa-check"></i><b>1.1</b> Math</a></li>
<li class="chapter" data-level="1.2" data-path="basics.html"><a href="basics.html#missing-values"><i class="fa fa-check"></i><b>1.2</b> Missing values</a></li>
<li class="chapter" data-level="1.3" data-path="basics.html"><a href="basics.html#assignment"><i class="fa fa-check"></i><b>1.3</b> Assignment</a></li>
<li class="chapter" data-level="1.4" data-path="basics.html"><a href="basics.html#printing-a-value"><i class="fa fa-check"></i><b>1.4</b> Printing a value</a></li>
<li class="chapter" data-level="1.5" data-path="basics.html"><a href="basics.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a></li>
<li class="chapter" data-level="1.6" data-path="basics.html"><a href="basics.html#logic"><i class="fa fa-check"></i><b>1.6</b> Logic</a></li>
<li class="chapter" data-level="1.7" data-path="basics.html"><a href="basics.html#generating-a-sequence-of-values"><i class="fa fa-check"></i><b>1.7</b> Generating a sequence of values</a></li>
<li class="chapter" data-level="1.8" data-path="basics.html"><a href="basics.html#calculating-means-and-medians"><i class="fa fa-check"></i><b>1.8</b> Calculating means and medians</a></li>
<li class="chapter" data-level="1.9" data-path="basics.html"><a href="basics.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.9</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#one-dimensional-data"><i class="fa fa-check"></i><b>2.1</b> One-dimensional data</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-data"><i class="fa fa-check"></i><b>2.2</b> Two-dimensional data</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#three-dimensional-and-higher-data"><i class="fa fa-check"></i><b>2.3</b> Three-dimensional and higher data</a></li>
<li class="chapter" data-level="2.4" data-path="data-structures.html"><a href="data-structures.html#general-data-structures"><i class="fa fa-check"></i><b>2.4</b> General data structures</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html"><i class="fa fa-check"></i><b>3</b> Import, Export, and Save Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#csv"><i class="fa fa-check"></i><b>3.1</b> CSV</a></li>
<li class="chapter" data-level="3.2" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xlsxlsx-excel"><i class="fa fa-check"></i><b>3.2</b> XLS/XLSX (Excel)</a></li>
<li class="chapter" data-level="3.3" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#json"><i class="fa fa-check"></i><b>3.3</b> JSON</a></li>
<li class="chapter" data-level="3.4" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#xml"><i class="fa fa-check"></i><b>3.4</b> XML</a></li>
<li class="chapter" data-level="3.5" data-path="import-export-and-save-data.html"><a href="import-export-and-save-data.html#exportingwritingsaving-data-and-variables"><i class="fa fa-check"></i><b>3.5</b> Exporting/Writing/Saving data and variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#view-variable-names-and-types"><i class="fa fa-check"></i><b>4.1</b> View variable names and types</a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#select-variables"><i class="fa fa-check"></i><b>4.2</b> Select variables</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#filtersubset-variables"><i class="fa fa-check"></i><b>4.3</b> Filter/Subset variables</a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#rename-variables"><i class="fa fa-check"></i><b>4.4</b> Rename variables</a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation.html"><a href="data-manipulation.html#create-replace-and-remove-variables"><i class="fa fa-check"></i><b>4.5</b> Create, replace and remove variables</a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation.html"><a href="data-manipulation.html#create-strings-from-numbers"><i class="fa fa-check"></i><b>4.6</b> Create strings from numbers</a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation.html"><a href="data-manipulation.html#create-numbers-from-strings"><i class="fa fa-check"></i><b>4.7</b> Create numbers from strings</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation.html"><a href="data-manipulation.html#combine-strings"><i class="fa fa-check"></i><b>4.8</b> Combine strings</a></li>
<li class="chapter" data-level="4.9" data-path="data-manipulation.html"><a href="data-manipulation.html#finding-and-replacing-patterns-within-strings"><i class="fa fa-check"></i><b>4.9</b> Finding and replacing patterns within strings</a></li>
<li class="chapter" data-level="4.10" data-path="data-manipulation.html"><a href="data-manipulation.html#change-case"><i class="fa fa-check"></i><b>4.10</b> Change case</a></li>
<li class="chapter" data-level="4.11" data-path="data-manipulation.html"><a href="data-manipulation.html#drop-duplicate-rows"><i class="fa fa-check"></i><b>4.11</b> Drop duplicate rows</a></li>
<li class="chapter" data-level="4.12" data-path="data-manipulation.html"><a href="data-manipulation.html#format-dates"><i class="fa fa-check"></i><b>4.12</b> Format dates</a></li>
<li class="chapter" data-level="4.13" data-path="data-manipulation.html"><a href="data-manipulation.html#randomly-sample-rows"><i class="fa fa-check"></i><b>4.13</b> Randomly sample rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html"><i class="fa fa-check"></i><b>5</b> Combine, Reshape and Merge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-rows"><i class="fa fa-check"></i><b>5.1</b> Combine rows</a></li>
<li class="chapter" data-level="5.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-columns"><i class="fa fa-check"></i><b>5.2</b> Combine columns</a></li>
<li class="chapter" data-level="5.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#reshaping-data"><i class="fa fa-check"></i><b>5.3</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#wide-to-long"><i class="fa fa-check"></i><b>5.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="5.3.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#long-to-wide"><i class="fa fa-check"></i><b>5.3.2</b> Long to wide</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#mergejoin"><i class="fa fa-check"></i><b>5.4</b> Merge/Join</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#left-join"><i class="fa fa-check"></i><b>5.4.1</b> Left Join</a></li>
<li class="chapter" data-level="5.4.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#right-join"><i class="fa fa-check"></i><b>5.4.2</b> Right Join</a></li>
<li class="chapter" data-level="5.4.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#inner-join"><i class="fa fa-check"></i><b>5.4.3</b> Inner Join</a></li>
<li class="chapter" data-level="5.4.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#outer-join"><i class="fa fa-check"></i><b>5.4.4</b> Outer Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html"><i class="fa fa-check"></i><b>6</b> Aggregation and Group Operations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#cross-tabulation"><i class="fa fa-check"></i><b>6.1</b> Cross tabulation</a></li>
<li class="chapter" data-level="6.2" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#group-summaries"><i class="fa fa-check"></i><b>6.2</b> Group summaries</a></li>
<li class="chapter" data-level="6.3" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.3</b> Centering and Scaling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html"><i class="fa fa-check"></i><b>7</b> Basic Plotting and Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#barplots"><i class="fa fa-check"></i><b>7.2</b> Barplots</a></li>
<li class="chapter" data-level="7.3" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#scatterplot"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.4" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#stripcharts"><i class="fa fa-check"></i><b>7.4</b> Stripcharts</a></li>
<li class="chapter" data-level="7.5" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#boxplots"><i class="fa fa-check"></i><b>7.5</b> Boxplots</a></li>
<li class="chapter" data-level="7.6" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#facet-plots"><i class="fa fa-check"></i><b>7.6</b> Facet plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html"><i class="fa fa-check"></i><b>8</b> Selected Topics in Statistical Inference</a>
<ul>
<li class="chapter" data-level="8.1" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-means"><i class="fa fa-check"></i><b>8.1</b> Comparing group means</a></li>
<li class="chapter" data-level="8.2" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#comparing-group-proportions"><i class="fa fa-check"></i><b>8.2</b> Comparing group proportions</a></li>
<li class="chapter" data-level="8.3" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#linear-modeling"><i class="fa fa-check"></i><b>8.3</b> Linear modeling</a></li>
<li class="chapter" data-level="8.4" data-path="selected-topics-in-statistical-inference.html"><a href="selected-topics-in-statistical-inference.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="combine-reshape-and-merge" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Combine, Reshape and Merge<a href="combine-reshape-and-merge.html#combine-reshape-and-merge" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter looks at various strategies for combining, reshaping, and merging data.</p>
<div id="combine-rows" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Combine rows<a href="combine-reshape-and-merge.html#combine-rows" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Combining rows can be thought of as “stacking” rectangular data structures.</p>
<div id="python-30" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-30" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>pandas</strong> function <code>concat()</code> binds rows together. It takes a list of <strong>pandas</strong> DataFrame objects. The second argument, <code>axis</code>, specifies a row bind when set to <code>0</code> and a column bind when set to <code>1</code>. The default value is <code>0</code>. The column names of the DataFrames should match; otherwise, the DataFrame fills with <code>NaN</code>s. You can bind rows with different column types.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb521-1"><a href="combine-reshape-and-merge.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb521-2"><a href="combine-reshape-and-merge.html#cb521-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-3"><a href="combine-reshape-and-merge.html#cb521-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>:[<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], <span class="st">&#39;y&#39;</span>:[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>]})</span>
<span id="cb521-4"><a href="combine-reshape-and-merge.html#cb521-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>:[<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>], <span class="st">&#39;y&#39;</span>:[<span class="st">&#39;d&#39;</span>, <span class="st">&#39;e&#39;</span>, <span class="st">&#39;f&#39;</span>]})</span>
<span id="cb521-5"><a href="combine-reshape-and-merge.html#cb521-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-6"><a href="combine-reshape-and-merge.html#cb521-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of DataFrame objects</span></span>
<span id="cb521-7"><a href="combine-reshape-and-merge.html#cb521-7" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> [d1, d2]</span>
<span id="cb521-8"><a href="combine-reshape-and-merge.html#cb521-8" aria-hidden="true" tabindex="-1"></a>combined_df <span class="op">=</span> pd.concat(frames)</span>
<span id="cb521-9"><a href="combine-reshape-and-merge.html#cb521-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-10"><a href="combine-reshape-and-merge.html#cb521-10" aria-hidden="true" tabindex="-1"></a>combined_df</span></code></pre></div>
<pre><code>##    x  y
## 0  4  a
## 1  5  b
## 2  6  c
## 0  3  d
## 1  2  e
## 2  1  f</code></pre>
<p>The following code is an example of when column names do not match, resulting in <code>NaN</code>s in the DataFrame.</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb523-1"><a href="combine-reshape-and-merge.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame with different column names</span></span>
<span id="cb523-2"><a href="combine-reshape-and-merge.html#cb523-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>:[<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>], <span class="st">&#39;z&#39;</span>:[<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>]})</span>
<span id="cb523-3"><a href="combine-reshape-and-merge.html#cb523-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>:[<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>], <span class="st">&#39;y&#39;</span>:[<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>,<span class="st">&#39;f&#39;</span>]})</span>
<span id="cb523-4"><a href="combine-reshape-and-merge.html#cb523-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-5"><a href="combine-reshape-and-merge.html#cb523-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of DataFrame objects</span></span>
<span id="cb523-6"><a href="combine-reshape-and-merge.html#cb523-6" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> [d1, d2]</span>
<span id="cb523-7"><a href="combine-reshape-and-merge.html#cb523-7" aria-hidden="true" tabindex="-1"></a>combined_df <span class="op">=</span> pd.concat(frames)</span>
<span id="cb523-8"><a href="combine-reshape-and-merge.html#cb523-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-9"><a href="combine-reshape-and-merge.html#cb523-9" aria-hidden="true" tabindex="-1"></a>combined_df</span></code></pre></div>
<pre><code>##    x    z    y
## 0  4    a  NaN
## 1  5    b  NaN
## 2  6    c  NaN
## 0  3  NaN    d
## 1  2  NaN    e
## 2  1  NaN    f</code></pre>
</div>
<div id="r-30" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-30" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As its name suggets, the <code>rbind()</code> function binds rows. It takes two or more objects as arguments. To row bind data frames, the column names must match, otherwise an error is returned. If the columns being stacked in the row bind have differing variable types, the values will be coerced according to the followig hierarchy: <code>logical</code> &lt; <code>integer</code> &lt; <code>double</code> &lt; <code>complex</code> &lt; <code>character</code>. (E.g., if you stack a set of rows with type <code>logical</code> in column <em>J</em> on a set of rows with type <code>character</code> in column <em>J</em>, the output will have column <em>J</em> as type <code>character</code>.)</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="combine-reshape-and-merge.html#cb525-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb525-2"><a href="combine-reshape-and-merge.html#cb525-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">y =</span> letters[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb525-3"><a href="combine-reshape-and-merge.html#cb525-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(d1, d2)</span></code></pre></div>
<pre><code>##   x y
## 1 4 a
## 2 5 b
## 3 6 c
## 4 3 d
## 5 2 e
## 6 1 f</code></pre>
<p>See also the <code>bind_rows()</code> function in the <strong>dplyr</strong> package.</p>
</div>
</div>
<div id="combine-columns" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Combine columns<a href="combine-reshape-and-merge.html#combine-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Combining columns can be thought of as setting rectangular data structures next to each other.</p>
<div id="python-31" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-31" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>concat()</code> function can be used to bind columns. Whereas we set <code>axis</code> to <code>0</code> above in order to bind rows, we set <code>axis</code> to <code>1</code> in order to bind columns. To column bind data frames, the number of rows must match; otherwise, the function throws an error.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb527-1"><a href="combine-reshape-and-merge.html#cb527-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x&#39;</span>:[<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], <span class="st">&#39;y&#39;</span>:[<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>]})</span>
<span id="cb527-2"><a href="combine-reshape-and-merge.html#cb527-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;z&#39;</span>:[<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>], <span class="st">&#39;a&#39;</span>:[<span class="st">&#39;d&#39;</span>, <span class="st">&#39;e&#39;</span>, <span class="st">&#39;f&#39;</span>]})</span>
<span id="cb527-3"><a href="combine-reshape-and-merge.html#cb527-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-4"><a href="combine-reshape-and-merge.html#cb527-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of DataFrame objects</span></span>
<span id="cb527-5"><a href="combine-reshape-and-merge.html#cb527-5" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> [d1, d2]</span>
<span id="cb527-6"><a href="combine-reshape-and-merge.html#cb527-6" aria-hidden="true" tabindex="-1"></a>combined_df <span class="op">=</span> pd.concat(frames, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb527-7"><a href="combine-reshape-and-merge.html#cb527-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-8"><a href="combine-reshape-and-merge.html#cb527-8" aria-hidden="true" tabindex="-1"></a>combined_df</span></code></pre></div>
<pre><code>##    x  y  z  a
## 0  4  a  3  d
## 1  5  b  2  e
## 2  6  c  1  f</code></pre>
</div>
<div id="r-31" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-31" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>cbind()</code> function binds columns. It takes two or more objects as arguments. To column bind data frames, the number of rows must match; otherwise, the object with fewer rows will have rows “recycled” (if possible) or an error will be returned.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="combine-reshape-and-merge.html#cb529-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb529-2"><a href="combine-reshape-and-merge.html#cb529-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">34</span>, <span class="dv">45</span>, <span class="dv">44</span>))</span>
<span id="cb529-3"><a href="combine-reshape-and-merge.html#cb529-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(d1, d2)</span></code></pre></div>
<pre><code>##    x y  x
## 1 10 a 23
## 2 11 b 34
## 3 12 c 45
## 4 13 d 44</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="combine-reshape-and-merge.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of recycled rows (d1 is repeated twice)</span></span>
<span id="cb531-2"><a href="combine-reshape-and-merge.html#cb531-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb531-3"><a href="combine-reshape-and-merge.html#cb531-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">34</span>, <span class="dv">45</span>, <span class="dv">44</span>, <span class="dv">99</span>, <span class="dv">99</span>, <span class="dv">99</span>, <span class="dv">99</span>))</span>
<span id="cb531-4"><a href="combine-reshape-and-merge.html#cb531-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(d1, d2)</span></code></pre></div>
<pre><code>##    x y  x
## 1 10 a 23
## 2 11 b 34
## 3 12 c 45
## 4 13 d 44
## 5 10 a 99
## 6 11 b 99
## 7 12 c 99
## 8 13 d 99</code></pre>
<p>See also the <code>bind_cols()</code> function in the <strong>dplyr</strong> package.</p>
</div>
</div>
<div id="reshaping-data" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Reshaping data<a href="combine-reshape-and-merge.html#reshaping-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The next two sections discuss how to reshape data from wide to long and from long to wide. “Wide” data are structured such that multiple values associated with a given unit (e.g., a person, a cell culture, etc.) are placed in the same row:</p>
<pre><code>##    name time_1_score time_2_score
## 1 larry            3            0
## 2   moe            6            3
## 3 curly            2            1</code></pre>
<p><em>Long</em> data, conversely, are structured such that all values are contained in one column, with another column identifying what value is given in any particular row (“time 1,” “time 2,” etc.):</p>
<pre><code>##      id time score
## 1 larry    1     3
## 2 larry    2     0
## 3   moe    1     6
## 4   moe    2     3
## 5 curly    1     2
## 6 curly    2     1</code></pre>
<p>Shifting between these two data formats is often necessary for implementing certain statistical techniques or representing data with particular visualizations.</p>
<div id="wide-to-long" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Wide to long<a href="combine-reshape-and-merge.html#wide-to-long" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="python-32" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-32" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To reshape a DataFrame from wide to long, we can use the <strong>pandas</strong> <code>melt()</code> function.</p>
<p>Consider the wide DataFrame below:</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb535-1"><a href="combine-reshape-and-merge.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb535-2"><a href="combine-reshape-and-merge.html#cb535-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb535-3"><a href="combine-reshape-and-merge.html#cb535-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-4"><a href="combine-reshape-and-merge.html#cb535-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&quot;id&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb535-5"><a href="combine-reshape-and-merge.html#cb535-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;wk1&quot;</span>: np.random.choice(<span class="bu">range</span>(<span class="dv">20</span>), <span class="dv">3</span>),</span>
<span id="cb535-6"><a href="combine-reshape-and-merge.html#cb535-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;wk2&quot;</span>: np.random.choice(<span class="bu">range</span>(<span class="dv">20</span>), <span class="dv">3</span>),</span>
<span id="cb535-7"><a href="combine-reshape-and-merge.html#cb535-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;wk3&quot;</span>: np.random.choice(<span class="bu">range</span>(<span class="dv">20</span>), <span class="dv">3</span>)}</span>
<span id="cb535-8"><a href="combine-reshape-and-merge.html#cb535-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-9"><a href="combine-reshape-and-merge.html#cb535-9" aria-hidden="true" tabindex="-1"></a>df_wide <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb535-10"><a href="combine-reshape-and-merge.html#cb535-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_wide)</span></code></pre></div>
<pre><code>##    id  wk1  wk2  wk3
## 0   1    2   19    0
## 1   2    6   10   17
## 2   3   17    1   15</code></pre>
<p>To take the DataFrame from wide to long with <code>melt()</code>, we specify the column(s) that uniquely identifies each row (<code>id_vars</code>), the variables containing the values to be lengthened (<code>value_vars</code>), and the name of the to-be-created column containing the lengthened values (<code>value_name</code>).</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb537-1"><a href="combine-reshape-and-merge.html#cb537-1" aria-hidden="true" tabindex="-1"></a>dataL <span class="op">=</span> pd.melt(df_wide,</span>
<span id="cb537-2"><a href="combine-reshape-and-merge.html#cb537-2" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Column(s) that uniquely identifies/y each row</span></span>
<span id="cb537-3"><a href="combine-reshape-and-merge.html#cb537-3" aria-hidden="true" tabindex="-1"></a>                id_vars <span class="op">=</span> [<span class="st">&quot;id&quot;</span>],</span>
<span id="cb537-4"><a href="combine-reshape-and-merge.html#cb537-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Variables that contain the values to be lengthened</span></span>
<span id="cb537-5"><a href="combine-reshape-and-merge.html#cb537-5" aria-hidden="true" tabindex="-1"></a>                value_vars <span class="op">=</span> [<span class="st">&quot;wk1&quot;</span>, <span class="st">&quot;wk2&quot;</span>, <span class="st">&quot;wk3&quot;</span>],</span>
<span id="cb537-6"><a href="combine-reshape-and-merge.html#cb537-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Desired name of column in long data that will contain values</span></span>
<span id="cb537-7"><a href="combine-reshape-and-merge.html#cb537-7" aria-hidden="true" tabindex="-1"></a>                value_name <span class="op">=</span> <span class="st">&quot;observations&quot;</span>)</span>
<span id="cb537-8"><a href="combine-reshape-and-merge.html#cb537-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dataL)</span></code></pre></div>
<pre><code>##    id variable  observations
## 0   1      wk1             2
## 1   2      wk1             6
## 2   3      wk1            17
## 3   1      wk2            19
## 4   2      wk2            10
## 5   3      wk2             1
## 6   1      wk3             0
## 7   2      wk3            17
## 8   3      wk3            15</code></pre>
</div>
<div id="r-32" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-32" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In base R, the <code>reshape()</code> function can take data from wide to long or long to wide. The <strong>tidyverse</strong> also provides reshaping functions: <code>pivot_longer()</code> and <code>pivot_wider()</code>. The <strong>tidyverse</strong> functions have a degree of intuitiveness and usability that may make them the go-to reshaping tools for many R users. We give examples below using both base R and <strong>tidyverse</strong>.</p>
<p>Say we begin with a wide data frame, <code>df_wide</code>, that looks like this:</p>
<pre><code>##   id sex wk1 wk2 wk3
## 1  1   m  16   7  15
## 2  2   m  12  19  10
## 3  3   f   8  15   7</code></pre>
<p>To lengthen a data frame using <code>reshape()</code>, a user provides arguments specifying the columns that identify values’ origins (person, cell culture, etc.), the columns containing values to be lengthened, and the desired names for new columns in long data:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="combine-reshape-and-merge.html#cb540-1" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df_wide,</span>
<span id="cb540-2"><a href="combine-reshape-and-merge.html#cb540-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>,</span>
<span id="cb540-3"><a href="combine-reshape-and-merge.html#cb540-3" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Column(s) that uniquely identifies/y each row</span></span>
<span id="cb540-4"><a href="combine-reshape-and-merge.html#cb540-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>), </span>
<span id="cb540-5"><a href="combine-reshape-and-merge.html#cb540-5" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Variables that contain the values to be lengthened</span></span>
<span id="cb540-6"><a href="combine-reshape-and-merge.html#cb540-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">&#39;wk1&#39;</span>, <span class="st">&#39;wk2&#39;</span>, <span class="st">&#39;wk3&#39;</span>),</span>
<span id="cb540-7"><a href="combine-reshape-and-merge.html#cb540-7" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Desired name of column in long data that will contain values</span></span>
<span id="cb540-8"><a href="combine-reshape-and-merge.html#cb540-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">v.names =</span> <span class="st">&#39;val&#39;</span>,</span>
<span id="cb540-9"><a href="combine-reshape-and-merge.html#cb540-9" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Desired name of column in long data that will identify each value&#39;s context</span></span>
<span id="cb540-10"><a href="combine-reshape-and-merge.html#cb540-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">timevar =</span> <span class="st">&#39;week&#39;</span>)</span>
<span id="cb540-11"><a href="combine-reshape-and-merge.html#cb540-11" aria-hidden="true" tabindex="-1"></a>df_long</span></code></pre></div>
<pre><code>##       id sex week val
## 1.m.1  1   m    1  16
## 2.m.1  2   m    1  12
## 3.f.1  3   f    1   8
## 1.m.2  1   m    2   7
## 2.m.2  2   m    2  19
## 3.f.2  3   f    2  15
## 1.m.3  1   m    3  15
## 2.m.3  2   m    3  10
## 3.f.3  3   f    3   7</code></pre>
<p>The <strong>tidyverse</strong> function for taking data from wide to long is <code>pivot_longer()</code> (technically housed in the <strong>tidyr</strong> package). To lengthen <code>df_wide</code> using <code>pivot_longer()</code>, a user would write:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="combine-reshape-and-merge.html#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb542-2"><a href="combine-reshape-and-merge.html#cb542-2" aria-hidden="true" tabindex="-1"></a>df_long_PL <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df_wide,</span>
<span id="cb542-3"><a href="combine-reshape-and-merge.html#cb542-3" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Columns that contain the values to be lengthened (can use -c() to negate variables)</span></span>
<span id="cb542-4"><a href="combine-reshape-and-merge.html#cb542-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>), </span>
<span id="cb542-5"><a href="combine-reshape-and-merge.html#cb542-5" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Desired name of column in long data that will identify each value&#39;s context</span></span>
<span id="cb542-6"><a href="combine-reshape-and-merge.html#cb542-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">names_to =</span> <span class="st">&#39;week&#39;</span>,</span>
<span id="cb542-7"><a href="combine-reshape-and-merge.html#cb542-7" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># Desired name of column in long data that will contain values</span></span>
<span id="cb542-8"><a href="combine-reshape-and-merge.html#cb542-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">values_to =</span> <span class="st">&#39;val&#39;</span>) </span>
<span id="cb542-9"><a href="combine-reshape-and-merge.html#cb542-9" aria-hidden="true" tabindex="-1"></a>df_long_PL</span></code></pre></div>
<pre><code>## # A tibble: 9 × 4
##      id sex   week    val
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
## 1     1 m     wk1      16
## 2     1 m     wk2       7
## 3     1 m     wk3      15
## 4     2 m     wk1      12
## 5     2 m     wk2      19
## 6     2 m     wk3      10
## 7     3 f     wk1       8
## 8     3 f     wk2      15
## 9     3 f     wk3       7</code></pre>
<p><code>pivot_longer()</code> is particularly useful (a) when dealing with wide data that contain multiple sets of repeated measures in each row that need to be lengthened separately (e.g., two monthly height measurements and two monthly weight measurements for each person) and (b) when column names and/or column values in the long data need to be extracted from column names of the wide data using regular expressions.</p>
<p>For example, say we begin with a wide data frame, <code>animals_wide</code>, in which every row contains two values for each of two different measures:</p>
<pre><code>##      animal lives_in_water jan_playfulness feb_playfulness jan_excitement feb_excitement
## 1   dolphin           TRUE             6.0             5.5            7.0            7.0
## 2 porcupine          FALSE             3.5             4.5            3.5            3.5
## 3  capybara          FALSE             4.0             5.0            4.0            4.0</code></pre>
<p><code>pivot_longer()</code> can be used to convert this data frame to a long format where there is one column for each of the measures, playfulness and excitement:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="combine-reshape-and-merge.html#cb545-1" aria-hidden="true" tabindex="-1"></a>animals_long_1 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(animals_wide,</span>
<span id="cb545-2"><a href="combine-reshape-and-merge.html#cb545-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb545-3"><a href="combine-reshape-and-merge.html#cb545-3" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># &quot;.value&quot; is placeholder for strings that will be extracted from wide column names </span></span>
<span id="cb545-4"><a href="combine-reshape-and-merge.html#cb545-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;month&#39;</span>, <span class="st">&#39;.value&#39;</span>),</span>
<span id="cb545-5"><a href="combine-reshape-and-merge.html#cb545-5" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># Specify structure of wide column names from which long column names will be extracted using regex</span></span>
<span id="cb545-6"><a href="combine-reshape-and-merge.html#cb545-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_pattern =</span> <span class="st">&#39;(.+)_(.+)&#39;</span>) </span>
<span id="cb545-7"><a href="combine-reshape-and-merge.html#cb545-7" aria-hidden="true" tabindex="-1"></a>animals_long_1</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   animal    lives_in_water month playfulness excitement
##   &lt;chr&gt;     &lt;lgl&gt;          &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1 dolphin   TRUE           jan           6          7  
## 2 dolphin   TRUE           feb           5.5        7  
## 3 porcupine FALSE          jan           3.5        3.5
## 4 porcupine FALSE          feb           4.5        3.5
## 5 capybara  FALSE          jan           4          4  
## 6 capybara  FALSE          feb           5          4</code></pre>
<p>Alternatively, <code>pivot_longer()</code> can be used to convert this data frame to a long format where there is one column containing all the playfulness and excitement values:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="combine-reshape-and-merge.html#cb547-1" aria-hidden="true" tabindex="-1"></a>animals_long_2 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(animals_wide,</span>
<span id="cb547-2"><a href="combine-reshape-and-merge.html#cb547-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb547-3"><a href="combine-reshape-and-merge.html#cb547-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;month&#39;</span>, <span class="st">&#39;measure&#39;</span>),</span>
<span id="cb547-4"><a href="combine-reshape-and-merge.html#cb547-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">names_pattern =</span> <span class="st">&#39;(.+)_(.+)&#39;</span>,</span>
<span id="cb547-5"><a href="combine-reshape-and-merge.html#cb547-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">values_to =</span> <span class="st">&#39;val&#39;</span>)</span>
<span id="cb547-6"><a href="combine-reshape-and-merge.html#cb547-6" aria-hidden="true" tabindex="-1"></a>animals_long_2</span></code></pre></div>
<pre><code>## # A tibble: 12 × 5
##    animal    lives_in_water month measure       val
##    &lt;chr&gt;     &lt;lgl&gt;          &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1 dolphin   TRUE           jan   playfulness   6  
##  2 dolphin   TRUE           feb   playfulness   5.5
##  3 dolphin   TRUE           jan   excitement    7  
##  4 dolphin   TRUE           feb   excitement    7  
##  5 porcupine FALSE          jan   playfulness   3.5
##  6 porcupine FALSE          feb   playfulness   4.5
##  7 porcupine FALSE          jan   excitement    3.5
##  8 porcupine FALSE          feb   excitement    3.5
##  9 capybara  FALSE          jan   playfulness   4  
## 10 capybara  FALSE          feb   playfulness   5  
## 11 capybara  FALSE          jan   excitement    4  
## 12 capybara  FALSE          feb   excitement    4</code></pre>
</div>
</div>
<div id="long-to-wide" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Long to wide<a href="combine-reshape-and-merge.html#long-to-wide" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="python-33" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-33" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To reshape a DataFrame from long to wide, we can use the <strong>pandas</strong> <code>pivot_table()</code> function.</p>
<p>Consider the following long DataFrame:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb549-1"><a href="combine-reshape-and-merge.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb549-2"><a href="combine-reshape-and-merge.html#cb549-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb549-3"><a href="combine-reshape-and-merge.html#cb549-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-4"><a href="combine-reshape-and-merge.html#cb549-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&quot;id&quot;</span>: np.concatenate([([i]<span class="op">*</span><span class="dv">3</span>) <span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span> ,<span class="dv">3</span>]], axis<span class="op">=</span><span class="dv">0</span>),</span>
<span id="cb549-5"><a href="combine-reshape-and-merge.html#cb549-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;week&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>] <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb549-6"><a href="combine-reshape-and-merge.html#cb549-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;observations&quot;</span>: np.random.choice(<span class="bu">range</span>(<span class="dv">20</span>), <span class="dv">9</span>)}</span>
<span id="cb549-7"><a href="combine-reshape-and-merge.html#cb549-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb549-8"><a href="combine-reshape-and-merge.html#cb549-8" aria-hidden="true" tabindex="-1"></a>df_long <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb549-9"><a href="combine-reshape-and-merge.html#cb549-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_long)</span></code></pre></div>
<pre><code>##    id  week  observations
## 0   1     1             9
## 1   1     2             0
## 2   1     3            14
## 3   2     1             0
## 4   2     2            15
## 5   2     3            19
## 6   3     1            14
## 7   3     2             4
## 8   3     3             0</code></pre>
<p>We can use <code>pivot_table()</code> to take the DataFrame from long to wide by specifying: the variable(s) that indicates each value’s source (<code>index</code>), the variable that indicates the context of each value (<code>columns</code>; e.g., “week 1,” “week 2,” etc.), and the variable containing the values to be widened (<code>values</code>).</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb551-1"><a href="combine-reshape-and-merge.html#cb551-1" aria-hidden="true" tabindex="-1"></a>df_wide <span class="op">=</span> pd.pivot_table(df_long,</span>
<span id="cb551-2"><a href="combine-reshape-and-merge.html#cb551-2" aria-hidden="true" tabindex="-1"></a>          index <span class="op">=</span> <span class="st">&#39;id&#39;</span>,</span>
<span id="cb551-3"><a href="combine-reshape-and-merge.html#cb551-3" aria-hidden="true" tabindex="-1"></a>          columns <span class="op">=</span> <span class="st">&#39;week&#39;</span>,</span>
<span id="cb551-4"><a href="combine-reshape-and-merge.html#cb551-4" aria-hidden="true" tabindex="-1"></a>          values <span class="op">=</span> <span class="st">&#39;observations&#39;</span>)</span>
<span id="cb551-5"><a href="combine-reshape-and-merge.html#cb551-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_wide)</span></code></pre></div>
<pre><code>## week   1   2   3
## id              
## 1      9   0  14
## 2      0  15  19
## 3     14   4   0</code></pre>
</div>
<div id="r-33" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-33" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Say that we begin with a long data frame, <code>df_long</code>, that looks like this:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="combine-reshape-and-merge.html#cb553-1" aria-hidden="true" tabindex="-1"></a>df_long</span></code></pre></div>
<pre><code>##       id sex week val
## 1.m.1  1   m    1  16
## 2.m.1  2   m    1  12
## 3.f.1  3   f    1   8
## 1.m.2  1   m    2   7
## 2.m.2  2   m    2  19
## 3.f.2  3   f    2  15
## 1.m.3  1   m    3  15
## 2.m.3  2   m    3  10
## 3.f.3  3   f    3   7</code></pre>
<p>To take the data from long to wide with base R’s <code>reshape()</code> function, a user would write:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="combine-reshape-and-merge.html#cb555-1" aria-hidden="true" tabindex="-1"></a>df_wide <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df_long,</span>
<span id="cb555-2"><a href="combine-reshape-and-merge.html#cb555-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">&#39;wide&#39;</span>,</span>
<span id="cb555-3"><a href="combine-reshape-and-merge.html#cb555-3" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Column(s) that determine which rows should be grouped together in the wide data</span></span>
<span id="cb555-4"><a href="combine-reshape-and-merge.html#cb555-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>),</span>
<span id="cb555-5"><a href="combine-reshape-and-merge.html#cb555-5" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Column containing values to widen</span></span>
<span id="cb555-6"><a href="combine-reshape-and-merge.html#cb555-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">v.names =</span> <span class="st">&#39;val&#39;</span>,</span>
<span id="cb555-7"><a href="combine-reshape-and-merge.html#cb555-7" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Column from which resulting wide column names are pulled</span></span>
<span id="cb555-8"><a href="combine-reshape-and-merge.html#cb555-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">timevar =</span> <span class="st">&#39;week&#39;</span>,</span>
<span id="cb555-9"><a href="combine-reshape-and-merge.html#cb555-9" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># The `sep` argument allows a user to specify how the contents of `timevar` should be joined with the name of the `v.names` variable to form wide column names</span></span>
<span id="cb555-10"><a href="combine-reshape-and-merge.html#cb555-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>)</span>
<span id="cb555-11"><a href="combine-reshape-and-merge.html#cb555-11" aria-hidden="true" tabindex="-1"></a>df_wide</span></code></pre></div>
<pre><code>##       id sex val_1 val_2 val_3
## 1.m.1  1   m    16     7    15
## 2.m.1  2   m    12    19    10
## 3.f.1  3   f     8    15     7</code></pre>
<p>The <strong>tidyverse</strong> function for taking data from long to wide is <code>pivot_wider()</code>. To widen <code>df_long</code> using <code>pivot_longer()</code>, a user would write:</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="combine-reshape-and-merge.html#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb557-2"><a href="combine-reshape-and-merge.html#cb557-2" aria-hidden="true" tabindex="-1"></a>df_wide_PW <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(df_long,</span>
<span id="cb557-3"><a href="combine-reshape-and-merge.html#cb557-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>),</span>
<span id="cb557-4"><a href="combine-reshape-and-merge.html#cb557-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">values_from =</span> <span class="st">&#39;val&#39;</span>,</span>
<span id="cb557-5"><a href="combine-reshape-and-merge.html#cb557-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">names_from =</span> <span class="st">&#39;week&#39;</span>,</span>
<span id="cb557-6"><a href="combine-reshape-and-merge.html#cb557-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">names_prefix =</span> <span class="st">&#39;week_&#39;</span>) <span class="co"># `names_prefix` specifies a string to paste in front of the contents of &#39;week&#39; in the resulting wide column names</span></span>
<span id="cb557-7"><a href="combine-reshape-and-merge.html#cb557-7" aria-hidden="true" tabindex="-1"></a>df_wide_PW</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##      id sex   week_1 week_2 week_3
##   &lt;int&gt; &lt;chr&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
## 1     1 m         16      7     15
## 2     2 m         12     19     10
## 3     3 f          8     15      7</code></pre>
<p><code>pivot_wider()</code> provides a great deal of functonality when widening relatively complicated long data structures. For example, say we want to widen both of the long versions of the “animals” data frame created above.</p>
<p>To widen the version of the long data that has a column for each of the measures (playfulness and excitement):</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="combine-reshape-and-merge.html#cb559-1" aria-hidden="true" tabindex="-1"></a>animals_long_1</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   animal    lives_in_water month playfulness excitement
##   &lt;chr&gt;     &lt;lgl&gt;          &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1 dolphin   TRUE           jan           6          7  
## 2 dolphin   TRUE           feb           5.5        7  
## 3 porcupine FALSE          jan           3.5        3.5
## 4 porcupine FALSE          feb           4.5        3.5
## 5 capybara  FALSE          jan           4          4  
## 6 capybara  FALSE          feb           5          4</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="combine-reshape-and-merge.html#cb561-1" aria-hidden="true" tabindex="-1"></a>animals_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(animals_long_1,</span>
<span id="cb561-2"><a href="combine-reshape-and-merge.html#cb561-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, </span>
<span id="cb561-3"><a href="combine-reshape-and-merge.html#cb561-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb561-4"><a href="combine-reshape-and-merge.html#cb561-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;playfulness&#39;</span>,</span>
<span id="cb561-5"><a href="combine-reshape-and-merge.html#cb561-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&#39;excitement&#39;</span>),</span>
<span id="cb561-6"><a href="combine-reshape-and-merge.html#cb561-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">names_from =</span> <span class="st">&#39;month&#39;</span>,</span>
<span id="cb561-7"><a href="combine-reshape-and-merge.html#cb561-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">names_glue =</span> <span class="st">&#39;{month}_{.value}&#39;</span>) <span class="co"># `names_glue` allows for customization of column names using &quot;glue&quot;; see https://glue.tidyverse.org/</span></span>
<span id="cb561-8"><a href="combine-reshape-and-merge.html#cb561-8" aria-hidden="true" tabindex="-1"></a>animals_wide</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   animal    lives_in_water jan_playfulness feb_playfulness jan_excitement feb_excitement
##   &lt;chr&gt;     &lt;lgl&gt;                    &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
## 1 dolphin   TRUE                       6               5.5            7              7  
## 2 porcupine FALSE                      3.5             4.5            3.5            3.5
## 3 capybara  FALSE                      4               5              4              4</code></pre>
<p>To widen the version of the long data that has one column containing all the values of playfulness and excitement together:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="combine-reshape-and-merge.html#cb563-1" aria-hidden="true" tabindex="-1"></a>animals_long_2</span></code></pre></div>
<pre><code>## # A tibble: 12 × 5
##    animal    lives_in_water month measure       val
##    &lt;chr&gt;     &lt;lgl&gt;          &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1 dolphin   TRUE           jan   playfulness   6  
##  2 dolphin   TRUE           feb   playfulness   5.5
##  3 dolphin   TRUE           jan   excitement    7  
##  4 dolphin   TRUE           feb   excitement    7  
##  5 porcupine FALSE          jan   playfulness   3.5
##  6 porcupine FALSE          feb   playfulness   4.5
##  7 porcupine FALSE          jan   excitement    3.5
##  8 porcupine FALSE          feb   excitement    3.5
##  9 capybara  FALSE          jan   playfulness   4  
## 10 capybara  FALSE          feb   playfulness   5  
## 11 capybara  FALSE          jan   excitement    4  
## 12 capybara  FALSE          feb   excitement    4</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="combine-reshape-and-merge.html#cb565-1" aria-hidden="true" tabindex="-1"></a>animals_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(animals_long_2,</span>
<span id="cb565-2"><a href="combine-reshape-and-merge.html#cb565-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb565-3"><a href="combine-reshape-and-merge.html#cb565-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">values_from =</span> <span class="st">&#39;val&#39;</span>,</span>
<span id="cb565-4"><a href="combine-reshape-and-merge.html#cb565-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">names_from =</span> <span class="fu">c</span>(<span class="st">&#39;month&#39;</span>, <span class="st">&#39;measure&#39;</span>),</span>
<span id="cb565-5"><a href="combine-reshape-and-merge.html#cb565-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">names_sep =</span> <span class="st">&#39;_&#39;</span>)</span>
<span id="cb565-6"><a href="combine-reshape-and-merge.html#cb565-6" aria-hidden="true" tabindex="-1"></a>animals_wide</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   animal    lives_in_water jan_playfulness feb_playfulness jan_excitement feb_excitement
##   &lt;chr&gt;     &lt;lgl&gt;                    &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
## 1 dolphin   TRUE                       6               5.5            7              7  
## 2 porcupine FALSE                      3.5             4.5            3.5            3.5
## 3 capybara  FALSE                      4               5              4              4</code></pre>
</div>
</div>
</div>
<div id="mergejoin" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Merge/Join<a href="combine-reshape-and-merge.html#mergejoin" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The merge/join examples below all make use of the following sample data frames:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="combine-reshape-and-merge.html#cb567-1" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##   merge_var val_x
## 1         a    12
## 2         b    94
## 3         c    92</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="combine-reshape-and-merge.html#cb569-1" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##   merge_var val_y
## 1         c    78
## 2         d    32
## 3         e    30</code></pre>
<div id="left-join" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Left Join<a href="combine-reshape-and-merge.html#left-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A left join of <em>x</em> and <em>y</em> keeps all rows of <em>x</em> and merges rows of <em>y</em> into <em>x</em> where possible based on the merge criterion:</p>
<p><img src="images/left_join.png" width="621" /></p>
<div id="python-34" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-34" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb571"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb571-1"><a href="combine-reshape-and-merge.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb571-2"><a href="combine-reshape-and-merge.html#cb571-2" aria-hidden="true" tabindex="-1"></a>pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>)</span></code></pre></div>
<pre><code>##   merge_var  val_x  val_y
## 0         a   12.0    NaN
## 1         b   94.0    NaN
## 2         c   92.0   78.0</code></pre>
</div>
<div id="r-34" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-34" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="combine-reshape-and-merge.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all.x = T results in a left join</span></span>
<span id="cb573-2"><a href="combine-reshape-and-merge.html#cb573-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>, <span class="at">all.x =</span> T)</span></code></pre></div>
<pre><code>##   merge_var val_x val_y
## 1         a    12    NA
## 2         b    94    NA
## 3         c    92    78</code></pre>
</div>
</div>
<div id="right-join" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Right Join<a href="combine-reshape-and-merge.html#right-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A right join of <em>x</em> and <em>y</em> keeps all rows of <em>y</em> and merges rows of <em>x</em> into <em>y</em> wherever possible based on the merge criterion:</p>
<p><img src="images/right_join.png" width="621" /></p>
<div id="python-35" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-35" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb575"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb575-1"><a href="combine-reshape-and-merge.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb575-2"><a href="combine-reshape-and-merge.html#cb575-2" aria-hidden="true" tabindex="-1"></a>pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;right&#39;</span>)</span></code></pre></div>
<pre><code>##   merge_var  val_x  val_y
## 0         c   92.0   78.0
## 1         d    NaN   32.0
## 2         e    NaN   30.0</code></pre>
</div>
<div id="r-35" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-35" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="combine-reshape-and-merge.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all.y = T results in a right join</span></span>
<span id="cb577-2"><a href="combine-reshape-and-merge.html#cb577-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>, <span class="at">all.y =</span> T)</span></code></pre></div>
<pre><code>##   merge_var val_x val_y
## 1         c    92    78
## 2         d    NA    32
## 3         e    NA    30</code></pre>
</div>
</div>
<div id="inner-join" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Inner Join<a href="combine-reshape-and-merge.html#inner-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An inner join of <em>x</em> and <em>y</em> returns merged rows for which a match can be found on the merge criterion <em>in both tables</em>:</p>
<p><img src="images/inner_join.png" width="621" /></p>
<div id="python-36" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-36" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb579"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb579-1"><a href="combine-reshape-and-merge.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb579-2"><a href="combine-reshape-and-merge.html#cb579-2" aria-hidden="true" tabindex="-1"></a>pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;inner&#39;</span>)</span></code></pre></div>
<pre><code>##   merge_var  val_x  val_y
## 0         c   92.0   78.0</code></pre>
</div>
<div id="r-36" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-36" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="combine-reshape-and-merge.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With its default arguments, merge() executes an inner join (more specifically, a natural join, which is a kind of</span></span>
<span id="cb581-2"><a href="combine-reshape-and-merge.html#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inner join in which the merge-criterion column is not repeated, despite being initially present in both tables)</span></span>
<span id="cb581-3"><a href="combine-reshape-and-merge.html#cb581-3" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>)</span></code></pre></div>
<pre><code>##   merge_var val_x val_y
## 1         c    92    78</code></pre>
</div>
</div>
<div id="outer-join" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Outer Join<a href="combine-reshape-and-merge.html#outer-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An outer join of <em>x</em> and <em>y</em> keeps all rows from both tables, merging rows wherever possible based on the merge criterion:</p>
<p><img src="images/outer_join.png" width="621" /></p>
<div id="python-37" class="section level4 unnumbered hasAnchor">
<h4>Python<a href="combine-reshape-and-merge.html#python-37" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb583"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb583-1"><a href="combine-reshape-and-merge.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb583-2"><a href="combine-reshape-and-merge.html#cb583-2" aria-hidden="true" tabindex="-1"></a>pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;outer&#39;</span>)</span></code></pre></div>
<pre><code>##   merge_var  val_x  val_y
## 0         a   12.0    NaN
## 1         b   94.0    NaN
## 2         c   92.0   78.0
## 3         d    NaN   32.0
## 4         e    NaN   30.0</code></pre>
</div>
<div id="r-37" class="section level4 unnumbered hasAnchor">
<h4>R<a href="combine-reshape-and-merge.html#r-37" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="combine-reshape-and-merge.html#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all = T (or all.x = T AND all.y = T) results in an outer join</span></span>
<span id="cb585-2"><a href="combine-reshape-and-merge.html#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>, <span class="at">all =</span> T)</span></code></pre></div>
<pre><code>##   merge_var val_x val_y
## 1         a    12    NA
## 2         b    94    NA
## 3         c    92    78
## 4         d    NA    32
## 5         e    NA    30</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aggregation-and-group-operations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uvastatlab/Python_and_R/edit/main/05-reshape-merge-combine.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
