<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Combine, Reshape and Merge | Python and R</title>
  <meta name="description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Combine, Reshape and Merge | Python and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  <meta name="github-repo" content="uvastatlab/Python_and_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Combine, Reshape and Merge | Python and R" />
  
  <meta name="twitter:description" content="This book provides parallel examples in Python and R to help users of one platform more easily transition to the other." />
  

<meta name="author" content="Clay Ford, Jacob Goldstein-Greenwood, Oyinkansola Adenekan, Samantha Lomuscio" />


<meta name="date" content="2021-11-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-manipulation.html"/>
<link rel="next" href="aggregation-and-group-operations.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Python and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>1</b> Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics.html"><a href="basics.html#math"><i class="fa fa-check"></i><b>1.1</b> Math</a></li>
<li class="chapter" data-level="1.2" data-path="basics.html"><a href="basics.html#assignment"><i class="fa fa-check"></i><b>1.2</b> Assignment</a></li>
<li class="chapter" data-level="1.3" data-path="basics.html"><a href="basics.html#printing-a-value"><i class="fa fa-check"></i><b>1.3</b> Printing a value</a></li>
<li class="chapter" data-level="1.4" data-path="basics.html"><a href="basics.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="basics.html"><a href="basics.html#logic"><i class="fa fa-check"></i><b>1.5</b> Logic</a></li>
<li class="chapter" data-level="1.6" data-path="basics.html"><a href="basics.html#generating-a-sequence-of-values"><i class="fa fa-check"></i><b>1.6</b> Generating a sequence of values</a></li>
<li class="chapter" data-level="1.7" data-path="basics.html"><a href="basics.html#calculating-means-and-medians"><i class="fa fa-check"></i><b>1.7</b> Calculating means and medians</a></li>
<li class="chapter" data-level="1.8" data-path="basics.html"><a href="basics.html#writing-your-own-functions"><i class="fa fa-check"></i><b>1.8</b> Writing your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>2</b> Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-structures.html"><a href="data-structures.html#one-dimensional-data"><i class="fa fa-check"></i><b>2.1</b> One-dimensional data</a></li>
<li class="chapter" data-level="2.2" data-path="data-structures.html"><a href="data-structures.html#two-dimensional-data"><i class="fa fa-check"></i><b>2.2</b> Two-dimensional data</a></li>
<li class="chapter" data-level="2.3" data-path="data-structures.html"><a href="data-structures.html#three-dimensional-and-higher-data"><i class="fa fa-check"></i><b>2.3</b> Three-dimensional and higher data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3</b> Importing Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="importing-data.html"><a href="importing-data.html#csv"><i class="fa fa-check"></i><b>3.1</b> CSV</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data.html"><a href="importing-data.html#xlsxlsx-excel"><i class="fa fa-check"></i><b>3.2</b> XLS/XLSX (Excel)</a></li>
<li class="chapter" data-level="3.3" data-path="importing-data.html"><a href="importing-data.html#json"><i class="fa fa-check"></i><b>3.3</b> JSON</a></li>
<li class="chapter" data-level="3.4" data-path="importing-data.html"><a href="importing-data.html#xml"><i class="fa fa-check"></i><b>3.4</b> XML</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation.html"><a href="data-manipulation.html#names-of-variables-and-their-types"><i class="fa fa-check"></i><b>4.1</b> Names of variables and their types</a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation.html"><a href="data-manipulation.html#access-variables"><i class="fa fa-check"></i><b>4.2</b> Access variables</a></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation.html"><a href="data-manipulation.html#rename-variables"><i class="fa fa-check"></i><b>4.3</b> Rename variables</a></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation.html"><a href="data-manipulation.html#create-replace-and-remove-variables"><i class="fa fa-check"></i><b>4.4</b> Create, replace and remove variables</a></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation.html"><a href="data-manipulation.html#create-strings-from-numbers"><i class="fa fa-check"></i><b>4.5</b> Create strings from numbers</a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation.html"><a href="data-manipulation.html#create-numbers-from-strings"><i class="fa fa-check"></i><b>4.6</b> Create numbers from strings</a></li>
<li class="chapter" data-level="4.7" data-path="data-manipulation.html"><a href="data-manipulation.html#change-case"><i class="fa fa-check"></i><b>4.7</b> Change case</a></li>
<li class="chapter" data-level="4.8" data-path="data-manipulation.html"><a href="data-manipulation.html#drop-duplicate-rows"><i class="fa fa-check"></i><b>4.8</b> Drop duplicate rows</a></li>
<li class="chapter" data-level="4.9" data-path="data-manipulation.html"><a href="data-manipulation.html#randomly-sample-rows"><i class="fa fa-check"></i><b>4.9</b> Randomly sample rows</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html"><i class="fa fa-check"></i><b>5</b> Combine, Reshape and Merge</a>
<ul>
<li class="chapter" data-level="5.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-rows"><i class="fa fa-check"></i><b>5.1</b> Combine rows</a></li>
<li class="chapter" data-level="5.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#combine-columns"><i class="fa fa-check"></i><b>5.2</b> Combine columns</a></li>
<li class="chapter" data-level="5.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#reshaping-data"><i class="fa fa-check"></i><b>5.3</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#wide-to-long"><i class="fa fa-check"></i><b>5.3.1</b> Wide to long</a></li>
<li class="chapter" data-level="5.3.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#long-to-wide"><i class="fa fa-check"></i><b>5.3.2</b> Long to wide</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#mergejoin"><i class="fa fa-check"></i><b>5.4</b> Merge/Join</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#left-join"><i class="fa fa-check"></i><b>5.4.1</b> Left Join</a></li>
<li class="chapter" data-level="5.4.2" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#right-join"><i class="fa fa-check"></i><b>5.4.2</b> Right Join</a></li>
<li class="chapter" data-level="5.4.3" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#inner-join"><i class="fa fa-check"></i><b>5.4.3</b> Inner Join</a></li>
<li class="chapter" data-level="5.4.4" data-path="combine-reshape-and-merge.html"><a href="combine-reshape-and-merge.html#outer-join"><i class="fa fa-check"></i><b>5.4.4</b> Outer Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html"><i class="fa fa-check"></i><b>6</b> Aggregation and Group Operations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#cross-tabulation"><i class="fa fa-check"></i><b>6.1</b> Cross tabulation</a></li>
<li class="chapter" data-level="6.2" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#group-summaries"><i class="fa fa-check"></i><b>6.2</b> Group summaries</a></li>
<li class="chapter" data-level="6.3" data-path="aggregation-and-group-operations.html"><a href="aggregation-and-group-operations.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.3</b> Centering and Scaling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html"><i class="fa fa-check"></i><b>7</b> Basic Plotting and Visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#histograms"><i class="fa fa-check"></i><b>7.1</b> Histograms</a></li>
<li class="chapter" data-level="7.2" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#barplots"><i class="fa fa-check"></i><b>7.2</b> Barplots</a></li>
<li class="chapter" data-level="7.3" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#scatterplot"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a></li>
<li class="chapter" data-level="7.4" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#stripcharts"><i class="fa fa-check"></i><b>7.4</b> Stripcharts</a></li>
<li class="chapter" data-level="7.5" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#boxplots"><i class="fa fa-check"></i><b>7.5</b> Boxplots</a></li>
<li class="chapter" data-level="7.6" data-path="basic-plotting-and-visualization.html"><a href="basic-plotting-and-visualization.html#conditional-or-faceted-plots"><i class="fa fa-check"></i><b>7.6</b> Conditional or Faceted plots</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistical-inference-and-modeling.html"><a href="statistical-inference-and-modeling.html"><i class="fa fa-check"></i><b>8</b> Statistical Inference and Modeling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="statistical-inference-and-modeling.html"><a href="statistical-inference-and-modeling.html#comparing-group-means"><i class="fa fa-check"></i><b>8.1</b> Comparing group means</a></li>
<li class="chapter" data-level="8.2" data-path="statistical-inference-and-modeling.html"><a href="statistical-inference-and-modeling.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.3" data-path="statistical-inference-and-modeling.html"><a href="statistical-inference-and-modeling.html#multiple-regression"><i class="fa fa-check"></i><b>8.3</b> Multiple regression</a></li>
<li class="chapter" data-level="8.4" data-path="statistical-inference-and-modeling.html"><a href="statistical-inference-and-modeling.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="combine-reshape-and-merge" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Combine, Reshape and Merge</h1>
<p>This chapter looks at various strategies for combining, reshaping, and merging data.</p>
<div id="combine-rows" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Combine rows</h2>
<p>Combining rows may be thought of as “stacking” rectangular data structures.</p>
<div id="python-24" class="section level4 unnumbered">
<h4>Python</h4>
</div>
<div id="r-24" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>rbind()</code> function “binds” rows. It takes two or more objects. To row bind data frames the column names must match, otherwise an error is returned. If columns being stacked have differing variable types, the values will be coerced according to <code>logical</code> &lt; <code>integer</code> &lt; <code>double</code> &lt; <code>complex</code> &lt; <code>character</code>. (E.g., if you stack a set of rows with type <code>logical</code> in column <em>J</em> on a set of rows with type <code>character</code> in column <em>J</em>, the output will have column <em>J</em> as type <code>character</code>.)</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="combine-reshape-and-merge.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb103-2"><a href="combine-reshape-and-merge.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">y =</span> letters[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb103-3"><a href="combine-reshape-and-merge.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">rbind</span>(d1, d2)</span>
<span id="cb103-4"><a href="combine-reshape-and-merge.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  x y</span>
<span id="cb103-5"><a href="combine-reshape-and-merge.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">4</span> a</span>
<span id="cb103-6"><a href="combine-reshape-and-merge.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">5</span> b</span>
<span id="cb103-7"><a href="combine-reshape-and-merge.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">6</span> c</span>
<span id="cb103-8"><a href="combine-reshape-and-merge.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">3</span> d</span>
<span id="cb103-9"><a href="combine-reshape-and-merge.html#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">2</span> e</span>
<span id="cb103-10"><a href="combine-reshape-and-merge.html#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="dv">1</span> f</span></code></pre></div>
<p>See also the <code>bind_rows()</code> function in the <strong>dplyr</strong> package.</p>
</div>
</div>
<div id="combine-columns" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Combine columns</h2>
<p>Combining columns may be thought of as setting rectangular data structures next to each other.</p>
<div id="python-25" class="section level4 unnumbered">
<h4>Python</h4>
</div>
<div id="r-25" class="section level4 unnumbered">
<h4>R</h4>
<p>The <code>cbind()</code> function “binds” columns. It takes two or more objects. To column bind data frames, the number of rows must match; otherwise, the object with fewer rows will have rows “recycled” (if possible) or an error will be returned.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="combine-reshape-and-merge.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb104-2"><a href="combine-reshape-and-merge.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">34</span>,<span class="dv">45</span>,<span class="dv">44</span>))</span>
<span id="cb104-3"><a href="combine-reshape-and-merge.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">cbind</span>(d1, d2)</span>
<span id="cb104-4"><a href="combine-reshape-and-merge.html#cb104-4" aria-hidden="true" tabindex="-1"></a>   x y  x</span>
<span id="cb104-5"><a href="combine-reshape-and-merge.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">10</span> a <span class="dv">23</span></span>
<span id="cb104-6"><a href="combine-reshape-and-merge.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">11</span> b <span class="dv">34</span></span>
<span id="cb104-7"><a href="combine-reshape-and-merge.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">12</span> c <span class="dv">45</span></span>
<span id="cb104-8"><a href="combine-reshape-and-merge.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">13</span> d <span class="dv">44</span></span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="combine-reshape-and-merge.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># example of recycled rows (d1 is repeated twice)</span></span>
<span id="cb105-2"><a href="combine-reshape-and-merge.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">y =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb105-3"><a href="combine-reshape-and-merge.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">34</span>,<span class="dv">45</span>,<span class="dv">44</span>,<span class="dv">99</span>,<span class="dv">99</span>,<span class="dv">99</span>,<span class="dv">99</span>))</span>
<span id="cb105-4"><a href="combine-reshape-and-merge.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">cbind</span>(d1, d2)</span>
<span id="cb105-5"><a href="combine-reshape-and-merge.html#cb105-5" aria-hidden="true" tabindex="-1"></a>   x y  x</span>
<span id="cb105-6"><a href="combine-reshape-and-merge.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">10</span> a <span class="dv">23</span></span>
<span id="cb105-7"><a href="combine-reshape-and-merge.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">11</span> b <span class="dv">34</span></span>
<span id="cb105-8"><a href="combine-reshape-and-merge.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">12</span> c <span class="dv">45</span></span>
<span id="cb105-9"><a href="combine-reshape-and-merge.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">13</span> d <span class="dv">44</span></span>
<span id="cb105-10"><a href="combine-reshape-and-merge.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">10</span> a <span class="dv">99</span></span>
<span id="cb105-11"><a href="combine-reshape-and-merge.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="dv">11</span> b <span class="dv">99</span></span>
<span id="cb105-12"><a href="combine-reshape-and-merge.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="dv">12</span> c <span class="dv">99</span></span>
<span id="cb105-13"><a href="combine-reshape-and-merge.html#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">13</span> d <span class="dv">99</span></span></code></pre></div>
<p>See also the <code>bind_cols()</code> function in the <strong>dplyr</strong> package.</p>
</div>
</div>
<div id="reshaping-data" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Reshaping data</h2>
<p>The next two sections discuss how to reshape data from wide to long and from long to wide. “Wide” data are structured such that multiple values associated with a given unit (e.g., a person, a cell culture, etc.) are placed in the same row:</p>
<pre><code>   name time_1_score time_2_score
1 larry            3            0
2   moe            6            3
3 curly            2            1</code></pre>
<p><em>Long</em> data, conversely, are structured such that all values are contained in one column, with another column identifying what value is given in any particular row (“time 1,” “time 2,” etc.):</p>
<pre><code>     id time score
1 larry    1     3
2 larry    2     0
3   moe    1     6
4   moe    2     3
5 curly    1     2
6 curly    2     1</code></pre>
<p>Shifting between these two data formats is often necessary for implementing certain statistical techniques or representing data with particular visualizations.</p>
<div id="wide-to-long" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Wide to long</h3>
<div id="python-26" class="section level4 unnumbered">
<h4>Python</h4>
</div>
<div id="r-26" class="section level4 unnumbered">
<h4>R</h4>
<p>In base R, the <code>reshape()</code> function can take data from wide to long or long to wide. The <strong>tidyverse</strong> also provides reshaping functions: <code>pivot_longer()</code> and <code>pivot_wider()</code>. The <strong>tidyverse</strong> functions have a degree of intuitiveness and usability that may make them the go-to reshaping tools for many R users. We give examples below using both base R and <strong>tidyverse</strong>.</p>
<p>Say we begin with a wide data frame, <code>df_wide</code>, that looks like this:</p>
<pre><code>  id sex wk1 wk2 wk3
1  1   m  16   7  15
2  2   m  12  19  10
3  3   f   8  15   7</code></pre>
<p>To lengthen a data frame using <code>reshape()</code>, a user provides arguments specifying the columns that identify values’ origins (person, cell culture, etc.), the columns containing values to be lengthened, and the desired names for output columns in long data:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="combine-reshape-and-merge.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_long <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df_wide,</span>
<span id="cb109-2"><a href="combine-reshape-and-merge.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>,</span>
<span id="cb109-3"><a href="combine-reshape-and-merge.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>), <span class="co"># column(s) that uniquely identifies/y each row</span></span>
<span id="cb109-4"><a href="combine-reshape-and-merge.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">&#39;wk1&#39;</span>, <span class="st">&#39;wk2&#39;</span>, <span class="st">&#39;wk3&#39;</span>), <span class="co"># variables that contain the values to be lengthened</span></span>
<span id="cb109-5"><a href="combine-reshape-and-merge.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">v.names =</span> <span class="st">&#39;val&#39;</span>, <span class="co"># desired name of column in long data that will contain values</span></span>
<span id="cb109-6"><a href="combine-reshape-and-merge.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                         <span class="at">timevar =</span> <span class="st">&#39;week&#39;</span>) <span class="co"># desired name of column in long data that will identify each value&#39;s context</span></span>
<span id="cb109-7"><a href="combine-reshape-and-merge.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_long</span>
<span id="cb109-8"><a href="combine-reshape-and-merge.html#cb109-8" aria-hidden="true" tabindex="-1"></a>      id sex week val</span>
<span id="cb109-9"><a href="combine-reshape-and-merge.html#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.1</span>  <span class="dv">1</span>   m    <span class="dv">1</span>  <span class="dv">16</span></span>
<span id="cb109-10"><a href="combine-reshape-and-merge.html#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.1</span>  <span class="dv">2</span>   m    <span class="dv">1</span>  <span class="dv">12</span></span>
<span id="cb109-11"><a href="combine-reshape-and-merge.html#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.1</span>  <span class="dv">3</span>   f    <span class="dv">1</span>   <span class="dv">8</span></span>
<span id="cb109-12"><a href="combine-reshape-and-merge.html#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.2</span>  <span class="dv">1</span>   m    <span class="dv">2</span>   <span class="dv">7</span></span>
<span id="cb109-13"><a href="combine-reshape-and-merge.html#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.2</span>  <span class="dv">2</span>   m    <span class="dv">2</span>  <span class="dv">19</span></span>
<span id="cb109-14"><a href="combine-reshape-and-merge.html#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.2</span>  <span class="dv">3</span>   f    <span class="dv">2</span>  <span class="dv">15</span></span>
<span id="cb109-15"><a href="combine-reshape-and-merge.html#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.3</span>  <span class="dv">1</span>   m    <span class="dv">3</span>  <span class="dv">15</span></span>
<span id="cb109-16"><a href="combine-reshape-and-merge.html#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.3</span>  <span class="dv">2</span>   m    <span class="dv">3</span>  <span class="dv">10</span></span>
<span id="cb109-17"><a href="combine-reshape-and-merge.html#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.3</span>  <span class="dv">3</span>   f    <span class="dv">3</span>   <span class="dv">7</span></span></code></pre></div>
<p>The <strong>tidyverse</strong> function for taking data from wide to long is <code>pivot_longer()</code>. To lengthen <code>df_wide</code> using <code>pivot_longer()</code>, a user would write:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="combine-reshape-and-merge.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tidyverse)</span>
<span id="cb110-2"><a href="combine-reshape-and-merge.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_long_PL <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df_wide,</span>
<span id="cb110-3"><a href="combine-reshape-and-merge.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                              <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>), <span class="co"># columns that contain the values to be lengthened (can use -c() to negate variables)</span></span>
<span id="cb110-4"><a href="combine-reshape-and-merge.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                              <span class="at">names_to =</span> <span class="st">&#39;week&#39;</span>, <span class="co"># desired name of column in long data that will identify each value&#39;s context</span></span>
<span id="cb110-5"><a href="combine-reshape-and-merge.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                              <span class="at">values_to =</span> <span class="st">&#39;val&#39;</span>) <span class="co"># desired name of column in long data that will contain values</span></span>
<span id="cb110-6"><a href="combine-reshape-and-merge.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_long_PL</span>
<span id="cb110-7"><a href="combine-reshape-and-merge.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 9 × 4</span></span>
<span id="cb110-8"><a href="combine-reshape-and-merge.html#cb110-8" aria-hidden="true" tabindex="-1"></a>     id sex   week    val</span>
<span id="cb110-9"><a href="combine-reshape-and-merge.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb110-10"><a href="combine-reshape-and-merge.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">1</span> m     wk1      <span class="dv">16</span></span>
<span id="cb110-11"><a href="combine-reshape-and-merge.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">1</span> m     wk2       <span class="dv">7</span></span>
<span id="cb110-12"><a href="combine-reshape-and-merge.html#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">1</span> m     wk3      <span class="dv">15</span></span>
<span id="cb110-13"><a href="combine-reshape-and-merge.html#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">2</span> m     wk1      <span class="dv">12</span></span>
<span id="cb110-14"><a href="combine-reshape-and-merge.html#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>     <span class="dv">2</span> m     wk2      <span class="dv">19</span></span>
<span id="cb110-15"><a href="combine-reshape-and-merge.html#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>     <span class="dv">2</span> m     wk3      <span class="dv">10</span></span>
<span id="cb110-16"><a href="combine-reshape-and-merge.html#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>     <span class="dv">3</span> f     wk1       <span class="dv">8</span></span>
<span id="cb110-17"><a href="combine-reshape-and-merge.html#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>     <span class="dv">3</span> f     wk2      <span class="dv">15</span></span>
<span id="cb110-18"><a href="combine-reshape-and-merge.html#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>     <span class="dv">3</span> f     wk3       <span class="dv">7</span></span></code></pre></div>
<p><code>pivot_longer()</code> is particularly useful (a) when dealing with wide data that contain multiple sets of repeated measures in each row that need to be lengthened separately (e.g., two monthly height measurements and two monthly weight measurements for each person) and (b) when column names and/or column values in the long data need to be extracted from column names of the wide data using regular expressions.</p>
<p>For example, say we begin with a wide data frame, <code>animals_wide</code>, in which every row contains two values for each of two different measures:</p>
<pre><code>     animal lives_in_water jan_playfulness feb_playfulness jan_excitement feb_excitement
1   dolphin           TRUE             6.0             5.5            7.0            7.0
2 porcupine          FALSE             3.5             4.5            3.5            3.5
3  capybara          FALSE             4.0             5.0            4.0            4.0</code></pre>
<p><code>pivot_longer()</code> can be used to convert this data frame to a long format where there is one column for each of the measures, playfulness and excitement:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="combine-reshape-and-merge.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_long_1 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(animals_wide,</span>
<span id="cb112-2"><a href="combine-reshape-and-merge.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                              <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb112-3"><a href="combine-reshape-and-merge.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                              <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;month&#39;</span>, <span class="st">&#39;.value&#39;</span>), <span class="co"># &quot;.value&quot; is placeholder for strings that will be extracted from wide column names </span></span>
<span id="cb112-4"><a href="combine-reshape-and-merge.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                              <span class="at">names_pattern =</span> <span class="st">&#39;(.+)_(.+)&#39;</span>) <span class="co"># specify structure of wide column names with regex from which long column names will be extracted</span></span>
<span id="cb112-5"><a href="combine-reshape-and-merge.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_long_1</span>
<span id="cb112-6"><a href="combine-reshape-and-merge.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6 × 5</span></span>
<span id="cb112-7"><a href="combine-reshape-and-merge.html#cb112-7" aria-hidden="true" tabindex="-1"></a>  animal    lives_in_water month playfulness excitement</span>
<span id="cb112-8"><a href="combine-reshape-and-merge.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>          <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb112-9"><a href="combine-reshape-and-merge.html#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> dolphin   <span class="cn">TRUE</span>           jan           <span class="dv">6</span>          <span class="dv">7</span>  </span>
<span id="cb112-10"><a href="combine-reshape-and-merge.html#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> dolphin   <span class="cn">TRUE</span>           feb           <span class="fl">5.5</span>        <span class="dv">7</span>  </span>
<span id="cb112-11"><a href="combine-reshape-and-merge.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> porcupine <span class="cn">FALSE</span>          jan           <span class="fl">3.5</span>        <span class="fl">3.5</span></span>
<span id="cb112-12"><a href="combine-reshape-and-merge.html#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> porcupine <span class="cn">FALSE</span>          feb           <span class="fl">4.5</span>        <span class="fl">3.5</span></span>
<span id="cb112-13"><a href="combine-reshape-and-merge.html#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> capybara  <span class="cn">FALSE</span>          jan           <span class="dv">4</span>          <span class="dv">4</span>  </span>
<span id="cb112-14"><a href="combine-reshape-and-merge.html#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> capybara  <span class="cn">FALSE</span>          feb           <span class="dv">5</span>          <span class="dv">4</span>  </span></code></pre></div>
<p>Alternatively, <code>pivot_longer()</code> can be used to convert this data frame to a long format where there is one column containing all the playfulness and excitement values:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="combine-reshape-and-merge.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_long_2 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(animals_wide,</span>
<span id="cb113-2"><a href="combine-reshape-and-merge.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb113-3"><a href="combine-reshape-and-merge.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;month&#39;</span>, <span class="st">&#39;measure&#39;</span>),</span>
<span id="cb113-4"><a href="combine-reshape-and-merge.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">names_pattern =</span> <span class="st">&#39;(.+)_(.+)&#39;</span>,</span>
<span id="cb113-5"><a href="combine-reshape-and-merge.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                                <span class="at">values_to =</span> <span class="st">&#39;val&#39;</span>)</span>
<span id="cb113-6"><a href="combine-reshape-and-merge.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_long_2</span>
<span id="cb113-7"><a href="combine-reshape-and-merge.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 12 × 5</span></span>
<span id="cb113-8"><a href="combine-reshape-and-merge.html#cb113-8" aria-hidden="true" tabindex="-1"></a>   animal    lives_in_water month measure       val</span>
<span id="cb113-9"><a href="combine-reshape-and-merge.html#cb113-9" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>          <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb113-10"><a href="combine-reshape-and-merge.html#cb113-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> dolphin   <span class="cn">TRUE</span>           jan   playfulness   <span class="dv">6</span>  </span>
<span id="cb113-11"><a href="combine-reshape-and-merge.html#cb113-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> dolphin   <span class="cn">TRUE</span>           feb   playfulness   <span class="fl">5.5</span></span>
<span id="cb113-12"><a href="combine-reshape-and-merge.html#cb113-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> dolphin   <span class="cn">TRUE</span>           jan   excitement    <span class="dv">7</span>  </span>
<span id="cb113-13"><a href="combine-reshape-and-merge.html#cb113-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> dolphin   <span class="cn">TRUE</span>           feb   excitement    <span class="dv">7</span>  </span>
<span id="cb113-14"><a href="combine-reshape-and-merge.html#cb113-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> porcupine <span class="cn">FALSE</span>          jan   playfulness   <span class="fl">3.5</span></span>
<span id="cb113-15"><a href="combine-reshape-and-merge.html#cb113-15" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> porcupine <span class="cn">FALSE</span>          feb   playfulness   <span class="fl">4.5</span></span>
<span id="cb113-16"><a href="combine-reshape-and-merge.html#cb113-16" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> porcupine <span class="cn">FALSE</span>          jan   excitement    <span class="fl">3.5</span></span>
<span id="cb113-17"><a href="combine-reshape-and-merge.html#cb113-17" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> porcupine <span class="cn">FALSE</span>          feb   excitement    <span class="fl">3.5</span></span>
<span id="cb113-18"><a href="combine-reshape-and-merge.html#cb113-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> capybara  <span class="cn">FALSE</span>          jan   playfulness   <span class="dv">4</span>  </span>
<span id="cb113-19"><a href="combine-reshape-and-merge.html#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> capybara  <span class="cn">FALSE</span>          feb   playfulness   <span class="dv">5</span>  </span>
<span id="cb113-20"><a href="combine-reshape-and-merge.html#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> capybara  <span class="cn">FALSE</span>          jan   excitement    <span class="dv">4</span>  </span>
<span id="cb113-21"><a href="combine-reshape-and-merge.html#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> capybara  <span class="cn">FALSE</span>          feb   excitement    <span class="dv">4</span>  </span></code></pre></div>
</div>
</div>
<div id="long-to-wide" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Long to wide</h3>
<div id="python-27" class="section level4 unnumbered">
<h4>Python</h4>
</div>
<div id="r-27" class="section level4 unnumbered">
<h4>R</h4>
<p>Say we begin with a long data frame, <code>df_long</code>, that looks like this:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="combine-reshape-and-merge.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_long</span>
<span id="cb114-2"><a href="combine-reshape-and-merge.html#cb114-2" aria-hidden="true" tabindex="-1"></a>      id sex week val</span>
<span id="cb114-3"><a href="combine-reshape-and-merge.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.1</span>  <span class="dv">1</span>   m    <span class="dv">1</span>  <span class="dv">16</span></span>
<span id="cb114-4"><a href="combine-reshape-and-merge.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.1</span>  <span class="dv">2</span>   m    <span class="dv">1</span>  <span class="dv">12</span></span>
<span id="cb114-5"><a href="combine-reshape-and-merge.html#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.1</span>  <span class="dv">3</span>   f    <span class="dv">1</span>   <span class="dv">8</span></span>
<span id="cb114-6"><a href="combine-reshape-and-merge.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.2</span>  <span class="dv">1</span>   m    <span class="dv">2</span>   <span class="dv">7</span></span>
<span id="cb114-7"><a href="combine-reshape-and-merge.html#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.2</span>  <span class="dv">2</span>   m    <span class="dv">2</span>  <span class="dv">19</span></span>
<span id="cb114-8"><a href="combine-reshape-and-merge.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.2</span>  <span class="dv">3</span>   f    <span class="dv">2</span>  <span class="dv">15</span></span>
<span id="cb114-9"><a href="combine-reshape-and-merge.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.3</span>  <span class="dv">1</span>   m    <span class="dv">3</span>  <span class="dv">15</span></span>
<span id="cb114-10"><a href="combine-reshape-and-merge.html#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.3</span>  <span class="dv">2</span>   m    <span class="dv">3</span>  <span class="dv">10</span></span>
<span id="cb114-11"><a href="combine-reshape-and-merge.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.3</span>  <span class="dv">3</span>   f    <span class="dv">3</span>   <span class="dv">7</span></span></code></pre></div>
<p>To take data from long to wide with base R’s <code>reshape()</code>, a user would write:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="combine-reshape-and-merge.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_wide <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df_long,</span>
<span id="cb115-2"><a href="combine-reshape-and-merge.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">direction =</span> <span class="st">&#39;wide&#39;</span>,</span>
<span id="cb115-3"><a href="combine-reshape-and-merge.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">idvar =</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>), <span class="co"># column(s) that determine which rows should be grouped together in the wide data</span></span>
<span id="cb115-4"><a href="combine-reshape-and-merge.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">v.names =</span> <span class="st">&#39;val&#39;</span>, <span class="co"># column containing values to widen</span></span>
<span id="cb115-5"><a href="combine-reshape-and-merge.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">timevar =</span> <span class="st">&#39;week&#39;</span>, <span class="co"># column from which resulting wide column names are pulled</span></span>
<span id="cb115-6"><a href="combine-reshape-and-merge.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                    <span class="at">sep =</span> <span class="st">&#39;_&#39;</span>) <span class="co"># the `sep` argument allows a user to specify how the contents of `timevar` should be joined with the name of the `v.names` variable to form wide column names</span></span>
<span id="cb115-7"><a href="combine-reshape-and-merge.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_wide</span>
<span id="cb115-8"><a href="combine-reshape-and-merge.html#cb115-8" aria-hidden="true" tabindex="-1"></a>      id sex val_1 val_2 val_3</span>
<span id="cb115-9"><a href="combine-reshape-and-merge.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span>m<span class="fl">.1</span>  <span class="dv">1</span>   m    <span class="dv">16</span>     <span class="dv">7</span>    <span class="dv">15</span></span>
<span id="cb115-10"><a href="combine-reshape-and-merge.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span>m<span class="fl">.1</span>  <span class="dv">2</span>   m    <span class="dv">12</span>    <span class="dv">19</span>    <span class="dv">10</span></span>
<span id="cb115-11"><a href="combine-reshape-and-merge.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span>f<span class="fl">.1</span>  <span class="dv">3</span>   f     <span class="dv">8</span>    <span class="dv">15</span>     <span class="dv">7</span></span></code></pre></div>
<p>The <strong>tidyverse</strong> function for taking data from long to wide is <code>pivot_wider()</code>. To widen <code>df_long</code> using <code>pivot_longer()</code>, a user would write:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="combine-reshape-and-merge.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">library</span>(tidyverse)</span>
<span id="cb116-2"><a href="combine-reshape-and-merge.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_wide_PW <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(df_long,</span>
<span id="cb116-3"><a href="combine-reshape-and-merge.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                           <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;sex&#39;</span>),</span>
<span id="cb116-4"><a href="combine-reshape-and-merge.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                           <span class="at">values_from =</span> <span class="st">&#39;val&#39;</span>,</span>
<span id="cb116-5"><a href="combine-reshape-and-merge.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                           <span class="at">names_from =</span> <span class="st">&#39;week&#39;</span>,</span>
<span id="cb116-6"><a href="combine-reshape-and-merge.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                           <span class="at">names_prefix =</span> <span class="st">&#39;week_&#39;</span>) <span class="co"># `names_prefix` specifies a string to paste in front of the contents of &#39;week&#39; in the resulting wide column names</span></span>
<span id="cb116-7"><a href="combine-reshape-and-merge.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> df_wide_PW</span>
<span id="cb116-8"><a href="combine-reshape-and-merge.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 × 5</span></span>
<span id="cb116-9"><a href="combine-reshape-and-merge.html#cb116-9" aria-hidden="true" tabindex="-1"></a>     id sex   week_1 week_2 week_3</span>
<span id="cb116-10"><a href="combine-reshape-and-merge.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span>  <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb116-11"><a href="combine-reshape-and-merge.html#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>     <span class="dv">1</span> m         <span class="dv">16</span>      <span class="dv">7</span>     <span class="dv">15</span></span>
<span id="cb116-12"><a href="combine-reshape-and-merge.html#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">2</span> m         <span class="dv">12</span>     <span class="dv">19</span>     <span class="dv">10</span></span>
<span id="cb116-13"><a href="combine-reshape-and-merge.html#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="dv">3</span> f          <span class="dv">8</span>     <span class="dv">15</span>      <span class="dv">7</span></span></code></pre></div>
<p><code>pivot_wider()</code> offers a lot of usability when widening relatively complicated long data structures. For example, say we want to widen both of the long versions of the animals data frame created above.</p>
<p>To widen the version of the long data that has a column for each of the measures (playfulness and excitement):</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="combine-reshape-and-merge.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_long_1</span>
<span id="cb117-2"><a href="combine-reshape-and-merge.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 6 × 5</span></span>
<span id="cb117-3"><a href="combine-reshape-and-merge.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  animal    lives_in_water month playfulness excitement</span>
<span id="cb117-4"><a href="combine-reshape-and-merge.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>          <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>      <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb117-5"><a href="combine-reshape-and-merge.html#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> dolphin   <span class="cn">TRUE</span>           jan           <span class="dv">6</span>          <span class="dv">7</span>  </span>
<span id="cb117-6"><a href="combine-reshape-and-merge.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> dolphin   <span class="cn">TRUE</span>           feb           <span class="fl">5.5</span>        <span class="dv">7</span>  </span>
<span id="cb117-7"><a href="combine-reshape-and-merge.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> porcupine <span class="cn">FALSE</span>          jan           <span class="fl">3.5</span>        <span class="fl">3.5</span></span>
<span id="cb117-8"><a href="combine-reshape-and-merge.html#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> porcupine <span class="cn">FALSE</span>          feb           <span class="fl">4.5</span>        <span class="fl">3.5</span></span>
<span id="cb117-9"><a href="combine-reshape-and-merge.html#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> capybara  <span class="cn">FALSE</span>          jan           <span class="dv">4</span>          <span class="dv">4</span>  </span>
<span id="cb117-10"><a href="combine-reshape-and-merge.html#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> capybara  <span class="cn">FALSE</span>          feb           <span class="dv">5</span>          <span class="dv">4</span>  </span>
<span id="cb117-11"><a href="combine-reshape-and-merge.html#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(animals_long_1,</span>
<span id="cb117-12"><a href="combine-reshape-and-merge.html#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb117-13"><a href="combine-reshape-and-merge.html#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;playfulness&#39;</span>, <span class="st">&#39;excitement&#39;</span>),</span>
<span id="cb117-14"><a href="combine-reshape-and-merge.html#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">names_from =</span> <span class="st">&#39;month&#39;</span>,</span>
<span id="cb117-15"><a href="combine-reshape-and-merge.html#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">names_glue =</span> <span class="st">&#39;{month}_{.value}&#39;</span>) <span class="co"># `names_glue` allow for customization of wide column names based</span></span>
<span id="cb117-16"><a href="combine-reshape-and-merge.html#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_wide</span>
<span id="cb117-17"><a href="combine-reshape-and-merge.html#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 × 6</span></span>
<span id="cb117-18"><a href="combine-reshape-and-merge.html#cb117-18" aria-hidden="true" tabindex="-1"></a>  animal    lives_in_water jan_playfulness feb_playfulness jan_excitement feb_excitement</span>
<span id="cb117-19"><a href="combine-reshape-and-merge.html#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>                    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>           <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb117-20"><a href="combine-reshape-and-merge.html#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> dolphin   <span class="cn">TRUE</span>                       <span class="dv">6</span>               <span class="fl">5.5</span>            <span class="dv">7</span>              <span class="dv">7</span>  </span>
<span id="cb117-21"><a href="combine-reshape-and-merge.html#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> porcupine <span class="cn">FALSE</span>                      <span class="fl">3.5</span>             <span class="fl">4.5</span>            <span class="fl">3.5</span>            <span class="fl">3.5</span></span>
<span id="cb117-22"><a href="combine-reshape-and-merge.html#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> capybara  <span class="cn">FALSE</span>                      <span class="dv">4</span>               <span class="dv">5</span>              <span class="dv">4</span>              <span class="dv">4</span>  </span></code></pre></div>
<p>To widen the version of the long data that has one column containing all the values of playfulness and excitement together:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="combine-reshape-and-merge.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_long_2</span>
<span id="cb118-2"><a href="combine-reshape-and-merge.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 12 × 5</span></span>
<span id="cb118-3"><a href="combine-reshape-and-merge.html#cb118-3" aria-hidden="true" tabindex="-1"></a>   animal    lives_in_water month measure       val</span>
<span id="cb118-4"><a href="combine-reshape-and-merge.html#cb118-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>          <span class="er">&lt;</span>chr<span class="sc">&gt;</span> <span class="er">&lt;</span>chr<span class="sc">&gt;</span>       <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb118-5"><a href="combine-reshape-and-merge.html#cb118-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span> dolphin   <span class="cn">TRUE</span>           jan   playfulness   <span class="dv">6</span>  </span>
<span id="cb118-6"><a href="combine-reshape-and-merge.html#cb118-6" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span> dolphin   <span class="cn">TRUE</span>           feb   playfulness   <span class="fl">5.5</span></span>
<span id="cb118-7"><a href="combine-reshape-and-merge.html#cb118-7" aria-hidden="true" tabindex="-1"></a> <span class="dv">3</span> dolphin   <span class="cn">TRUE</span>           jan   excitement    <span class="dv">7</span>  </span>
<span id="cb118-8"><a href="combine-reshape-and-merge.html#cb118-8" aria-hidden="true" tabindex="-1"></a> <span class="dv">4</span> dolphin   <span class="cn">TRUE</span>           feb   excitement    <span class="dv">7</span>  </span>
<span id="cb118-9"><a href="combine-reshape-and-merge.html#cb118-9" aria-hidden="true" tabindex="-1"></a> <span class="dv">5</span> porcupine <span class="cn">FALSE</span>          jan   playfulness   <span class="fl">3.5</span></span>
<span id="cb118-10"><a href="combine-reshape-and-merge.html#cb118-10" aria-hidden="true" tabindex="-1"></a> <span class="dv">6</span> porcupine <span class="cn">FALSE</span>          feb   playfulness   <span class="fl">4.5</span></span>
<span id="cb118-11"><a href="combine-reshape-and-merge.html#cb118-11" aria-hidden="true" tabindex="-1"></a> <span class="dv">7</span> porcupine <span class="cn">FALSE</span>          jan   excitement    <span class="fl">3.5</span></span>
<span id="cb118-12"><a href="combine-reshape-and-merge.html#cb118-12" aria-hidden="true" tabindex="-1"></a> <span class="dv">8</span> porcupine <span class="cn">FALSE</span>          feb   excitement    <span class="fl">3.5</span></span>
<span id="cb118-13"><a href="combine-reshape-and-merge.html#cb118-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">9</span> capybara  <span class="cn">FALSE</span>          jan   playfulness   <span class="dv">4</span>  </span>
<span id="cb118-14"><a href="combine-reshape-and-merge.html#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> capybara  <span class="cn">FALSE</span>          feb   playfulness   <span class="dv">5</span>  </span>
<span id="cb118-15"><a href="combine-reshape-and-merge.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> capybara  <span class="cn">FALSE</span>          jan   excitement    <span class="dv">4</span>  </span>
<span id="cb118-16"><a href="combine-reshape-and-merge.html#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> capybara  <span class="cn">FALSE</span>          feb   excitement    <span class="dv">4</span>  </span>
<span id="cb118-17"><a href="combine-reshape-and-merge.html#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_wide <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(animals_long_2,</span>
<span id="cb118-18"><a href="combine-reshape-and-merge.html#cb118-18" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&#39;animal&#39;</span>, <span class="st">&#39;lives_in_water&#39;</span>),</span>
<span id="cb118-19"><a href="combine-reshape-and-merge.html#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">values_from =</span> <span class="st">&#39;val&#39;</span>,</span>
<span id="cb118-20"><a href="combine-reshape-and-merge.html#cb118-20" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">names_from =</span> <span class="fu">c</span>(<span class="st">&#39;month&#39;</span>, <span class="st">&#39;measure&#39;</span>),</span>
<span id="cb118-21"><a href="combine-reshape-and-merge.html#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span>                             <span class="at">names_sep =</span> <span class="st">&#39;_&#39;</span>)</span>
<span id="cb118-22"><a href="combine-reshape-and-merge.html#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> animals_wide</span>
<span id="cb118-23"><a href="combine-reshape-and-merge.html#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="co"># A tibble: 3 × 6</span></span>
<span id="cb118-24"><a href="combine-reshape-and-merge.html#cb118-24" aria-hidden="true" tabindex="-1"></a>  animal    lives_in_water jan_playfulness feb_playfulness jan_excitement feb_excitement</span>
<span id="cb118-25"><a href="combine-reshape-and-merge.html#cb118-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>     <span class="er">&lt;</span>lgl<span class="sc">&gt;</span>                    <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>           <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>          <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb118-26"><a href="combine-reshape-and-merge.html#cb118-26" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> dolphin   <span class="cn">TRUE</span>                       <span class="dv">6</span>               <span class="fl">5.5</span>            <span class="dv">7</span>              <span class="dv">7</span>  </span>
<span id="cb118-27"><a href="combine-reshape-and-merge.html#cb118-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> porcupine <span class="cn">FALSE</span>                      <span class="fl">3.5</span>             <span class="fl">4.5</span>            <span class="fl">3.5</span>            <span class="fl">3.5</span></span>
<span id="cb118-28"><a href="combine-reshape-and-merge.html#cb118-28" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> capybara  <span class="cn">FALSE</span>                      <span class="dv">4</span>               <span class="dv">5</span>              <span class="dv">4</span>              <span class="dv">4</span>  </span></code></pre></div>
</div>
</div>
</div>
<div id="mergejoin" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Merge/Join</h2>
<p>The merge/join examples below all make use of the following sample data frames:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="combine-reshape-and-merge.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># x</span></span>
<span id="cb119-2"><a href="combine-reshape-and-merge.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> x</span>
<span id="cb119-3"><a href="combine-reshape-and-merge.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  merge_var val_x</span>
<span id="cb119-4"><a href="combine-reshape-and-merge.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         a    <span class="dv">12</span></span>
<span id="cb119-5"><a href="combine-reshape-and-merge.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         b    <span class="dv">94</span></span>
<span id="cb119-6"><a href="combine-reshape-and-merge.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         c    <span class="dv">92</span></span>
<span id="cb119-7"><a href="combine-reshape-and-merge.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># y</span></span>
<span id="cb119-8"><a href="combine-reshape-and-merge.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> y</span>
<span id="cb119-9"><a href="combine-reshape-and-merge.html#cb119-9" aria-hidden="true" tabindex="-1"></a>  merge_var val_y</span>
<span id="cb119-10"><a href="combine-reshape-and-merge.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         c    <span class="dv">78</span></span>
<span id="cb119-11"><a href="combine-reshape-and-merge.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         d    <span class="dv">32</span></span>
<span id="cb119-12"><a href="combine-reshape-and-merge.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         e    <span class="dv">30</span></span></code></pre></div>
<div id="left-join" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Left Join</h3>
<p>A left join of <em>x</em> and <em>y</em> keeps all rows of <em>x</em> and merges rows of <em>y</em> into <em>x</em> where possible based on the merge criterion:</p>
<p><img src="images/left_join.png" width="621" /></p>
<div id="python-28" class="section level4 unnumbered">
<h4>Python</h4>
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="combine-reshape-and-merge.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb120-2"><a href="combine-reshape-and-merge.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;left&#39;</span>)</span>
<span id="cb120-3"><a href="combine-reshape-and-merge.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  merge_var  val_x  val_y</span>
<span id="cb120-4"><a href="combine-reshape-and-merge.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         a   <span class="fl">12.0</span>    NaN</span>
<span id="cb120-5"><a href="combine-reshape-and-merge.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         b   <span class="fl">94.0</span>    NaN</span>
<span id="cb120-6"><a href="combine-reshape-and-merge.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         c   <span class="fl">92.0</span>   <span class="fl">78.0</span></span></code></pre></div>
</div>
<div id="r-28" class="section level4 unnumbered">
<h4>R</h4>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="combine-reshape-and-merge.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># all.x = T results in a left join</span></span>
<span id="cb121-2"><a href="combine-reshape-and-merge.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>, <span class="at">all.x =</span> T)</span>
<span id="cb121-3"><a href="combine-reshape-and-merge.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  merge_var val_x val_y</span>
<span id="cb121-4"><a href="combine-reshape-and-merge.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         a    <span class="dv">12</span>    <span class="cn">NA</span></span>
<span id="cb121-5"><a href="combine-reshape-and-merge.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         b    <span class="dv">94</span>    <span class="cn">NA</span></span>
<span id="cb121-6"><a href="combine-reshape-and-merge.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         c    <span class="dv">92</span>    <span class="dv">78</span></span></code></pre></div>
</div>
</div>
<div id="right-join" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Right Join</h3>
<p>A right join of <em>x</em> and <em>y</em> keeps all rows of <em>y</em> and merges rows of <em>x</em> into <em>y</em> where possible based on the merge criterion:</p>
<p><img src="images/right_join.png" width="621" /></p>
<div id="python-29" class="section level4 unnumbered">
<h4>Python</h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="combine-reshape-and-merge.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb122-2"><a href="combine-reshape-and-merge.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;right&#39;</span>)</span>
<span id="cb122-3"><a href="combine-reshape-and-merge.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  merge_var  val_x  val_y</span>
<span id="cb122-4"><a href="combine-reshape-and-merge.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         c   <span class="fl">92.0</span>   <span class="fl">78.0</span></span>
<span id="cb122-5"><a href="combine-reshape-and-merge.html#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         d    NaN   <span class="fl">32.0</span></span>
<span id="cb122-6"><a href="combine-reshape-and-merge.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         e    NaN   <span class="fl">30.0</span></span></code></pre></div>
</div>
<div id="r-29" class="section level4 unnumbered">
<h4>R</h4>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="combine-reshape-and-merge.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># all.y = T results in a right join</span></span>
<span id="cb123-2"><a href="combine-reshape-and-merge.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>, <span class="at">all.y =</span> T)</span>
<span id="cb123-3"><a href="combine-reshape-and-merge.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  merge_var val_x val_y</span>
<span id="cb123-4"><a href="combine-reshape-and-merge.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         c    <span class="dv">92</span>    <span class="dv">78</span></span>
<span id="cb123-5"><a href="combine-reshape-and-merge.html#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         d    <span class="cn">NA</span>    <span class="dv">32</span></span>
<span id="cb123-6"><a href="combine-reshape-and-merge.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         e    <span class="cn">NA</span>    <span class="dv">30</span></span></code></pre></div>
</div>
</div>
<div id="inner-join" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Inner Join</h3>
<p>An inner join of <em>x</em> and <em>y</em> returns merged rows for which a match can be on the merge criterion <em>in both tables</em>:</p>
<p><img src="images/inner_join.png" width="621" /></p>
<div id="python-30" class="section level4 unnumbered">
<h4>Python</h4>
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="combine-reshape-and-merge.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb124-2"><a href="combine-reshape-and-merge.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;inner&#39;</span>)</span>
<span id="cb124-3"><a href="combine-reshape-and-merge.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  merge_var  val_x  val_y</span>
<span id="cb124-4"><a href="combine-reshape-and-merge.html#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         c   <span class="fl">92.0</span>   <span class="fl">78.0</span></span></code></pre></div>
</div>
<div id="r-30" class="section level4 unnumbered">
<h4>R</h4>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="combine-reshape-and-merge.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># by default, merge() executes an inner join</span></span>
<span id="cb125-2"><a href="combine-reshape-and-merge.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># (more specifically, a natural join, which is a kind of</span></span>
<span id="cb125-3"><a href="combine-reshape-and-merge.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># inner join in which the merge-criterion column is not</span></span>
<span id="cb125-4"><a href="combine-reshape-and-merge.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="co"># repeated, despite being initially present in both tables)</span></span>
<span id="cb125-5"><a href="combine-reshape-and-merge.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>)</span>
<span id="cb125-6"><a href="combine-reshape-and-merge.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  merge_var val_x val_y</span>
<span id="cb125-7"><a href="combine-reshape-and-merge.html#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         c    <span class="dv">92</span>    <span class="dv">78</span></span></code></pre></div>
</div>
</div>
<div id="outer-join" class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Outer Join</h3>
<p>An outer join of <em>x</em> and <em>y</em> keeps all rows from both tables, merging rows where possible based on the merge criterion:</p>
<p><img src="images/outer_join.png" width="621" /></p>
<div id="python-31" class="section level4 unnumbered">
<h4>Python</h4>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="combine-reshape-and-merge.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb126-2"><a href="combine-reshape-and-merge.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> pd.merge(x, y, how <span class="op">=</span> <span class="st">&#39;outer&#39;</span>)</span>
<span id="cb126-3"><a href="combine-reshape-and-merge.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  merge_var  val_x  val_y</span>
<span id="cb126-4"><a href="combine-reshape-and-merge.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         a   <span class="fl">12.0</span>    NaN</span>
<span id="cb126-5"><a href="combine-reshape-and-merge.html#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         b   <span class="fl">94.0</span>    NaN</span>
<span id="cb126-6"><a href="combine-reshape-and-merge.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         c   <span class="fl">92.0</span>   <span class="fl">78.0</span></span>
<span id="cb126-7"><a href="combine-reshape-and-merge.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         d    NaN   <span class="fl">32.0</span></span>
<span id="cb126-8"><a href="combine-reshape-and-merge.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         e    NaN   <span class="fl">30.0</span></span></code></pre></div>
</div>
<div id="r-31" class="section level4 unnumbered">
<h4>R</h4>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="combine-reshape-and-merge.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="co"># all = T (or all.x = T AND all.y = T) results in an outer join</span></span>
<span id="cb127-2"><a href="combine-reshape-and-merge.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">merge</span>(x, y, <span class="at">by =</span> <span class="st">&#39;merge_var&#39;</span>, <span class="at">all =</span> T)</span>
<span id="cb127-3"><a href="combine-reshape-and-merge.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  merge_var val_x val_y</span>
<span id="cb127-4"><a href="combine-reshape-and-merge.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         a    <span class="dv">12</span>    <span class="cn">NA</span></span>
<span id="cb127-5"><a href="combine-reshape-and-merge.html#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         b    <span class="dv">94</span>    <span class="cn">NA</span></span>
<span id="cb127-6"><a href="combine-reshape-and-merge.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         c    <span class="dv">92</span>    <span class="dv">78</span></span>
<span id="cb127-7"><a href="combine-reshape-and-merge.html#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         d    <span class="cn">NA</span>    <span class="dv">32</span></span>
<span id="cb127-8"><a href="combine-reshape-and-merge.html#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>         e    <span class="cn">NA</span>    <span class="dv">30</span></span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aggregation-and-group-operations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uvastatlab/Python_and_R/edit/main/05-reshape-merge-combine.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
