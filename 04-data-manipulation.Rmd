# Data Manipulation

```{r,echo=FALSE}
knitr::opts_chunk$set(comment = NA, prompt = TRUE, collapse = TRUE)
```

This chapter looks at various strategies for modifying and deriving variables in data. Unless otherwise stated, examples are for DataFrames (Python) and data frames (R) and use the mtcars data frame that is included with R.

```{python}
# Python
import pandas
mtcars = pandas.read_csv('data/mtcars.csv')
```


```{r}
# R
data(mtcars)
```


## Names of variables and their types

View and inspect the names of variables and their type (numeric, string, logical, etc.) This is useful to ensure that variables have the expected type. 

#### Python {-}


#### R {-}

The `str()` function in R lists the names of the variables, their type, the first few values, and the dimensions of the data frame.  

```{r}
str(mtcars)
```

To see just the names of the data frame, use the `names()` function.

```{r}
names(mtcars)
```

To see just the dimensions of the data frame, use the `dim()` function. It returns the number of rows and columns, respectively.


```{r}
dim(mtcars)
```


## Rename variables

How to rename variables or "column headers".

#### Python {-}


#### R {-}

Variable names can be changed by their index (ie, order of columns in the data frame). Below the second column is "cyl". We change the name to "cylinder".

```{r}
names(mtcars)[2]
names(mtcars)[2] <- "cylinders"
names(mtcars)
```

Variable names can also be changed by conditional match. Below we find the variable name that matches "drat" and change to "axle_ratio".

```{r}
names(mtcars)[names(mtcars) == "drat"]
names(mtcars)[names(mtcars) == "drat"] <- "axle_ratio"
names(mtcars)
```

More than one variable name can be changed using a vector of positions or matches.

```{r}
names(mtcars)[c(6,8)] <- c("weight", "engine")

# or
# names(mtcars)[names(mtcars) %in% c("wt", "vs")] <- c("weight", "engine")

names(mtcars)
```

See also the `rename()` function in the **dplyr** package. 

## Create strings from numbers

You may have data that is numeric but that needs to be treated as a string. For example, census data often codes age ranges as groups. For example:

- 1 = 0-6
- 2 = 7-12 
- 3 = 13-17

And so on. These numbers represent groups, not a count or measure of anything.

#### Python {-}


#### R {-}

The `as.character()` function takes a vector and converts it to string format.

```{r}
# create a vector of numbers
x <- c(2, 2, 3, 4, 2, 4)
x

# convert to string
xc <- as.character(x)
xc

```


The `factor()` function can also be used to convert a numeric vector into a  categorical variable. The result is not exactly a string, however. A factor is made of integers with character labels. Factors are useful for character data that have a fixed set of levels (eg, "grade 1", grade 2", etc)

```{r}
# convert to factor
xf <- factor(x)
xf

# convert to factor with labels
xf2 <- factor(x, labels = c("grade 2", "grade 3", "grade 4"))
xf2

```


## Create numbers from strings


#### Python {-}


#### R {-}


## Change case


#### Python {-}


#### R {-}
